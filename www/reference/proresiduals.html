<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Residuals for Probabilistic Regression Models — proresiduals • topmodels</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Residuals for Probabilistic Regression Models — proresiduals"><meta property="og:description" content="Generic function and default method for (randomized) quantile residuals, PIT,
Pearson, and raw response residuals based on distributions3 support."><meta property="og:image" content="https://topmodels.R-Forge.R-project.org/logo.png"><meta name="twitter:card" content="summary"><meta name="twitter:creator" content="@AchimZeileis"><meta name="twitter:site" content="@AchimZeileis"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">topmodels</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3-0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/topmodels.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/goodness_of_fit.html">Goodness of Fit of Probabilistic Regression Models</a>
    </li>
    <li>
      <a href="../articles/graphics.html">Graphics for Assessing Goodness of Fit</a>
    </li>
    <li>
      <a href="../articles/illustration_fifa_2018.html">Illustration: Goals in the 2018 FIFA World Cup</a>
    </li>
    <li>
      <a href="../articles/illustration_rain_ibk.html">Illustration: Precipitation Forecasts in Innsbruck</a>
    </li>
    <li>
      <a href="../articles/illustration_artificial.html">Illustration: Artificial Data</a>
    </li>
    <li>
      <a href="../articles/implementation.html">Implementation Overview</a>
    </li>
    <li>
      <a href="../articles/procast.html">Probabilistic Forecasting Infrastructure</a>
    </li>
  </ul></li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li>
  <a href="../contact.html">Contact</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Residuals for Probabilistic Regression Models</h1>
    
    <div class="hidden name"><code>proresiduals.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Generic function and default method for (randomized) quantile residuals, PIT,
Pearson, and raw response residuals based on <span class="pkg">distributions3</span> support.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">proresiduals</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for default</span></span>
<span><span class="fu">proresiduals</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  newdata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"quantile"</span>, <span class="st">"pit"</span>, <span class="st">"pearson"</span>, <span class="st">"response"</span><span class="op">)</span>,</span>
<span>  random <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  prob <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  delta <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object</dt>
<dd><p>an object for which a <code><a href="newresponse.html">newresponse</a></code> and a
<code><a href="https://alexpghayes.github.io/distributions3/reference/prodist.html" class="external-link">prodist</a></code> method is available.</p></dd>


<dt>...</dt>
<dd><p>further parameters passed to methods.</p></dd>


<dt>newdata</dt>
<dd><p>optionally, a data frame in which to look for variables with
which to predict. If omitted, the original observations are used.</p></dd>


<dt>type</dt>
<dd><p>character indicating whether quantile (default), PIT, Pearson, or raw response
residuals should be computed.</p></dd>


<dt>random</dt>
<dd><p>logical or numeric. Should random residuals be computed for <code>type = "quantile"</code>
and <code>"pit"</code>? The default is <code>TRUE</code> and if set to <code>FALSE</code>, fixed
quantiles given at the probabilities in <code>prob</code> are used (defaulting to mid-quantiles).
If <code>random &gt; 1</code>, then multiple random replications of quantile or PIT
residuals are computed. For other residual types <code>random</code> has no effect.</p></dd>


<dt>prob</dt>
<dd><p>numeric. Fixed probabilities for the quantile or PIT residuals when
<code>random = FALSE</code>.</p></dd>


<dt>delta</dt>
<dd><p>numeric. The minimal difference to compute the range of
proabilities corresponding to each observation according to get (randomized)
<code>"quantile"</code> or <code>"pit"</code> residuals.  For <code>NULL</code>, the minimal observed difference in the
resonse divided by <code>5e-6</code> is used. Ignored for continuous distributions.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A vector or matrix of residuals. A matrix of residuals is returned
if more than one replication of quantile or PIT residuals is computed, i.e., if either
<code>random &gt; 1</code> or <code>random = FALSE</code> and <code>length(prob) &gt; 1</code>.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The new generic function <code>proresiduals</code> comes with a powerful default
method that is based on the following idea: <code><a href="newresponse.html">newresponse</a></code>
and <code><a href="https://alexpghayes.github.io/distributions3/reference/prodist.html" class="external-link">prodist</a></code> can be used to extract the observed
response and expected distribution for it, respectively. For all model classes
that have methods for these two generic functions, <code>proresiduals</code> can
compute a range of different <code>type</code>s of residuals.</p>
<p>The simplest definition of residuals are the so-called <code>"response"</code> residuals
which simply compute the difference between the observations and the expected means.
The <code>"pearson"</code> residuals additionally standardize these residuals by the
square root of the expected variance. Thus, these residuals are based only on the
first and on the first two moments, respectively.</p>
<p>To assess the entire distribution and not just the first moments, there are also
residuals based on the probability integral transform (PIT).
For regression models with a continuous response distribution, <code>"pit"</code> residuals
(see Warton 2007) are simply the expected cumulative distribution (CDF) evaluated at the
observations (Dawid, 1984). For discrete distributions, a uniform random value is drawn
from the range of probabilities between the CDF at the observation and the supremum
of the CDF to the left of it. If the model fits well the PIT residuals should be uniformly
distributed.</p>
<p>In order to obtain normally distributed residuals for well-fitting models (like often
desired in linear regression models), <code>"quantile"</code> residuals, proposed by Dunn and
Smyth (1996), additionally transform the PIT residuals by the standard normal quantile function.</p>
<p>As quantile residuals and PIT residuals are subject to randomness for discrete distributions
(and also for mixed discrete-continuous distributions), it is sometimes
useful to explore the extent of the random variation by obtaining multiple replications.
In <code>proresiduals</code> this can be achieved by setting <code>random &gt; 1</code>.</p>
<p>Alternatively, the randomness can be suppressed via <code>random = FALSE</code> and then only
one (or more) fixed quantile(s) of each probability interval is returned. The default is
<code>prob = 0.5</code> which corresponds to mid-quantile residuals (see Feng et al. 2020). Another
common setting is <code>prob = c(0, 1)</code> which yields the range of possible residuals.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Dawid AP (1984).
“Present Position and Potential Developments: Some Personal Views:
Statistical Theory: The Prequential Approach.”
<em>Journal of the Royal Statistical Society A</em>, <b>147</b>(2), 278--292.
<a href="https://doi.org/10.2307/2981683" class="external-link">doi:10.2307/2981683</a>
.</p>
<p>Dunn KP, Smyth GK (1996).
“Randomized Quantile Residuals.”
<em>Journal of Computational and Graphical Statistics</em>, <b>5</b>(3), 236--244.
<a href="https://doi.org/10.2307/1390802" class="external-link">doi:10.2307/1390802</a></p>
<p>Feng C, Li L, Sadeghpour A (2020).
“A Comparison of Residual Diagnosis Tools for Diagnosing Regression Models for Count Data”
<em>BMC Medical Research Methodology</em>, <b>20</b>(175), 1--21.
<a href="https://doi.org/10.1186/s12874-020-01055-2" class="external-link">doi:10.1186/s12874-020-01055-2</a></p>
<p>Warton DI, Thibaut L, Wang YA (2017)
“The PIT-Trap -- A ‘Model-Free’ Bootstrap Procedure for Inference
about Regression Models with Discrete, Multivariate Responses”.
<em>PLOS ONE</em>, <b>12</b>(7), 1--18.
<a href="https://doi.org/10.1371/journal.pone.0181790" class="external-link">doi:10.1371/journal.pone.0181790</a>
.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></code>, <code><a href="qqrplot.html">qqrplot</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Poisson GLM for FIFA 2018 data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"FIFA2018"</span>, package <span class="op">=</span> <span class="st">"distributions3"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">goals</span> <span class="op">~</span> <span class="va">difference</span>, data <span class="op">=</span> <span class="va">FIFA2018</span>, family <span class="op">=</span> <span class="va">poisson</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## random quantile residuals</span></span></span>
<span class="r-in"><span><span class="fu">proresiduals</span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            1            2            3            4            5            6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2.121391343 -0.870829887 -0.409313713 -0.398996087  1.279323226  0.423852923 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            7            8            9           10           11           12 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.721350510 -1.003574008  1.102676448 -0.546669720  0.962804005 -0.316228552 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           13           14           15           16           17           18 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.739981117  0.273003421  2.063776099  1.428015088 -0.453951606 -1.610287017 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           19           20           21           22           23           24 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.411194908 -0.934977924 -0.058239246 -0.821002708  1.627328789 -0.046773847 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           25           26           27           28           29           30 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.343772467  0.481905086 -0.869549229 -0.564616712  0.139767620  0.509241780 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           31           32           33           34           35           36 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.485255437 -1.375145617 -0.454371204 -1.949937093 -1.577362085  0.644553913 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           37           38           39           40           41           42 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.542332525  0.575688850  0.773677653 -2.234759032 -0.926803673  1.442863660 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           43           44           45           46           47           48 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.985674715 -1.264427978  0.466815688  0.303144930 -0.127912344  0.446301302 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           49           50           51           52           53           54 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.780019834  0.090552169 -0.722048020  0.246295435 -0.037847805 -0.897378928 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           55           56           57           58           59           60 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.392254615  0.631771062 -1.222177367  0.090525677  0.377167382  1.094367969 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           61           62           63           64           65           66 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -2.599488279  0.381903891 -0.054256968 -1.246356958 -0.137317322  0.779801188 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           67           68           69           70           71           72 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.315399157  0.042437121  1.683986030 -3.062763544 -1.490724714  1.764524040 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           73           74           75           76           77           78 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.556259169 -0.254498696  0.559267677 -0.074324329  1.630638756  1.399866470 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           79           80           81           82           83           84 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2.211817402  0.331909157 -1.853638892 -0.373712781 -0.022654464  0.447119239 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           85           86           87           88           89           90 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.021875629  1.112887630  0.076203550  0.613008422  0.466150146  0.355965917 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           91           92           93           94           95           96 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.331674057  1.372869120 -0.653998253  0.122785883 -1.212792623 -0.203224183 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           97           98           99          100          101          102 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.808338824  1.411707437  0.812780327  0.146983853 -0.060088635  0.593423621 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          103          104          105          106          107          108 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.495442467  0.144175587  0.447625347 -0.598954092  0.926853890  1.357653473 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          109          110          111          112          113          114 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.268520589 -1.051176079 -0.331889615 -0.312948506 -0.792573244  0.316483384 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          115          116          117          118          119          120 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.125058985  0.863613275 -0.548998622  0.722704203  0.221340782  0.174326845 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          121          122          123          124          125          126 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.120542079 -1.018568723 -0.344973548 -0.003119137  0.351795087 -0.628584783 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          127          128 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.810441882  1.150576905 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Pearson residuals</span></span></span>
<span class="r-in"><span><span class="fu">proresiduals</span><span class="op">(</span><span class="va">m</span>, type <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            1            2            3            4            5            6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2.430654322 -0.930334590 -1.014724759 -0.398804262  1.305927102 -0.064013188 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            7            8            9           10           11           12 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.613884092 -0.914301665  1.519090649 -1.093055385  0.993556817 -0.424264684 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           13           14           15           16           17           18 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.113056199 -0.211616188  2.038308437  1.153169320 -0.546750414 -0.944255416 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           19           20           21           22           23           24 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.840278169 -0.792913544  0.116280482 -0.548303440  1.537474481 -0.111528206 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           25           26           27           28           29           30 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.099738912  0.339830526 -1.079060716 -0.274111521 -0.360546190 -0.066833526 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           31           32           33           34           35           36 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.691375999 -0.881237871 -0.908320460 -1.361897916 -1.065751519  0.562346952 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           37           38           39           40           41           42 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.625851688  0.190909297  0.375971301 -0.998686051 -1.222716781  1.953550708 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           43           44           45           46           47           48 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.688071124 -1.113023052  0.192354231  0.107004865  0.001191279  0.378023421 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           49           50           51           52           53           54 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.048037832 -0.333124464 -0.702612840  0.264228995 -0.223024138 -0.808461816 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           55           56           57           58           59           60 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.170029883  0.623708821 -0.857974497 -0.054672753  0.452546135  0.923900344 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           61           62           63           64           65           66 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.398279331  0.245655957 -0.333908002 -1.047632914 -0.051316840  0.453072234 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           67           68           69           70           71           72 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.027001956  0.287781642  1.634605655 -1.515806191 -1.135687571  1.664963346 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           73           74           75           76           77           78 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.627910298 -0.855301681  0.204392856  0.090052537  2.096199105  1.427808319 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           79           80           81           82           83           84 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2.910552914  0.239342145 -1.071915077 -0.287530123 -0.178220460  0.635530844 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           85           86           87           88           89           90 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.438382284  1.014266304 -0.339381957  0.869416029  0.747455937  0.624804291 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           91           92           93           94           95           96 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.082035785  1.480840871 -1.023025797 -0.382201924 -1.016451750 -0.395336915 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           97           98           99          100          101          102 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2.319462548  1.720582549  0.734690903 -0.246750527 -0.518360463  0.087311027 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          103          104          105          106          107          108 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.359633135 -0.067732640  0.018629138 -0.880499408  0.854954441  1.281307943 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          109          110          111          112          113          114 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.180142894 -1.130625614 -0.111669780 -0.315120066 -0.972503579  0.300292121 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          115          116          117          118          119          120 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.390918669  0.944711115 -0.976915794  0.313170650 -0.169708261 -0.256636287 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          121          122          123          124          125          126 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.332373025 -1.048426333 -0.144779744 -0.281712175  0.578986159 -1.071915077 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          127          128 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.891273576  1.071258286 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## various flavors of residuals on small new data</span></span></span>
<span class="r-in"><span><span class="va">nd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>goals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, difference <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## random quantile residuals</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">proresiduals</span><span class="op">(</span><span class="va">m</span>, newdata <span class="op">=</span> <span class="va">nd</span>, type <span class="op">=</span> <span class="st">"quantile"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          1          2          3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.7223565 -0.2908823 -0.6393725 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">proresiduals</span><span class="op">(</span><span class="va">m</span>, newdata <span class="op">=</span> <span class="va">nd</span>, type <span class="op">=</span> <span class="st">"quantile"</span>, random <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             r_1        r_2        r_3        r_4         r_5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  0.7223565  0.3800686  0.7243461  0.4353980  0.01250164</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.2908823  0.2958457  0.3303159 -0.4889856  0.09265594</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -0.6393725 -0.7988924 -0.4002845 -0.7946336 -0.62879276</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## underlying probability integral transform (PIT) without transformation to normal</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">proresiduals</span><span class="op">(</span><span class="va">m</span>, newdata <span class="op">=</span> <span class="va">nd</span>, type <span class="op">=</span> <span class="st">"pit"</span>, random <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            r_1       r_2       r_3       r_4       r_5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.7649623 0.6480528 0.7655733 0.6683632 0.5049873</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.3855707 0.6163260 0.6294193 0.3124259 0.5369116</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.2612903 0.2121764 0.3444735 0.2134133 0.2647424</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## raw response residuals (observation - expected mean)</span></span></span>
<span class="r-in"><span><span class="fu">proresiduals</span><span class="op">(</span><span class="va">m</span>, newdata <span class="op">=</span> <span class="va">nd</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          1          2          3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.1818546 -0.2370397 -0.8704100 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## standardized Pearson residuals (additionally divide by standard deviation)</span></span></span>
<span class="r-in"><span><span class="fu">proresiduals</span><span class="op">(</span><span class="va">m</span>, newdata <span class="op">=</span> <span class="va">nd</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          1          2          3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.1818546 -0.2370397 -0.8704100 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## (non-random) mid-quantile residuals</span></span></span>
<span class="r-in"><span><span class="fu">proresiduals</span><span class="op">(</span><span class="va">m</span>, newdata <span class="op">=</span> <span class="va">nd</span>, type <span class="op">=</span> <span class="st">"quantile"</span>, random <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           1           2           3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.31008612 -0.07586646 -0.52976162 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## minimum/median/maximum quantile residuals</span></span></span>
<span class="r-in"><span><span class="fu">proresiduals</span><span class="op">(</span><span class="va">m</span>, newdata <span class="op">=</span> <span class="va">nd</span>, type <span class="op">=</span> <span class="st">"quantile"</span>, random <span class="op">=</span> <span class="cn">FALSE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             r_0       r_0.5        r_1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -0.1478027  0.31008612  0.8497044</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.5526775 -0.07586646  0.3833860</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -1.0191728 -0.52976162 -0.1453513</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## compute residuals by manually obtaining distribution and response</span></span></span>
<span class="r-in"><span><span class="co">## proresiduals(procast(m, newdata = nd, drop = TRUE), nd$goals)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Achim Zeileis, Moritz N. Lang, Reto Stauffer.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

