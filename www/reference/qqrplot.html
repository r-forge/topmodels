<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Q-Q Plots for Quantile Residuals — qqrplot • topmodels</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Q-Q Plots for Quantile Residuals — qqrplot" />
<meta property="og:description" content="Visualize goodness of fit of regression models by Q-Q plots using quantile
residuals. If plot = TRUE, the resulting object of
class &quot;qqrplot&quot; is plotted by plot.qqrplot or
autoplot.qqrplot conditional if the package
ggplot2 is loaded, before it is returned." />
<meta property="og:image" content="https://topmodels.R-Forge.R-project.org/logo.png" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:creator" content="@MoritzNLang" />
<meta name="twitter:site" content="@MoritzNLang" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">topmodels</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1-0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/topmodels.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li>
  <a href="../contact.html">Contact</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Q-Q Plots for Quantile Residuals</h1>
    
    <div class="hidden name"><code>qqrplot.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Visualize goodness of fit of regression models by Q-Q plots using quantile
residuals. If <code>plot = TRUE</code>, the resulting object of
class <code>"qqrplot"</code> is plotted by <code><a href='plot.qqrplot.html'>plot.qqrplot</a></code> or
<code><a href='plot.qqrplot.html'>autoplot.qqrplot</a></code> conditional if the package
<code>ggplot2</code> is loaded, before it is returned.</p>
    </div>

    <pre class="usage"><span class='fu'>qqrplot</span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for default</span>
<span class='fu'>qqrplot</span><span class='op'>(</span>
  <span class='va'>object</span>,
  newdata <span class='op'>=</span> <span class='cn'>NULL</span>,
  plot <span class='op'>=</span> <span class='cn'>TRUE</span>,
  class <span class='op'>=</span> <span class='cn'>NULL</span>,
  trafo <span class='op'>=</span> <span class='va'>qnorm</span>,
  nsim <span class='op'>=</span> <span class='fl'>1L</span>,
  delta <span class='op'>=</span> <span class='cn'>NULL</span>,
  confint <span class='op'>=</span> <span class='cn'>TRUE</span>,
  confint_level <span class='op'>=</span> <span class='fl'>0.95</span>,
  confint_nsim <span class='op'>=</span> <span class='fl'>250</span>,
  confint_seed <span class='op'>=</span> <span class='fl'>1</span>,
  single_graph <span class='op'>=</span> <span class='cn'>FALSE</span>,
  xlab <span class='op'>=</span> <span class='st'>"Theoretical quantiles"</span>,
  ylab <span class='op'>=</span> <span class='st'>"Quantile residuals"</span>,
  main <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>an object from which probability integral transforms can be
extracted using the generic function <code><a href='procast.html'>procast</a></code>.</p></td>
    </tr>
    <tr>
      <th>newdata</th>
      <td><p>optionally, a data frame in which to look for variables with
which to predict. If omitted, the original observations are used.</p></td>
    </tr>
    <tr>
      <th>plot</th>
      <td><p>Should the <code>plot</code> or <code>autoplot</code> method be called to
draw the computed Q-Q plot? Either set <code>plot</code> expicitly to "base" vs.
"ggplot2" to choose the type of plot, or for a logical <code>plot</code> argument
it's chosen conditional if the package <code>ggplot2</code> is loaded.</p></td>
    </tr>
    <tr>
      <th>class</th>
      <td><p>Should the invisible return value be either a <code>data.frame</code>
or a <code>tibble</code>. Either set <code>class</code> expicitly to "data.frame" vs.
"tibble", or for NULL it's chosen automatically conditional if the package
<code>tibble</code> is loaded.</p></td>
    </tr>
    <tr>
      <th>trafo</th>
      <td><p>function for tranforming residuals from probability scale to a
different distribution scale (default: Gaussian).</p></td>
    </tr>
    <tr>
      <th>nsim, delta</th>
      <td><p>arguments passed to <code>qresiduals</code>.</p></td>
    </tr>
    <tr>
      <th>confint</th>
      <td><p>logical or quantile specification. Should the range of
quantiles of the randomized quantile residuals be visualized? If
<code>TRUE</code>, then <code>range = c(0.01, 0.99)</code> is used.</p></td>
    </tr>
    <tr>
      <th>confint_level</th>
      <td><p>numeric. The confidence level required.</p></td>
    </tr>
    <tr>
      <th>confint_nsim</th>
      <td><p>numeric. The number of simulated quantiles.</p></td>
    </tr>
    <tr>
      <th>confint_seed</th>
      <td><p>numeric. The seed to be set for calculating the
confidence interval.</p></td>
    </tr>
    <tr>
      <th>single_graph</th>
      <td><p>logical. Should all computed extended reliability
diagrams be plotted in a single graph?</p></td>
    </tr>
    <tr>
      <th>xlab, ylab, main, ...</th>
      <td><p>graphical parameters handed passed to
<code><a href='plot.qqrplot.html'>plot.qqrplot</a></code> or <code><a href='plot.qqrplot.html'>autoplot.qqrplot</a></code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code>"qqrplot"</code> inheriting from
<code>"data.frame"</code> or <code>"tibble"</code> conditional on the argument <code>class</code> 
with the following variables:</p>
<dt>x</dt><dd><p>theoretical
quantiles,</p></dd> <dt>y</dt><dd><p>empirical quantile residuals.</p></dd> In case of randomized residuals, nsim
different x and y, and a lower and upper confidence interval bound is returned.
Additionally, xlab, ylab, main, and confint_level 
are stored as attributes.

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Q-Q residuals plots draw quantile residuals (by default: transformed to standard
normal scale) against theoretical quantiles from the same distribution.
Alternatively, transformations to other distributions can also be used,
specifically using no transformation at all, i.e., remaining on the uniform
scale (via <code>trafo = NULL</code> or equivalently <code>qunif</code> or
<code>identity</code>). For computation, <code>qqrplot</code> leverages the function
<code><a href='qresiduals.html'>qresiduals</a></code> employing the <code><a href='procast.html'>procast</a></code>.</p>
<p>Additional options are offered for models with discrete responses where
randomization of quantiles is needed.</p>
<p>In addition to the <code>plot</code> and <code><a href='https://ggplot2.tidyverse.org/reference/autoplot.html'>autoplot</a></code> method for
qqrplot objects, it is also possible to combine two (or more) Q-Q residuals plots by
<code>c</code>/<code>rbind</code>, which creates a set of Q-Q residuals plots that can then be
plotted in one go.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Dunn KP, Smyth GK (1996). &#8220;Randomized Quantile
Residuals.&#8221; <em>Journal of Computational and Graphical Statistics</em>,
<b>5</b>, 1--10.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='plot.qqrplot.html'>plot.qqrplot</a></code>, <code><a href='qresiduals.html'>qresiduals</a></code>, <code><a href='https://rdrr.io/r/stats/qqnorm.html'>qqnorm</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"CrabSatellites"</span>, package <span class='op'>=</span> <span class='st'>"countreg"</span><span class='op'>)</span>
<span class='va'>CrabSatellites2</span> <span class='op'>&lt;-</span> <span class='va'>CrabSatellites</span><span class='op'>[</span><span class='va'>CrabSatellites</span><span class='op'>$</span><span class='va'>satellites</span> <span class='op'>&lt;=</span> <span class='fl'>1</span>, <span class='op'>]</span>

<span class='va'>m1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/glm.html'>glm</a></span><span class='op'>(</span><span class='va'>satellites</span> <span class='op'>~</span> <span class='va'>width</span> <span class='op'>+</span> <span class='va'>color</span>, data <span class='op'>=</span> <span class='va'>CrabSatellites</span>, family <span class='op'>=</span> <span class='va'>poisson</span><span class='op'>)</span>
<span class='va'>m2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/glm.html'>glm</a></span><span class='op'>(</span><span class='va'>satellites</span> <span class='op'>~</span> <span class='va'>width</span> <span class='op'>+</span> <span class='va'>color</span>, data <span class='op'>=</span> <span class='va'>CrabSatellites2</span>, family <span class='op'>=</span> <span class='va'>binomial</span><span class='op'>)</span>
<span class='va'>m3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>dist</span> <span class='op'>~</span> <span class='va'>speed</span>, data <span class='op'>=</span> <span class='va'>cars</span><span class='op'>)</span>

<span class='va'>q1</span> <span class='op'>&lt;-</span> <span class='fu'>qqrplot</span><span class='op'>(</span><span class='va'>m1</span>, nsim <span class='op'>=</span> <span class='fl'>100</span>, confint <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='img'><img src='qqrplot-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='va'>q2</span> <span class='op'>&lt;-</span> <span class='fu'>qqrplot</span><span class='op'>(</span><span class='va'>m2</span>, nsim <span class='op'>=</span> <span class='fl'>100</span>, confint <span class='op'>=</span> <span class='cn'>TRUE</span>, plot <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='va'>q3</span> <span class='op'>&lt;-</span> <span class='fu'>qqrplot</span><span class='op'>(</span><span class='va'>m3</span>, nsim <span class='op'>=</span> <span class='fl'>100</span>, confint <span class='op'>=</span> <span class='cn'>TRUE</span>, plot <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>q1</span>, <span class='va'>q2</span><span class='op'>)</span>, single_graph <span class='op'>=</span> <span class='cn'>FALSE</span>, fill <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>3</span><span class='op'>)</span>, ref <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span><span class='va'>q3</span>, col <span class='op'>=</span> <span class='st'>"lightblue"</span><span class='op'>)</span>
</div><div class='img'><img src='qqrplot-2.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Achim Zeileis, Moritz N. Lang.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


