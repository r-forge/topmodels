<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Illustration: Artificial Data • topmodels</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Illustration: Artificial Data">
<meta property="og:description" content="topmodels">
<meta property="og:image" content="https://topmodels.R-Forge.R-project.org/logo.png">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@MoritzNLang">
<meta name="twitter:site" content="@MoritzNLang">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">topmodels</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3-0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/topmodels.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/goodness_of_fit.html">Goodness of Fit of Probabilistic Regression Models</a>
    </li>
    <li>
      <a href="../articles/graphics.html">Graphics for Assessing Goodness of Fit</a>
    </li>
    <li>
      <a href="../articles/illustration_fifa_2018.html">Illustration: Goals in the 2018 FIFA World Cup</a>
    </li>
    <li>
      <a href="../articles/illustration_rain_ibk.html">Illustration: Precipitation Forecasts in Innsbruck</a>
    </li>
    <li>
      <a href="../articles/illustration_artificial.html">Illustration: Artificial Data</a>
    </li>
    <li>
      <a href="../articles/implementation.html">Implementation Overview</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li>
  <a href="../contact.html">Contact</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Illustration: Artificial Data</h1>
            
      
      
      <div class="hidden name"><code>illustration_artificial.Rmd</code></div>

    </div>

    
    
<style type="text/css">
script src = "https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"
</style>
<script type="text/javascript">
 $(document).ready(function() {
    $('body').prepend('<div class=\"zoomDiv\"><img src=\"\" class=\"zoomImg\"></div>');
    // onClick function for all plots (img's)
    $('img:not(.zoomImg)').click(function() {
      $('.zoomImg').attr('src', $(this).attr('src')).css({width: '100%'});
      $('.zoomDiv').css({opacity: '1', width: 'auto', border: '1px solid white', borderRadius: '5px', position: 'fixed', top: '50%', left: '50%', marginRight: '-50%', transform: 'translate(-50%, -50%)', boxShadow: '0px 0px 50px #888888', zIndex: '50', overflow: 'auto', maxHeight: '100%'});
    });
    // onClick function for zoomImg
    $('img.zoomImg').click(function() {
      $('.zoomDiv').css({opacity: '0', width: '0%'}); 
    });
  });
</script><div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p><img src="illustration_artificial_files/figure-html/plot-summary-1.png" width="100%" style="display: block; margin: auto;"></p>
<table class="table">
<colgroup>
<col width="12%">
<col width="12%">
<col width="12%">
<col width="12%">
<col width="12%">
<col width="12%">
<col width="12%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th>Predictive distribution</th>
<th>well calibrated</th>
<th>too skew to the left</th>
<th>too skew to the right</th>
<th>tails too light</th>
<th>tails too heavy</th>
<th>underdispersed (underestimated variance)</th>
<th>overdispersed (overestimated variance)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Resdiuals</strong></td>
<td>normal</td>
<td>right skewed</td>
<td>left skewed</td>
<td>heavy tailed</td>
<td>light tailed</td>
<td>overdispersed</td>
<td>underdispersed</td>
</tr>
<tr class="even">
<td><strong>Q-Q plot</strong></td>
<td>bisecting line</td>
<td>positive curvature (bends up the line at both ends)</td>
<td>negative curvature (bends down at both ends)</td>
<td>reverse S-shape (dips below the line at the low end and rises above
it at the high end)</td>
<td>S-shape</td>
<td>crossing qqline from below (?)</td>
<td>crossing qqline from above ?</td>
</tr>
<tr class="odd">
<td><strong>Worm plot</strong></td>
<td>horizontal line</td>
<td>U-shape</td>
<td>inverse U-shape</td>
<td>S-shape on the left bent down</td>
<td>S-shape on the left bent up</td>
<td>positive slope</td>
<td>negative slope</td>
</tr>
<tr class="even">
<td><strong>PIT histogram</strong></td>
<td>uniform</td>
<td>skewed</td>
<td>skewed</td>
<td>superimposed U-shape</td>
<td>superimposed inverse U-shape”</td>
<td>U-shape</td>
<td>inverse U-shape</td>
</tr>
<tr class="odd">
<td><strong>Rootogram</strong></td>
<td>no deviations</td>
<td>?</td>
<td>?</td>
<td>wave-like (underfitting in the tails and the center)</td>
<td>?</td>
<td>?</td>
<td>?</td>
</tr>
<tr class="even">
<td><strong>Interpretation</strong></td>
<td>no misspecifications</td>
<td>?</td>
<td>?</td>
<td>values more extrem as expected</td>
<td>values less extrem as expected</td>
<td>?</td>
<td>?</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="artifical-data">Artifical data<a class="anchor" aria-label="anchor" href="#artifical-data"></a>
</h2>
<p>The following artificial data sets are simulated, with response
values always depending on regressor variables, in order to obtain a
realistic scenario for regression models:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">make_residuals_plot</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">object</span>, <span class="va">breaks</span> <span class="op">=</span> <span class="va">breaks</span><span class="op">)</span> <span class="op">{</span>

  <span class="va">name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/deparse.html" class="external-link">deparse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">substitute</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span><span class="op">)</span>

  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
  <span class="fu"><a href="../reference/pithist.html">pithist</a></span><span class="op">(</span><span class="va">object</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.01</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">9</span> <span class="op">/</span> <span class="fl">10</span>, <span class="fl">0.99</span>, <span class="fl">1</span><span class="op">)</span>, main <span class="op">=</span> <span class="va">name</span><span class="op">)</span>

  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">qq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/qresiduals.html">qresiduals</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span>, freq <span class="op">=</span> <span class="cn">FALSE</span>,
    main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Histogram of qresiduals(%s)"</span>, <span class="va">name</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="st">"Q-Q residuals"</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/curve.html" class="external-link">curve</a></span><span class="op">(</span><span class="va">dnorm</span>, from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">qq</span><span class="op">)</span>, to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">qq</span><span class="op">)</span>, col <span class="op">=</span> <span class="fl">2</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, <span class="st">"std. norm"</span>, lty <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="fl">2</span>, bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span>

  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"Q-Q residuals"</span> <span class="op">=</span> <span class="fu"><a href="../reference/qresiduals.html">qresiduals</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span>, <span class="st">"std. norm"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="../reference/qresiduals.html">qresiduals</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">make_topmodels_plot</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="../reference/topmodels.html">topmodels</a></span><span class="op">(</span><span class="va">object</span>, which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, ask <span class="op">=</span> <span class="cn">FALSE</span>, spar <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="op">}</span>

<span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>

<span class="co">## regressors</span>
<span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span> 
  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">500</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,
  z <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">500</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>
<span class="op">)</span>

<span class="co">## parameters</span>
<span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="va">d</span>,
  lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">x</span><span class="op">)</span>,
  theta <span class="op">=</span> <span class="fl">2</span>,
  mu <span class="op">=</span> <span class="fl">50</span> <span class="op">+</span> <span class="fl">22</span> <span class="op">*</span> <span class="va">x</span>,
  sigma <span class="op">=</span> <span class="fl">22</span>,
  sigmaz <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">3</span> <span class="op">+</span> <span class="fl">1</span> <span class="op">*</span> <span class="va">z</span><span class="op">)</span>
<span class="op">)</span>

<span class="co">## responses</span>
<span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="va">d</span>,
  ynorm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">500</span>, mean <span class="op">=</span> <span class="va">mu</span>, sd <span class="op">=</span> <span class="va">sigma</span><span class="op">)</span>,

  yhnorm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">500</span>, mean <span class="op">=</span> <span class="va">mu</span>, sd <span class="op">=</span> <span class="va">sigmaz</span><span class="op">)</span>,
  ytnorm <span class="op">=</span> <span class="fu">crch</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/crch/man/tnorm.html" class="external-link">rtnorm</a></span><span class="op">(</span><span class="fl">500</span>, mean <span class="op">=</span> <span class="va">mu</span>, sd <span class="op">=</span> <span class="va">sigma</span>, left <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,
  ycnorm <span class="op">=</span> <span class="fu">crch</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/crch/man/cnorm.html" class="external-link">rcnorm</a></span><span class="op">(</span><span class="fl">500</span>, mean <span class="op">=</span> <span class="va">mu</span>, sd <span class="op">=</span> <span class="va">sigma</span>, left <span class="op">=</span> <span class="fl">0</span>, right <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,

  yt <span class="op">=</span> <span class="va">mu</span> <span class="op">+</span> <span class="va">sigma</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">rt</a></span><span class="op">(</span><span class="fl">500</span>, df <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,
  ylaplace <span class="op">=</span> <span class="va">mu</span> <span class="op">+</span> <span class="fu">rmutil</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rmutil/man/Laplace.html" class="external-link">rlaplace</a></span><span class="op">(</span><span class="fl">500</span>, s <span class="op">=</span> <span class="va">sigma</span><span class="op">)</span>,
  yrskew <span class="op">=</span> <span class="fu">sn</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sn/man/dsn.html" class="external-link">rsn</a></span><span class="op">(</span><span class="fl">500</span>, xi <span class="op">=</span> <span class="va">mu</span>, omega <span class="op">=</span> <span class="va">sigma</span>, alpha <span class="op">=</span> <span class="fl">5</span>, tau <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,
  ylskew <span class="op">=</span> <span class="fu">sn</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sn/man/dsn.html" class="external-link">rsn</a></span><span class="op">(</span><span class="fl">500</span>, xi <span class="op">=</span> <span class="va">mu</span>, omega <span class="op">=</span> <span class="va">sigma</span>, alpha <span class="op">=</span> <span class="op">-</span><span class="fl">5</span>, tau <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,
  yunif <span class="op">=</span> <span class="va">mu</span> <span class="op">+</span> <span class="va">sigma</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">500</span>, min <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, max <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,

  ypois <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">500</span>, lambda <span class="op">=</span> <span class="va">lambda</span><span class="op">)</span>,
  ynegbin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/NegBinomial.html" class="external-link">rnbinom</a></span><span class="op">(</span><span class="fl">500</span>, mu <span class="op">=</span> <span class="va">lambda</span>, size <span class="op">=</span> <span class="va">theta</span><span class="op">)</span>,
  yzip <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">500</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">0.25</span>, <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">500</span>, lambda <span class="op">=</span> <span class="va">lambda</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="continuous-data">Continuous data<a class="anchor" aria-label="anchor" href="#continuous-data"></a>
</h2>
<div class="section level3">
<h3 id="homoscedastic-normal">Homoscedastic normal<a class="anchor" aria-label="anchor" href="#homoscedastic-normal"></a>
</h3>
<p>As a reference, a linear normal model is fitted to simulated normally
distributed data without conditional heteroscedasticity.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## correct model fit</span>
<span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">ynorm</span> <span class="op">~</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">d</span><span class="op">)</span></code></pre></div>
<p><img src="illustration_artificial_files/figure-html/topmodels-1-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>The model fit experiences no misspecifications resulting in a well
calibrated predictive distribution (compare the case “well calibrated”
in the summary plot of <a href="graphical_evaluation_methodology.html">Graphical Evaluation:
Methodology</a>):</p>
<ul>
<li>The rootogram shows that the observed and expected frequencies match
rather well, without any clear patterns of departure, hence, the
deviations between observed and predicted frequences are very small for
most values.</li>
<li>The PIT histogram is uniform, corresponding to a well calibrated
predicitve distribution.</li>
<li>The Q-Q residuals plot shows most points are located along the
bisecting line.</li>
<li>The worm plot is within its confidence intervals and shows only
slight deviations from a horizontal line (FIXME: why not completely
horizontal).</li>
</ul>
</div>
<div class="section level3">
<h3 id="conditional-heteroscedasticity">Conditional heteroscedasticity<a class="anchor" aria-label="anchor" href="#conditional-heteroscedasticity"></a>
</h3>
<p>In the “conditional heteroscedasticity” example, two models are
fitted to simulated data from the normal distribution where both the
location and scale parameters depend on a regressor. The model
<code>m2</code> estimated with <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> cannot account for
conditional heteroscedasticity, unlike the model <code>m3</code> which
is fitted with <code><a href="https://rdrr.io/pkg/crch/man/crch.html" class="external-link">crch()</a></code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## not accounting for heteroscedasticity</span>
<span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">yhnorm</span> <span class="op">~</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">d</span><span class="op">)</span>

<span class="co">### accounting for heteroscedasticity</span>
<span class="va">m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/crch/man/crch.html" class="external-link">crch</a></span><span class="op">(</span><span class="va">yhnorm</span> <span class="op">~</span> <span class="va">x</span> <span class="op">|</span> <span class="va">z</span>, data <span class="op">=</span> <span class="va">d</span><span class="op">)</span></code></pre></div>
<p><img src="illustration_artificial_files/figure-html/qresiduals-2-1.png" width="80%" style="display: block; margin: auto;"></p>
<p><img src="illustration_artificial_files/figure-html/topmodels-2-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>Not accounting for conditional heteroscedasticity results here in a
model fit where the tails of the distribution are too light (compare the
case “tails too light” in the summary plot of <a href="graphical_evaluation_methodology.html">Graphical Evaluation:
Methodology</a>):</p>
<ul>
<li>This leads to underfitting the observed values in the tails and the
center of the predictive distribution, whereas the values in between are
overfitted, which is visible as a typical wave-like pattern in the
rootogram. This indicates some overdispersion in the data wich is not
accounted for in the model.</li>
<li>In the PIT histogram, only the underfitting in the middle of the
predictive distribution is observed, indicating that more values occur
here than expected. A possibly expected U-shaped PIT histogram,
typically corresponding to a underdispersive model fit, is not visible
here; hence, the PIT histogram is obviously not well suited with the
usual number of bins to detect the significant probability mass in the
outermost tails of the distribution.</li>
<li>In the Q-Q residuals plot, due to a transformation to the normal
distribution, the tails are more widely spread, whereby the deviations
correctly show that the observed values are more extreme than expected.
This leads to a so-call reverse S-shape of the Q-Q plot.</li>
<li>In the wormplot, the misshape is further emphasized by plotting the
deviation between the empirical and theoretical quantiles on the Y-axis,
which results in a S-shape pattern bending down towards the left.</li>
</ul>
</div>
<div class="section level3">
<h3 id="censoring-0-100">Censoring (0, 100)<a class="anchor" aria-label="anchor" href="#censoring-0-100"></a>
</h3>
<p>To investigate the graphical evaluation tools under the
misspecification of not accounting for censoring in the estimation,
homoscedastic normally distributed data are simulated with censoring at
0 and 100. The model <code>m4</code> fitted with <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code>
cannot account for the censored data, contrary to the model
<code>m5</code> estimated with <code><a href="https://rdrr.io/pkg/crch/man/crch.html" class="external-link">crch()</a></code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## not accounting for censoring</span>
<span class="va">m4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">ycnorm</span> <span class="op">~</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">d</span><span class="op">)</span>

<span class="co">## accounting for censoring</span>
<span class="va">m5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/crch/man/crch.html" class="external-link">crch</a></span><span class="op">(</span><span class="va">ycnorm</span> <span class="op">~</span> <span class="va">x</span> <span class="op">|</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">d</span>, left <span class="op">=</span> <span class="fl">0</span>, right <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></code></pre></div>
<p><img src="illustration_artificial_files/figure-html/qresiduals-3-1.png" width="80%" style="display: block; margin: auto;"></p>
<p><img src="illustration_artificial_files/figure-html/topmodels-3-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>Not accounting for the censoring at 0 and 100 leads to an incorrect
distributional assumption in the tails of the predictive distribution,
similar to the case “tails too heavy” discussed in <a href="graphical_evaluation_methodology.html">Graphical Evaluation:
Methodology</a>:</p>
<ul>
<li>In the rootogram, this can be seen by the clear lack of fit for low
and high values due to not accounting for the point masses at the
censoring points; hence, the values at the censoring points are both
underfitted (FIXME: Right censoring in the rootogram, adapt default
breaks).</li>
<li>In contrast to the rootogram, the misspecification is barely visible
in the PIT histogram and only weakly visible in the Q-Q residual plot in
the form of some deviations at both ends, indicating that the values are
a bit less extrem than expected.</li>
<li>In the worm plot, the drift at both ends towards the upper left
corner and the lower right corner, respectively, indicates that the
observed values are not as extreme as expected. This is in agreement
with the pattern “tails too heavy” discussed in <a href="graphical_evaluation_methodology.html">Graphical Evaluation:
Methodology</a>, but without the typical S-shape pattern in the worm
plot.</li>
</ul>
</div>
<div class="section level3">
<h3 id="truncation-0">Truncation (&gt; 0)<a class="anchor" aria-label="anchor" href="#truncation-0"></a>
</h3>
<p>Here, the homoscedastic normally distributed response values are
truncated at zero. The model <code>m6</code> fitted with
<code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> cannot account correctly for this, contrary to the
model <code>m7</code> estimated with <code><a href="https://rdrr.io/pkg/crch/man/crch.html" class="external-link">crch()</a></code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## not accounting for truncation</span>
<span class="va">m6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">ytnorm</span> <span class="op">~</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">d</span><span class="op">)</span>

<span class="co"># not accounting for truncation</span>
<span class="va">m7</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/crch/man/crch.html" class="external-link">trch</a></span><span class="op">(</span><span class="va">ytnorm</span> <span class="op">~</span> <span class="va">x</span> <span class="op">|</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">d</span>, left <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<p><img src="illustration_artificial_files/figure-html/qresiduals-4-1.png" width="80%" style="display: block; margin: auto;"></p>
<p><img src="illustration_artificial_files/figure-html/topmodels-4-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>Not accounting for the truncation at 0 leads to an incorrect
distributional assumption in the lower tail of the predictive
distribution:</p>
<ul>
<li>In the rootogram, the lower values within the two first bins are
clearly underfitted by the model. Howeverr, for the model correctly
accounting for the truncation, some underfitting is also present,
indicating a slight misfit of the model (FIXME: Check again if all
correct).</li>
<li>As for the example with censored data, the incorrect model fit due
to not accounting for truncation is not visible in the PIT histogram and
only weakly visible in the Q-Q residuals plot.</li>
<li>In the worm plot, there is a weak S-shaped pattern bending upward
towards the left, suggesting that the tails of the predictive
distribution are too heavy. At least for for the lower tail, this is in
line with the misspecification due to truncation. (FIXME: Why is it in
the right part?)</li>
</ul>
</div>
<div class="section level3">
<h3 id="student-t-distribution-df-4">Student-t distribution (<code>df = 4</code>)<a class="anchor" aria-label="anchor" href="#student-t-distribution-df-4"></a>
</h3>
<p>In the following example, data is simulated from the student-t
distribution with 4 degrees of freedom. The model <code>m8</code>
incorrectly assumes normally distributed data, while the model
<code>m9</code> correctly incorporates t-distributed data.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## not accounting for t_4 distributed data</span>
<span class="va">m8</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">yt</span> <span class="op">~</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">d</span><span class="op">)</span>

<span class="co">## accounting for t_4 distributed data</span>
<span class="va">m9</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/crch/man/crch.html" class="external-link">crch</a></span><span class="op">(</span><span class="va">yt</span> <span class="op">~</span> <span class="va">x</span> <span class="op">|</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">d</span>, dist <span class="op">=</span> <span class="st">"student"</span><span class="op">)</span></code></pre></div>
<p><img src="illustration_artificial_files/figure-html/qresiduals-5-1.png" width="80%" style="display: block; margin: auto;"></p>
<p><img src="illustration_artificial_files/figure-html/topmodels-5-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>Not accounting for the underlying student-t response distribution
(<code>df = 4</code>), which is characterized by heavier tails than the
normal distribution, leads to a model fit where the tails of the
predictive distribution are to light (compare the previous example with
“conditional heteroscedasticity” and the case “tails too light” in the
summary plot of <a href="graphical_evaluation_methodology.html">Graphical Evaluation:
Methodology</a>):</p>
<ul>
<li>This leads to underfitting the values in the tails and the center of
the predictive distribution, whereas the values in between are
overfitted, which is visible as a typical wave-like pattern in the
rootogram. This indicates some overdispersion in the data wich is not
accounted for in the model.</li>
<li>In the PIT histogram, even if the first bin is slightly higher,
mostly the underfitting in the middle of the predictive distribution is
observed, indicating that more values occur here than expected. A
possibly expected U-shaped PIT histogram, corresponding to a
underdispersive model fit, is not detectable, since the heavier tails
concern only few values, which are not sufficiently resolved by the
usual bin width within the PIT.</li>
<li>In the Q-Q residuals plot, due to a transformation to the normal
distribution, the values in the tails are more widely spread, correctly
showing that the observed values are more extreme than expected. This
leads to a so-call reverse S-shape of the Q-Q plot.</li>
<li>In the wormplot, the misshape is further emphasized by plotting the
deviation between the empirical and theoretical quantiles on the Y-axis,
which results in a S-shape pattern bending down towards the left.</li>
</ul>
</div>
<div class="section level3">
<h3 id="skewness">Skewness<a class="anchor" aria-label="anchor" href="#skewness"></a>
</h3>
<p>In the example “skewness”, both right-skewed and left-skewed data are
simulated, which are not correctly accounted for by the linear models
<code>m10</code> and <code>m11</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## not accounting for right skewed data</span>
<span class="va">m10</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">yrskew</span> <span class="op">~</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">d</span><span class="op">)</span>

<span class="co">## not accounting for left skewed data</span>
<span class="va">m11</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">ylskew</span> <span class="op">~</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">d</span><span class="op">)</span></code></pre></div>
<p><img src="illustration_artificial_files/figure-html/qresiduals-6-1.png" width="80%" style="display: block; margin: auto;"></p>
<p><img src="illustration_artificial_files/figure-html/topmodels-6-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>Not accounting for right-skewed or left-skewed data leads to a
estimated model with a predictive distribution which is too skewed to
the left or right, respectively (compare the cases “too skew to the
left/right” in the summary plot of <a href="graphical_evaluation_methodology.html">Graphical Evaluation:
Methodology</a>):</p>
<ul>
<li>In the rootogram for the right-skewed and left-skewed data, a clear
underfitting of higher and lower values at the ends can be observed,
respectively. In other words, the freqeuncies of the observed values are
higher than the expected frequencies resulting from estimating a normal
distribution without accounting for skewness.</li>
<li>In the PIT histogram the misspecification is not clearly detectable,
but generally a skewed PIT histograms, as seen here, indicates that the
central tendencies of the fit must be biased.</li>
<li>The Q-Q residual plots are positively and negatively curved for
right-skewed and left-skewed data, respectively. For right-skewed data,
corresponding to a model fit that is too skewed to the left, due to the
high frequency of low values in the lower range, the empirical quantile
residuals increase more slowly than the standard normal quantiles.
However, at the upper end of the distribution, the empirical quantiles
increase faster than the standard quantiles. In total, the Q-Q residual
plot must be positively curved. For the left-skewed data, corresponding
to a model fit that is too skewed to the right, the opposite is
true.</li>
<li>The worm plot shows the typical U-shape or reverse U-shape for the
model fits that are too skewed to the left or right, corresponding to
right and left skewed response values.</li>
</ul>
</div>
<div class="section level3">
<h3 id="other-misspecified-distribution-uniform-laplace">Other misspecified distribution: uniform, laplace<a class="anchor" aria-label="anchor" href="#other-misspecified-distribution-uniform-laplace"></a>
</h3>
<p>In the following, two further examples are shown, one with simulated
data from a uniform distribution, the second with simulated data from a
Laplace distribution. For both data sets, a linear model is estimated
without considering the true underlying response distribution.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## not accounting for uniform distributed data</span>
<span class="va">m12</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">yunif</span> <span class="op">~</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">d</span><span class="op">)</span>

<span class="co">## not accounting for laplace distributed data</span>
<span class="va">m13</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">ylaplace</span> <span class="op">~</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">d</span><span class="op">)</span></code></pre></div>
<p><img src="illustration_artificial_files/figure-html/qresiduals-7-1.png" width="80%" style="display: block; margin: auto;"></p>
<p><img src="illustration_artificial_files/figure-html/topmodels-7-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>Uniformly distributed data generally have lighter tails than the
normal distribution (depending on the lower and upper bounds, of
course), while the Laplace distribution here is characterized by heavier
tails and a higher probability mass in the center of the distribution
than in the normal distribution. Therefore, the uniformly and Laplace
distributed data lead to misspecified predictive distributions where the
tails are either too heavy or too light, respectively (compare the
previous examples “conditional heteroscedasticity” and “Student-t
distribution”, where the tails are too light, as well aa the cases
“tails too light/heavy” in the summary plot of <a href="graphical_evaluation_methodology.html">Graphical Evaluation:
Methodology</a>).</p>
<p>Here, uniformly distributed data result in a misspecifed model where
the tails of the predictive distribution are too heavy:</p>
<ul>
<li>In the rootogram, the overfitting of the values at both ends of the
predictive distribution is clearly visible. Here, the observed
frequencies are much lower than the expected frequencies, which is
consistent with the light tailed distributed data fitted by a linear
normal model. The present underfitting of intermediate values in the
rootogram likely relates to values drawn from the uniform distribution,
where a higher probability mass exists than in the normal
distribution.</li>
<li>In the PIT histogram, the misspecifications at the tails of the
underlying distribution are are not visible. In addition, the PIT
focuses on the difference between the probability masses of the uniform
distribution and the normal distribution located in the middle on both
tails. This superimposes a perhaps expected inverted U-shape, which
would match the underdispersion in the data corresponding to the
overdispersed model fit.</li>
<li>As before in the Q-Q residuals plot, the transformation of the
values to the normal distribution spreads the tails further, correctly
showing that the observed values are less extreme than expected. This
leads to a pronounced S-shape of the Q-Q plot.</li>
<li>In the wormplot, the misshape is further emphasized by plotting the
deviation between the empirical and theoretical quantiles on the Y-axis,
resulting in a distinct S-shape pattern, bending upwards on the left
side.</li>
</ul>
<p>Here, Laplace distributed data result in a misspecifed model where
the tails of the predictive distribution are too light:</p>
<ul>
<li>The values in the tails and the center of the predictive
distribution are underfitted, whereas the values in between are
overfitted. This is visible as a typical wave-like pattern in the
rootogram.</li>
<li>In the PIT histogram, even if the last bin is in this example
slightly higher, mostly the underfitting in the middle of the predictive
distribution is observed, indicating that more values occur here than
expected. A possibly expected U-shaped PIT histogram is not detectable,
since the heavier tails concern only few values, which are not
sufficiently resolved by the usual bin width within the PIT
histogram.</li>
<li>In the Q-Q residuals plot, due to a transformation to the normal
distribution, the tails are more widely spread, correctly showing that
the observed values are more extreme than expected. This leads to a
pronounced reverse S-shape of the Q-Q plot.</li>
<li>In the wormplot, the misshape is further emphasized by plotting the
deviation between the empirical and theoretical quantiles on the Y-axis,
which results in a clear S-shape pattern, bending down towards the
left.</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="count-data">Count data<a class="anchor" aria-label="anchor" href="#count-data"></a>
</h2>
<div class="section level3">
<h3 id="poisson">Poisson<a class="anchor" aria-label="anchor" href="#poisson"></a>
</h3>
<p>As a reference, first a Poisson model is fitted to Poisson
distributed data.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## correct model fit</span>
<span class="va">m14</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">ypois</span> <span class="op">~</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">d</span>, family <span class="op">=</span> <span class="va">poisson</span><span class="op">)</span></code></pre></div>
<p><img src="illustration_artificial_files/figure-html/topmodels-8-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>The model fit experiences no misspecifications resulting in a well
calibrated predictive distribution (compare the case “well calibrated”
in the summary plot of <a href="graphical_evaluation_methodology.html">Graphical Evaluation:
Methodology</a>):</p>
<ul>
<li>The rootogram shows that the observed and expected frequencies match
rather well, without any clear patterns of departure indicating a rather
good fit.</li>
<li>The PIT histogram is uniform, correspoding to a well calibrated
predicitve distribution.</li>
<li>The Q-Q residuals plot shows most points are located along the
bisecting line.</li>
<li>The worm plot is within its confidence intervals and shows only
slight deviations from a horizontal line (FIXME: why not completely
horizontal).</li>
</ul>
</div>
<div class="section level3">
<h3 id="negative-binomial">Negative binomial<a class="anchor" aria-label="anchor" href="#negative-binomial"></a>
</h3>
<p>Two models are fitted to simulated data from a negative binomial
distribution. In model <code>m15</code> an underlying Poisson
distribution is incorrectly assumed, in model <code>m16</code> the
negative binomial distribution is correctly accounted for by using
<code>glm.nb()</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## misspecified distribution leading to an overdispersed predictive distribution</span>
<span class="va">m15</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">ynegbin</span> <span class="op">~</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">d</span>, family <span class="op">=</span> <span class="va">poisson</span><span class="op">)</span>

<span class="co">## correct distributional assumption</span>
<span class="va">m16</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/glm.nb.html" class="external-link">glm.nb</a></span><span class="op">(</span><span class="va">ynegbin</span> <span class="op">~</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">d</span><span class="op">)</span></code></pre></div>
<p><img src="illustration_artificial_files/figure-html/qresiduals-9-1.png" width="80%" style="display: block; margin: auto;"></p>
<p><img src="illustration_artificial_files/figure-html/topmodels-9-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>The wrong distribution assumption results in not accounting for the
overdispersion in the data, which corresponds to an underdispersed
predictive disitriubtion (compare the case “underdispersed” in the
summary plot of <a href="graphical_evaluation_methodology.html">Graphical Evaluation:
Methodology</a>):</p>
<ul>
<li>In the rootogram, the wave-like pattern around the horizontal
reference line indicates that low and higher values are clearly
underfitted, while the values in between are overfitted. This is in
agreement with an uderdispersed model, underestimating the underlying
variance. The significant lack of fit for 0 could be an additional
indication of excess zeros.</li>
<li>The typical U-shape in the PIT histogram supports that the model is
underdispersed: The values attained by the predictive CDF at the
observations are located with increased frequency at both ends of the
CDF.</li>
<li>The Q-Q residuals plot shows that many observed values are more
extreme than expected, i.e., the data exhibit considerable
overdispersion that is not accounted for in the model fit. Probably due
to using positive count data, this is more ponounced for positive
quantile residuals shown in the upper right part of the Q-Q plot.</li>
<li>In the worm plot, the positive slope corresponds to the
underdispersed predictive distribution.</li>
</ul>
</div>
<div class="section level3">
<h3 id="zero-inflation">Zero-inflation<a class="anchor" aria-label="anchor" href="#zero-inflation"></a>
</h3>
<p>Two models are fitted to simulated count data with excess zeros; the
model <code>m17</code> is unable to account for zero inflation, while
model <code>m18</code> fits a zero-inflation regression model that
combines a point mass at zero with a Poisson model for higher counts and
therefore fits the excess zeros perfectly.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## not accouting for zero inflation</span>
<span class="va">m17</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">yzip</span> <span class="op">~</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">d</span>, family <span class="op">=</span> <span class="va">poisson</span><span class="op">)</span>

<span class="co">## accouting for zero inflation</span>
<span class="va">m18</span> <span class="op">&lt;-</span> <span class="fu">pscl</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pscl/man/zeroinfl.html" class="external-link">zeroinfl</a></span><span class="op">(</span><span class="va">yzip</span> <span class="op">~</span> <span class="va">x</span> <span class="op">|</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">d</span>, dist <span class="op">=</span> <span class="st">"poisson"</span><span class="op">)</span></code></pre></div>
<p><img src="illustration_artificial_files/figure-html/qresiduals-10-1.png" width="80%" style="display: block; margin: auto;"></p>
<p><img src="illustration_artificial_files/figure-html/topmodels-10-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>Excess zeros are inevitably linked to overdispersion, so the
misspecified model fit without accounting for zero inflation has similar
patterns to an underdispersive predictive distribution (compare the
previous example with “negative binomial” distributed data and
“underdispersed” in the summary plot of <a href="graphical_evaluation_methodology.html">Graphical Evaluation:
Methodology</a>):</p>
<ul>
<li>In the rootogram, the wave-like pattern indicates that excess zeros
are clearly underfitted, high values are slightly underfitted and values
in between are overfitted. The significant lack of fit for 0 corresponds
well with the excess zeros.</li>
<li>The typical U-shape in the PIT histogram supports that the model is
underdispersed.</li>
<li>The Q-Q residuals plot indicates that some observed values are more
extreme than expected, i.e., the data exhibit overdispersion that is not
accounted for in the model fit.</li>
<li>In the worm plot, the positive slope corresponds to the
underdispersed predictive distribution. The reverse trends at the outer
tails of the wormplot are due to (FIXME: why?).</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Achim Zeileis, Moritz N. Lang, Reto Stauffer.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
