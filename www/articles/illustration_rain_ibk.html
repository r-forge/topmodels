<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Illustration: Precipitation Forecasts in Innsbruck • topmodels</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Illustration: Precipitation Forecasts in Innsbruck">
<meta property="og:description" content="topmodels">
<meta property="og:image" content="https://topmodels.R-Forge.R-project.org/logo.png">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@MoritzNLang">
<meta name="twitter:site" content="@MoritzNLang">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">topmodels</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3-0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/topmodels.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/goodness_of_fit.html">Goodness of Fit of Probabilistic Regression Models</a>
    </li>
    <li>
      <a href="../articles/graphics.html">Graphics for Assessing Goodness of Fit</a>
    </li>
    <li>
      <a href="../articles/illustration_fifa_2018.html">Illustration: Goals in the 2018 FIFA World Cup</a>
    </li>
    <li>
      <a href="../articles/illustration_rain_ibk.html">Illustration: Precipitation Forecasts in Innsbruck</a>
    </li>
    <li>
      <a href="../articles/illustration_artificial.html">Illustration: Artificial Data</a>
    </li>
    <li>
      <a href="../articles/implementation.html">Implementation Overview</a>
    </li>
    <li>
      <a href="../articles/procast.html">Probabilistic Forecasting Infrastructure</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li>
  <a href="../contact.html">Contact</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Illustration: Precipitation Forecasts in
Innsbruck</h1>
            
      
      
      <div class="hidden name"><code>illustration_rain_ibk.Rmd</code></div>

    </div>

    
    
<p>The second example models 3 day-accumulated precipitation sums using
a Logistic distribution censored at zero accounting for non-negative
precipitation sums. The use case builds heavily on the vignette <a href="https://cran.r-project.org/web/packages/crch/vignettes/crch.pdf" class="external-link">“Heteroscedastic
Censored and Truncated Regression with crch”</a> given in <a href="https://CRAN.R-project.org/package=crch" class="external-link"><code>crch</code></a> by
<span class="citation">Messner, Mayr, and Zeileis (2016)</span>.</p>
<div class="section level2">
<h2 id="precipitation-forecasts">Precipitation forecasts<a class="anchor" aria-label="anchor" href="#precipitation-forecasts"></a>
</h2>
<p>This use-case discusses a weather forecast example application of
censored regression models. The example is taken from the vignette <a href="https://cran.r-project.org/web/packages/crch/vignettes/crch.pdf" class="external-link">“Heteroscedastic
Censored and Truncated Regression with crch”</a> provided for the
package <a href="https://CRAN.R-project.org/package=crch" class="external-link"><code>crch</code></a> by
<span class="citation">Messner, Mayr, and Zeileis (2016)</span>.</p>
<p>Weather forecasts are usually based on numerical weather prediction
(NWP) models, which take the current state of the atmosphere and
calculate future weather by numerically simulating the main atmospheric
processes. However, due to uncertain initial conditions and unknown or
unresolved processes, these numerical predictions are always subject to
errors. To estimate these errors, many weather centers produce what are
called ensemble forecasts: multiple NWP runs that use different initial
conditions and model formulations. Unfortunately, these ensemble
forecasts cannot account for all sources of error, so they are often
still biased and uncalibrated. Therefore, they are often calibrated and
corrected for systematic errors through statistical post-processing.</p>
<p>One popular post-processing method is heteroscedastic linear
regression where the ensemble mean is used as regressor for the location
and the ensemble standard deviation or variance is used as regressor for
the scale <span class="citation">(Gneiting et al. 2005)</span>. The
following example applies heteroscedastic censored regression with a
logistic distribution assumption to precipitation data in Innsbruck
(Austria).</p>
<p>The <code>RainIbk</code> data set contains observed 3 day-accumulated
precipitation amounts (<code>rain</code>) and the corresponding 11
member ensemble forecasts of total accumulated precipitation amount
between 5 and 8 days in advance (<code>rainfc.1</code>,
<code>rainfc.2</code>, … <code>rainfc.11</code>). In previous studies it
has been shown that it is of advantage to model the square root of
precipitation rather than precipitation itself. Thus all precipitation
amounts are square rooted before ensemble mean and standard deviation
are derived. Furthermore, events with no variation in the ensemble are
omitted:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"RainIbk"</span>, package <span class="op">=</span> <span class="st">"crch"</span><span class="op">)</span>
<span class="va">RainIbk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">RainIbk</span><span class="op">)</span>
<span class="va">RainIbk</span><span class="op">$</span><span class="va">ensmean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">RainIbk</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">'^rainfc'</span>,<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">RainIbk</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>, <span class="fl">1</span>, <span class="va">mean</span><span class="op">)</span>
<span class="va">RainIbk</span><span class="op">$</span><span class="va">enssd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">RainIbk</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">'^rainfc'</span>,<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">RainIbk</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>, <span class="fl">1</span>, <span class="va">sd</span><span class="op">)</span>
<span class="va">RainIbk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">RainIbk</span>, <span class="va">enssd</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="from-linear-regression-to-distributional-regression-models">From linear regression to distributional regression models<a class="anchor" aria-label="anchor" href="#from-linear-regression-to-distributional-regression-models"></a>
</h2>
<p>For comparison we fit a homoscedastic linear regression model using
the least squares approach for <code>rain</code> with
<code>ensmean</code> as regressor. As a more appropriate model for
<code>rain</code> accounting for non-negative precipitation sums, we fit
a hetereoscedastic censored model assuming an underlying logistic
response distribution with <code>ensmean</code> as regressor for the
location and <code>log(enssd)</code> as regressor for the scale:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## linear model</span>
<span class="va">m_lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">rain</span> <span class="op">~</span> <span class="va">ensmean</span>, data <span class="op">=</span> <span class="va">RainIbk</span><span class="op">)</span>

<span class="co">## heteroscedastic censored regression with a logistic distribution assumption</span>
<span class="va">m_hclog</span> <span class="op">&lt;-</span> <span class="fu">crch</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/crch/man/crch.html" class="external-link">crch</a></span><span class="op">(</span><span class="va">rain</span> <span class="op">~</span> <span class="va">ensmean</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">enssd</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">RainIbk</span>, left <span class="op">=</span> <span class="fl">0</span>,
  dist <span class="op">=</span> <span class="st">"logistic"</span><span class="op">)</span></code></pre></div>
<p>In the scatterplot of <code>rain</code> against <code>ensmean</code>
it can be seen, that precipitation is clearly non-negative with many
zero observations. Thus the censored regression model
<code>m_hclog</code> is more suitable than the linear regression model
to estimate the underlying relationship:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rain</span> <span class="op">~</span> <span class="va">ensmean</span>, data <span class="op">=</span> <span class="va">RainIbk</span>, pch <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html" class="external-link">gray</a></span><span class="op">(</span><span class="fl">0</span>, alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">m_lm</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, col <span class="op">=</span> <span class="fl">3</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">m_hclog</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, col <span class="op">=</span> <span class="fl">4</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, lwd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>, 
  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"m_lm"</span>, <span class="st">"m_hclog"</span><span class="op">)</span>, bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></code></pre></div>
<p><img src="illustration_rain_ibk_files/figure-html/unnamed-chunk-1-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="model-evaluation-marginal-calibration">Model evaluation: Marginal calibration<a class="anchor" aria-label="anchor" href="#model-evaluation-marginal-calibration"></a>
</h2>
<p>The significant underfitting of zero observations is also very
apparent in the <em>rootogramm</em> of the linear model, as it does not
correctly account for the point mass at zero. Additionally, a weak
wavelike pattern indicates a slight overfitting of precipitation sums
between zero and 5mm and an underfitting of precipitation sums above. In
contrast, the censored logistic regression <code>m_hclog</code> provides
a pretty good marginal fit, where the expected squared frequencies
closely match the squared observed frequencies:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">r1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rootogram.html">rootogram</a></span><span class="op">(</span><span class="va">m_lm</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">r2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rootogram.html">rootogram</a></span><span class="op">(</span><span class="va">m_hclog</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">r1</span>, <span class="va">r2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="illustration_rain_ibk_files/figure-html/unnamed-chunk-2-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="model-evaluation-probabilistic-calibration">Model evaluation: Probabilistic calibration<a class="anchor" aria-label="anchor" href="#model-evaluation-probabilistic-calibration"></a>
</h2>
<p>The <em>PIT histogram</em> of the linear model <code>m_lm</code> is
skewed, indicating a misfit in terms of the probabilistic calibration,
whereas the <em>PIT histogram</em> of the linear model is rather
uniformly distributed.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pithist.html">pithist</a></span><span class="op">(</span><span class="va">m_lm</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pithist.html">pithist</a></span><span class="op">(</span><span class="va">m_hclog</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="illustration_rain_ibk_files/figure-html/unnamed-chunk-3-1.png" width="700" style="display: block; margin: auto;"></p>
<p>For a better comparison of the two model fits, alternatively a
line-style <em>PIT histogram</em> can also be shown:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span><span class="op">)</span>, colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>, style <span class="op">=</span> <span class="st">"line"</span>, single_graph <span class="op">=</span> <span class="cn">TRUE</span>, confint_col <span class="op">=</span> <span class="fl">1</span>, confint <span class="op">=</span> <span class="st">"line"</span>, ref <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="illustration_rain_ibk_files/figure-html/unnamed-chunk-4-1.png" width="700" style="display: block; margin: auto;"></p>
<p>To further analyse the misfit of the linear model in terms of
probabilistic calibration, we transform the PIT residuals to the normal
scale and increase the number of breaks in the <em>PIT histogram</em>.
Transforming to the normal scale spreads the values at the tails of the
distribution further apart, and increasing the breaks prevents potential
masking of small scale patterns.</p>
<p>We can see that the distribution of PIT residuals is right skewed
with more values between -2 and 0, but less values between 0 and 2
compared to the standard normal distribution:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/pithist.html">pithist</a></span><span class="op">(</span><span class="va">m_lm</span>, breaks <span class="op">=</span> <span class="fl">50</span>, trafo <span class="op">=</span> <span class="va">qnorm</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="illustration_rain_ibk_files/figure-html/unnamed-chunk-5-1.png" width="700" style="display: block; margin: auto;"></p>
<p>This is also reflected in the pattern of the <em>Q-Q plot</em> of the
linear model: Due to the high frequency in values between -2 and 0, the
observed quantile residuals increase slower in this region relative to
the standard normal quantiles. However, the low frequency of quantile
residuals above zero leads to an higher increase in quantile residuals
compared to the standard normal quantiles.</p>
<p>In summary, the <em>Q-Q plot</em> of the linear model has a positive
curvature, bending up at both ends of the distributional tails. The
censored logistic regression <code>m_hclog</code> follows more or less
the reference line indicating normally distributed quantile
residuals:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">q1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/qqrplot.html">qqrplot</a></span><span class="op">(</span><span class="va">m_lm</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">q2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/qqrplot.html">qqrplot</a></span><span class="op">(</span><span class="va">m_hclog</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">q1</span>, <span class="va">q2</span><span class="op">)</span>, colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.8</span>, single_graph <span class="op">=</span> <span class="cn">TRUE</span>, simint <span class="op">=</span> <span class="cn">FALSE</span>, confint <span class="op">=</span><span class="st">"line"</span><span class="op">)</span></code></pre></div>
<p><img src="illustration_rain_ibk_files/figure-html/unnamed-chunk-6-1.png" width="700" style="display: block; margin: auto;"></p>
<p>Consistent with the pattern of right-skewed PIT residuals
corresponding to a “too left-skewed” fitted distribution, a U-shaped
pattern is evident in the <em>worm plot</em> of the linear model; the
censored logistic is more or less flat around zero.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">w1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wormplot.html">wormplot</a></span><span class="op">(</span><span class="va">m_lm</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">w2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wormplot.html">wormplot</a></span><span class="op">(</span><span class="va">m_hclog</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">w1</span>, <span class="va">w2</span><span class="op">)</span>, colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.8</span>, single_graph <span class="op">=</span> <span class="cn">TRUE</span>, simint <span class="op">=</span> <span class="cn">FALSE</span>, confint <span class="op">=</span><span class="st">"line"</span><span class="op">)</span></code></pre></div>
<p><img src="illustration_rain_ibk_files/figure-html/unnamed-chunk-7-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Gneiting+Raftery+Westveld+Goldman:2005" class="csl-entry">
Gneiting, Tilmann, Adrian E. Raftery, Anton H. Westveld, and Tom
Goldman. 2005. <span>“Calibrated Probabilistic Forecasting Using
Ensemble Model Output Statistics and Minimum <span>CRPS</span>
Estimation.”</span> <em>Monthly Weather Review</em> 133 (5): 1098–118.
https://doi.org/<a href="http://dx.doi.org/10.1175/MWR2904.1" class="external-link">http://dx.doi.org/10.1175/MWR2904.1</a>.
</div>
<div id="ref-Messner+Mayr+Zeileis:2016" class="csl-entry">
Messner, Jakob W., Georg J. Mayr, and Achim Zeileis. 2016.
<span>“Heteroscedastic Censored and Truncated Regression with <span class="nocase">crch</span>.”</span> <em>The R Journal</em> 8 (1):
173–81. <a href="https://doi.org/10.32614/RJ-2016-012" class="external-link">https://doi.org/10.32614/RJ-2016-012</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Achim Zeileis, Moritz N. Lang, Reto Stauffer.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
