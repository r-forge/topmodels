<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Graphical Model Assessment under Different Model Misspecifications • topmodels</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Graphical Model Assessment under Different Model Misspecifications">
<meta property="og:description" content="topmodels">
<meta property="og:image" content="https://topmodels.R-Forge.R-project.org/logo.png">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@MoritzNLang">
<meta name="twitter:site" content="@MoritzNLang">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">topmodels</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1-0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/topmodels.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/graphical_evaluation_methodology.html">Graphical Evaluation: Methodology</a>
    </li>
    <li>
      <a href="../articles/graphical_evaluation_simulations.html">Graphical Evaluation: Simulations</a>
    </li>
    <li>
      <a href="../articles/graphical_evaluation_realcases.html">Graphical Evaluation: Real Cases</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li>
  <a href="../contact.html">Contact</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Graphical Model Assessment under Different Model Misspecifications</h1>
                        <h4 class="author">Moritz Lang, Achim Zeileis</h4>
            
      
      
      <div class="hidden name"><code>graphical_model_assessment_original.Rmd</code></div>

    </div>

    
    
<style type="text/css">
script src = "https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"
</style>
<script type="text/javascript">
 $(document).ready(function() {
    $('body').prepend('<div class=\"zoomDiv\"><img src=\"\" class=\"zoomImg\"></div>');
    // onClick function for all plots (img's)
    $('img:not(.zoomImg)').click(function() {
      $('.zoomImg').attr('src', $(this).attr('src')).css({width: '100%'});
      $('.zoomDiv').css({opacity: '1', width: 'auto', border: '1px solid white', borderRadius: '5px', position: 'fixed', top: '50%', left: '50%', marginRight: '-50%', transform: 'translate(-50%, -50%)', boxShadow: '0px 0px 50px #888888', zIndex: '50', overflow: 'auto', maxHeight: '100%'});
    });
    // onClick function for zoomImg
    $('img.zoomImg').click(function() {
      $('.zoomDiv').css({opacity: '0', width: '0%'}); 
    });
  });
</script><div id="a-wrong-distributional-assumption-wo-regressors" class="section level2">
<h2 class="hasAnchor">
<a href="#a-wrong-distributional-assumption-wo-regressors" class="anchor"></a>1a Wrong distributional assumption w/o regressors</h2>
<p>A Poisson model without regressors is fitted to two simulated datasets from a Poisson and a negative binomial distribution; both distributions have a mean <span class="math inline">\(\mu = 3\)</span>, the negative binomal has a shape parameter <span class="math inline">\(\Theta = 2\)</span>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">d1a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  yp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span><span class="op">(</span><span class="fl">100</span>, lambda <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,
  ynb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/NegBinomial.html">rnbinom</a></span><span class="op">(</span><span class="fl">100</span>, mu <span class="op">=</span> <span class="fl">3</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="graphical_model_assessment_original_files/figure-html/curves-1a-1.png" alt="lala" width="60%"><p class="caption">
lala
</p>
</div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## correct Poisson model fit (DGP: Poisson)</span>
<span class="va">m1a_p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">yp</span> <span class="op">~</span> <span class="fl">1</span>, family <span class="op">=</span> <span class="va">poisson</span>, data <span class="op">=</span> <span class="va">d1a</span><span class="op">)</span>

<span class="co">## incorrect Poisson model fit (DGP: neg. binomial)</span>
<span class="va">m1a_nb1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">ynb</span> <span class="op">~</span> <span class="fl">1</span>, family <span class="op">=</span> <span class="va">poisson</span>, data <span class="op">=</span> <span class="va">d1a</span><span class="op">)</span>

<span class="co">## correct neg. binomial model fit  (DGP: Neg. binomial)</span>
<span class="va">m1a_nb2</span> <span class="op">&lt;-</span> <span class="fu">glm.nb</span><span class="op">(</span><span class="va">ynb</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">d1a</span><span class="op">)</span></code></pre></div>
<p><img src="graphical_model_assessment_original_files/figure-html/qresiduals-1a-1.png" width="80%" style="display: block; margin: auto;"></p>
<p><img src="graphical_model_assessment_original_files/figure-html/topmodels-1a-1.png" width="100%"></p>
<p>In the first and third line, a Poisson model and negative binomial model is fitted to simulated data from a Poisson and negative binomial distribution, respectively. In the second line, a false response distribution is assumed by fitting a Poisson model to simulated data from a negative binomial model. The following characteristics can be seen in the model assessment graphs for the misspecified model (2nd line):</p>
<ul>
<li>
<strong>Wave-like pattern in the rootogram</strong> around the horizontal reference line: The data exhibit too many small counts, notably zeros, as well as too many large counts for a Poisson model to provide an adequate fit. This leads to a misspecified model fit reflecting a substantial amount of overdispersion that is not captured by the fitted Poisson distribution (underdispersive model fit) <span class="citation">(Kleiber and Zeileis 2016)</span>.</li>
<li>
<strong>U-shaped PIT</strong>: The values attained by the predictive CDF at the observations are located with increased frequency at both ends of the CDF, indicating an underdispersed predictive distribution (model fit).</li>
<li>
<strong>Inverse S-shaped QQ-plot</strong>: Quantile residuals are over-dispersed relative to the normal distribution, i.e., we experience an increased number of outliers or the underlying distribution of the residuals has fatter tails than a normal distribution <span class="citation">(Love 2018; Yearsley 2021)</span>. In terms of quantiles this means that the first quantile is much less than the first theoretical quantile and the last quantile is greater than the last theoretical quantile. This is reflected in the corresponding Q-Q plot <span class="citation">(Kross 2016)</span>.</li>
</ul>
</div>
<div id="b-wrong-distributional-assumption-w-regressors" class="section level2">
<h2 class="hasAnchor">
<a href="#b-wrong-distributional-assumption-w-regressors" class="anchor"></a>1b Wrong distributional assumption w/ regressors</h2>
<p>Artificial data from negative binomial and Poisson distribution with regressors:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">d1b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">d1b</span><span class="op">$</span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">d1b</span><span class="op">$</span><span class="va">x</span>
<span class="va">d1b</span><span class="op">$</span><span class="va">yp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span><span class="op">(</span><span class="fl">500</span>, lambda <span class="op">=</span> <span class="va">d1b</span><span class="op">$</span><span class="va">mu</span><span class="op">)</span>
<span class="va">d1b</span><span class="op">$</span><span class="va">ynb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/NegBinomial.html">rnbinom</a></span><span class="op">(</span><span class="fl">500</span>, mu <span class="op">=</span> <span class="va">d1b</span><span class="op">$</span><span class="va">mu</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="graphical_model_assessment_original_files/figure-html/curves-1b-1.png" width="60%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## correctly specified Poisson model fit</span>
<span class="va">m1b_p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">yp</span> <span class="op">~</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">d1b</span>, family <span class="op">=</span> <span class="va">poisson</span><span class="op">)</span>

<span class="co">## misspecified Poisson model fit</span>
<span class="va">m1b_nb1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">ynb</span> <span class="op">~</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">d1b</span>, family <span class="op">=</span> <span class="va">poisson</span><span class="op">)</span>

<span class="co">## correctly specified Negbin model fit</span>
<span class="va">m1b_nb2</span> <span class="op">&lt;-</span> <span class="fu">glm.nb</span><span class="op">(</span><span class="va">ynb</span> <span class="op">~</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">d1b</span><span class="op">)</span></code></pre></div>
<p><img src="graphical_model_assessment_original_files/figure-html/qresiduals-1b-1.png" width="80%" style="display: block; margin: auto;"></p>
<p><img src="graphical_model_assessment_original_files/figure-html/topmodels-1b-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>As for the example 1a, a false response distribution is assumed for the 2nd model by fitting a Poisson model to simulated data from a negative binomial model. Hence, similar characteristics can be seen in the model assessment graphs for the misspecified model (2nd line).</p>
</div>
<div id="a-underestimating-the-tails-of-the-distribution-wo-regressors" class="section level2">
<h2 class="hasAnchor">
<a href="#a-underestimating-the-tails-of-the-distribution-wo-regressors" class="anchor"></a>2a Underestimating the tails of the distribution w/o regressors</h2>
<p>Artificial data from a Student t distribution with four degrees of freedom without regressors:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">d2a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  yt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">rt</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">4</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="graphical_model_assessment_original_files/figure-html/curves-2a-1.png" width="60%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## correct student-t fit</span>
<span class="va">m2a_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/crch/man/crch.html">crch</a></span><span class="op">(</span><span class="va">yt</span> <span class="op">~</span> <span class="fl">1</span>, dist <span class="op">=</span> <span class="st">"student"</span>, data <span class="op">=</span> <span class="va">d2a</span><span class="op">)</span>

<span class="co">## incorrect normal fit</span>
<span class="va">m2a_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/crch/man/crch.html">crch</a></span><span class="op">(</span><span class="va">yt</span> <span class="op">~</span> <span class="fl">1</span>, dist <span class="op">=</span> <span class="st">"gaussian"</span>, data <span class="op">=</span> <span class="va">d2a</span><span class="op">)</span></code></pre></div>
<p><img src="graphical_model_assessment_original_files/figure-html/qresiduals-2a-1.png" width="60%" style="display: block; margin: auto;"></p>
<p><img src="graphical_model_assessment_original_files/figure-html/topmodels-2a-1.png" width="100%"></p>
<p>Wrong assumption of the underlying response distribution, estimating a Normal distribution instead of a Student t distribution with four degrees of freedom, leads to an underestimting of the heavy tails and an underdispersive model fit (shown in the 2nd line):</p>
<ul>
<li>Tails too light -&gt; overdispersive model fit.</li>
<li>
<strong>inverse U-shaped PIT</strong>, <strong>inverse S-shaped QQ-plot</strong>.</li>
</ul>
</div>
<div id="b-underestimating-the-tails-of-the-distribution-w-regressors" class="section level2">
<h2 class="hasAnchor">
<a href="#b-underestimating-the-tails-of-the-distribution-w-regressors" class="anchor"></a>2b Underestimating the tails of the distribution w/ regressors</h2>
<p>Artificial data from a Student t distribution with four degrees of freedom with regressors:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">d2b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">d2b</span><span class="op">$</span><span class="va">yt</span> <span class="op">&lt;-</span> <span class="va">d2b</span><span class="op">$</span><span class="va">x</span> <span class="op">+</span> <span class="fl">1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">rt</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">4</span><span class="op">)</span>
<span class="va">d2b</span><span class="op">$</span><span class="va">yn</span> <span class="op">&lt;-</span> <span class="va">d2b</span><span class="op">$</span><span class="va">x</span> <span class="op">+</span> <span class="fl">1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span></code></pre></div>
<p><img src="graphical_model_assessment_original_files/figure-html/curves-2b-1.png" width="60%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## correct student-t fit</span>
<span class="va">m2b_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/crch/man/crch.html">crch</a></span><span class="op">(</span><span class="va">yt</span> <span class="op">~</span> <span class="va">x</span>, dist <span class="op">=</span> <span class="st">"student"</span>, data <span class="op">=</span> <span class="va">d2b</span><span class="op">)</span>

<span class="co">## incorrect normal fit</span>
<span class="va">m2b_n1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/crch/man/crch.html">crch</a></span><span class="op">(</span><span class="va">yt</span> <span class="op">~</span> <span class="va">x</span>, dist <span class="op">=</span> <span class="st">"gaussian"</span>, data <span class="op">=</span> <span class="va">d2b</span><span class="op">)</span>

<span class="co">## correct normal fit</span>
<span class="va">m2b_n2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/crch/man/crch.html">crch</a></span><span class="op">(</span><span class="va">yn</span> <span class="op">~</span> <span class="va">x</span>, dist <span class="op">=</span> <span class="st">"gaussian"</span>, data <span class="op">=</span> <span class="va">d2b</span><span class="op">)</span></code></pre></div>
<p><img src="graphical_model_assessment_original_files/figure-html/qresiduals-2b-1.png" width="80%" style="display: block; margin: auto;"></p>
<p><img src="graphical_model_assessment_original_files/figure-html/topmodels-2b-1.png" width="100%"></p>
<p>Wrong assumption of the underlying response distribution, estimating a Normal distribution instead of a Student t distribution with four degrees of freedom, leads to an underestimting of the heavy tails and an underdispersive model fit (shown in the 2nd line):</p>
<ul>
<li>Tails too light -&gt; overdispersive model fit.</li>
<li>
<strong>inverse U-shaped PIT</strong>, <strong>inverse S-shaped QQ-plot</strong>.</li>
</ul>
</div>
<div id="a-over-underdispersive-model-fits-wo-regressors" class="section level2">
<h2 class="hasAnchor">
<a href="#a-over-underdispersive-model-fits-wo-regressors" class="anchor"></a>3a Over-/underdispersive model fits w/o regressors</h2>
<p>Artificial data from a Gaussian, Uniform and Laplace (mu = 0, s = 0.4) distribution without regressors:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">d3a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  yn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span>,
  yu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">1000</span>, min <span class="op">=</span> <span class="op">-</span><span class="fl">6</span>, max <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>,
  yl <span class="op">=</span> <span class="fu">rlaplace</span><span class="op">(</span><span class="fl">1000</span>, m <span class="op">=</span> <span class="fl">0</span>, s <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="graphical_model_assessment_original_files/figure-html/curves-3a-1.png" width="60%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## correct gaussian fit</span>
<span class="va">m3a_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/crch/man/crch.html">crch</a></span><span class="op">(</span><span class="va">yn</span> <span class="op">~</span> <span class="fl">1</span>, dist <span class="op">=</span> <span class="st">"gaussian"</span>, data <span class="op">=</span> <span class="va">d3a</span><span class="op">)</span>

<span class="co">## incorrect fit (underdispersive model fit)</span>
<span class="co">## [U-shaped PIT, S-shaped QQ-plot, "thin tails" worm plot]</span>
<span class="va">m3a_u</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/crch/man/crch.html">crch</a></span><span class="op">(</span><span class="va">yu</span> <span class="op">~</span> <span class="fl">1</span>, dist <span class="op">=</span> <span class="st">"gaussian"</span>, data <span class="op">=</span> <span class="va">d3a</span><span class="op">)</span>

<span class="co">## incorrect fit (overdispersive model fit)</span>
<span class="co">## [inverse U-shaped PIT, inverse S-shaped QQ-plot, "fat tails" worm plot]</span>
<span class="va">m3a_l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/crch/man/crch.html">crch</a></span><span class="op">(</span><span class="va">yl</span> <span class="op">~</span> <span class="fl">1</span>, dist <span class="op">=</span> <span class="st">"gaussian"</span>, data <span class="op">=</span> <span class="va">d3a</span><span class="op">)</span></code></pre></div>
<p><img src="graphical_model_assessment_original_files/figure-html/qresiduals-3a-1.png" width="80%" style="display: block; margin: auto;"></p>
<p><img src="graphical_model_assessment_original_files/figure-html/topmodels-3a-1.png" width="100%"></p>
<p>Wrong assumption of underlying distribution, Uniform or Laplace distribution instead of a Normal distribution, leads to an underdispersive and overdispersive model fit (shown in the 2nd and 3rd lines):</p>
<ul>
<li>Underdispersive model fit: <strong>U-shaped PIT, S-shaped QQ-plot, “thin tails” worm plot</strong>
</li>
<li>Overdispersive model fit: <strong>inverse U-shaped PIT, inverse S-shaped QQ-plot, “fat tails” worm plot</strong>
</li>
</ul>
<p>The largest/smallest values are not as large/small as expected or under-dispersed data has a reduced number of outliers (i.e. the true underlying distribution has thinner tails).</p>
</div>
<div id="b-over-underdispersive-model-fits-w-regressors" class="section level2">
<h2 class="hasAnchor">
<a href="#b-over-underdispersive-model-fits-w-regressors" class="anchor"></a>3b Over-/underdispersive model fits w/ regressors</h2>
<p>Artificial data from a Gaussian, Uniform and Laplace distribution with regressors:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">d3b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">d3b</span><span class="op">$</span><span class="va">yn</span> <span class="op">&lt;-</span> <span class="fl">0</span> <span class="op">+</span> <span class="fl">1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1000</span>, mean <span class="op">=</span> <span class="va">d3b</span><span class="op">$</span><span class="va">x</span><span class="op">)</span>
<span class="va">d3b</span><span class="op">$</span><span class="va">yu</span> <span class="op">&lt;-</span> <span class="fl">0</span> <span class="op">+</span> <span class="fl">1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">1000</span>, min <span class="op">=</span> <span class="va">d3b</span><span class="op">$</span><span class="va">x</span> <span class="op">-</span> <span class="fl">1</span>, max <span class="op">=</span> <span class="va">d3b</span><span class="op">$</span><span class="va">x</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">d3b</span><span class="op">$</span><span class="va">yl</span> <span class="op">&lt;-</span> <span class="fl">0</span> <span class="op">+</span> <span class="fl">1</span> <span class="op">*</span> <span class="fu">rlaplace</span><span class="op">(</span><span class="fl">1000</span>, m <span class="op">=</span> <span class="va">d3b</span><span class="op">$</span><span class="va">x</span>, s <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span></code></pre></div>
<p><img src="graphical_model_assessment_original_files/figure-html/curves-3b-1.png" width="60%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## correct gaussian fit</span>
<span class="va">m3b_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/crch/man/crch.html">crch</a></span><span class="op">(</span><span class="va">yn</span> <span class="op">~</span> <span class="va">x</span>, dist <span class="op">=</span> <span class="st">"gaussian"</span>, data <span class="op">=</span> <span class="va">d3b</span><span class="op">)</span>

<span class="co">## incorrect fit (underdispersive model fit)</span>
<span class="co">## [U-shaped PIT, S-shaped QQ-plot, "thin tails" worm plot]</span>
<span class="va">m3b_u</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/crch/man/crch.html">crch</a></span><span class="op">(</span><span class="va">yu</span> <span class="op">~</span> <span class="va">x</span>, dist <span class="op">=</span> <span class="st">"gaussian"</span>, data <span class="op">=</span> <span class="va">d3b</span><span class="op">)</span>

<span class="co">## incorrect fit (overdispersive model fit)</span>
<span class="co">## [inverse U-shaped PIT, inverse S-shaped QQ-plot, "fat tails" worm plot]</span>
<span class="va">m3b_l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/crch/man/crch.html">crch</a></span><span class="op">(</span><span class="va">yl</span> <span class="op">~</span> <span class="va">x</span>, dist <span class="op">=</span> <span class="st">"gaussian"</span>, data <span class="op">=</span> <span class="va">d3b</span><span class="op">)</span></code></pre></div>
<p><img src="graphical_model_assessment_original_files/figure-html/qresiduals-3b-1.png" width="80%" style="display: block; margin: auto;"></p>
<p><img src="graphical_model_assessment_original_files/figure-html/topmodels-3b-1.png" width="100%"></p>
<p>Wrong assumption of underlying distribution, Uniform or Laplace distribution instead of a Normal distribution, leads to an underdispersive and overdispersive model fit (shown in the 2nd and 3rd lines):</p>
<ul>
<li>Underdispersive model fit: <strong>U-shaped PIT, S-shaped QQ-plot, “thin tails” worm plot</strong>
</li>
<li>Overdispersive model fit: <strong>inverse U-shaped PIT, inverse S-shaped QQ-plot, “fat tails” worm plot</strong>
</li>
</ul>
</div>
<div id="a-not-accounting-for-skewness-wo-regressors" class="section level2">
<h2 class="hasAnchor">
<a href="#a-not-accounting-for-skewness-wo-regressors" class="anchor"></a>4a Not Accounting for Skewness w/o regressors</h2>
<p>Artificial data from a Normal distribution with no skewness, as well as from a right skewed, and left skewed Normal distribution without regressors:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">d4a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  yn <span class="op">=</span> <span class="fu">rsn</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, xi <span class="op">=</span> <span class="fl">0</span>, omega <span class="op">=</span> <span class="fl">1</span>, alpha <span class="op">=</span> <span class="fl">0</span>, tau <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,
  yrs <span class="op">=</span> <span class="fu">rsn</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, xi <span class="op">=</span> <span class="fl">0</span>, omega <span class="op">=</span> <span class="fl">1</span>, alpha <span class="op">=</span> <span class="fl">5</span>, tau <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,
  yls <span class="op">=</span> <span class="fu">rsn</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, xi <span class="op">=</span> <span class="fl">0</span>, omega <span class="op">=</span> <span class="fl">1</span>, alpha <span class="op">=</span> <span class="op">-</span><span class="fl">5</span>, tau <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="graphical_model_assessment_original_files/figure-html/curves-4a-1.png" width="60%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## correct gaussian fit</span>
<span class="va">m4a_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/crch/man/crch.html">crch</a></span><span class="op">(</span><span class="va">yn</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">d4a</span>, dist <span class="op">=</span> <span class="st">"gaussian"</span><span class="op">)</span>

<span class="co">## incorrect fit: right-skewed residuals</span>
<span class="va">m4a_rs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/crch/man/crch.html">crch</a></span><span class="op">(</span><span class="va">yrs</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">d4a</span>, dist <span class="op">=</span> <span class="st">"gaussian"</span><span class="op">)</span>

<span class="co">## incorrect fit: left-skewed residuals</span>
<span class="va">m4a_ls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/crch/man/crch.html">crch</a></span><span class="op">(</span><span class="va">yls</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">d4a</span>, dist <span class="op">=</span> <span class="st">"gaussian"</span><span class="op">)</span></code></pre></div>
<p><img src="graphical_model_assessment_original_files/figure-html/qresiduals-4a-1.png" width="80%" style="display: block; margin: auto;"></p>
<p><img src="graphical_model_assessment_original_files/figure-html/topmodels-4a-1.png" width="100%"></p>
<p>Wrong assumption of underlying distribution, Normal distribution instead of rigth and left skewed Normal distriubtion, leads to a misspecified model fits (shown in the 2nd and 3rd lines):</p>
<ul>
<li>Right-skewed residuals: <strong>curved (positive skewed) QQ-Plot, U-shape wormplot</strong>
</li>
<li>Left-skewed residuals: <strong>curved (negative skewed) QQ-Plot, inverse U-shape wormplot</strong>
</li>
</ul>
</div>
<div id="b-not-accounting-for-skewness-wo-regressors" class="section level2">
<h2 class="hasAnchor">
<a href="#b-not-accounting-for-skewness-wo-regressors" class="anchor"></a>4b Not Accounting for Skewness w/o regressors</h2>
<p>Artificial data from a Normal distribution with no skewness, as well as from a right skewed, and left skewed Normal distribution with regressors:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">d4b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">15</span>, <span class="fl">1.2</span><span class="op">)</span>,
  <span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.4</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">d4b</span><span class="op">$</span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fl">0.4</span> <span class="op">+</span> <span class="fl">0.9</span> <span class="op">*</span> <span class="va">d4b</span><span class="op">$</span><span class="va">x</span>
<span class="va">d4b</span><span class="op">$</span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fl">0.3</span> <span class="op">+</span> <span class="fl">0.6</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">d4b</span><span class="op">$</span><span class="va">z</span><span class="op">)</span><span class="op">)</span>

<span class="va">d4b</span><span class="op">$</span><span class="va">yn</span> <span class="op">&lt;-</span> <span class="fu">rsn</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span>, xi <span class="op">=</span> <span class="va">d4b</span><span class="op">$</span><span class="va">mu</span>, omega <span class="op">=</span> <span class="va">d4b</span><span class="op">$</span><span class="va">sigma</span>, alpha <span class="op">=</span> <span class="fl">0</span>, tau <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="va">d4b</span><span class="op">$</span><span class="va">yrs</span> <span class="op">&lt;-</span> <span class="fu">rsn</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span>, xi <span class="op">=</span> <span class="va">d4b</span><span class="op">$</span><span class="va">mu</span>, omega <span class="op">=</span> <span class="va">d4b</span><span class="op">$</span><span class="va">sigma</span>, alpha <span class="op">=</span> <span class="fl">5</span>, tau <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="va">d4b</span><span class="op">$</span><span class="va">yls</span> <span class="op">&lt;-</span> <span class="fu">rsn</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span>, xi <span class="op">=</span> <span class="va">d4b</span><span class="op">$</span><span class="va">mu</span>, omega <span class="op">=</span> <span class="va">d4b</span><span class="op">$</span><span class="va">sigma</span>, alpha <span class="op">=</span> <span class="op">-</span><span class="fl">5</span>, tau <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<p><img src="graphical_model_assessment_original_files/figure-html/curves-4b-1.png" width="60%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## correct gaussian fit</span>
<span class="va">m4b_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/crch/man/crch.html">crch</a></span><span class="op">(</span><span class="va">yn</span> <span class="op">~</span> <span class="va">x</span> <span class="op">|</span> <span class="va">z</span>, data <span class="op">=</span> <span class="va">d4b</span>, dist <span class="op">=</span> <span class="st">"gaussian"</span><span class="op">)</span>

<span class="co">## incorrect fit: right-skewed residuals</span>
<span class="co">## [curved (positive skewed) QQ-Plot, U-shape wormplot]</span>
<span class="va">m4b_rs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/crch/man/crch.html">crch</a></span><span class="op">(</span><span class="va">yrs</span> <span class="op">~</span> <span class="va">x</span> <span class="op">|</span> <span class="va">z</span>, data <span class="op">=</span> <span class="va">d4b</span>, dist <span class="op">=</span> <span class="st">"gaussian"</span><span class="op">)</span>

<span class="co">## incorrect fit: left-skewed residuals</span>
<span class="co">## [curved (negative skewed) QQ-Plot, inverse U-shape wormplot]</span>
<span class="va">m4b_ls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/crch/man/crch.html">crch</a></span><span class="op">(</span><span class="va">yls</span> <span class="op">~</span> <span class="va">x</span> <span class="op">|</span> <span class="va">z</span>, data <span class="op">=</span> <span class="va">d4b</span>, dist <span class="op">=</span> <span class="st">"gaussian"</span><span class="op">)</span></code></pre></div>
<p><img src="graphical_model_assessment_original_files/figure-html/qresiduals-4b-1.png" width="80%" style="display: block; margin: auto;"></p>
<p><img src="graphical_model_assessment_original_files/figure-html/topmodels-4b-1.png" width="100%"></p>
<p>As for 4a, wrong assumption of underlying distribution, Normal distribution instead of rigth and left skewed Normal distriubtion, leads to a misspecified model fits (shown in the 2nd and 3rd lines):</p>
<ul>
<li>Right-skewed residuals: <strong>curved (positive skewed) QQ-Plot, U-shape wormplot</strong>
</li>
<li>Left-skewed residuals: <strong>curved (negative skewed) QQ-Plot, inverse U-shape wormplot</strong>
</li>
</ul>
</div>
<div id="a-not-accounting-for-truncation-wo-regressors" class="section level2">
<h2 class="hasAnchor">
<a href="#a-not-accounting-for-truncation-wo-regressors" class="anchor"></a>5a Not Accounting for Truncation w/o regressors</h2>
<p>Artificial data from Logistic distribution with and without truncation at zero. Data generating process without regressors:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">d5a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  ytn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/crch/man/tnorm.html">rtnorm</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">0.3</span>, <span class="fl">0.6</span>, left <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,
  yn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/crch/man/tnorm.html">rtnorm</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">0.3</span>, <span class="fl">0.6</span>, left <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="graphical_model_assessment_original_files/figure-html/curves-5a-1.png" width="60%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## correct truncated normal fit</span>
<span class="va">m5a_tn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/crch/man/crch.html">crch</a></span><span class="op">(</span><span class="va">ytn</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">d5a</span>, dist <span class="op">=</span> <span class="st">"gaussian"</span>, truncated <span class="op">=</span> <span class="cn">TRUE</span>, left <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>

<span class="co">## incorrect normal fit</span>
<span class="va">m5a_n1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/crch/man/crch.html">crch</a></span><span class="op">(</span><span class="va">ytn</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">d5a</span>, dist <span class="op">=</span> <span class="st">"gaussian"</span>, truncated <span class="op">=</span> <span class="cn">TRUE</span>, left <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span><span class="op">)</span>

<span class="co">## correct normal fit</span>
<span class="va">m5a_n2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/crch/man/crch.html">crch</a></span><span class="op">(</span><span class="va">yn</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">d5a</span>, dist <span class="op">=</span> <span class="st">"gaussian"</span>, truncated <span class="op">=</span> <span class="cn">TRUE</span>, left <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span><span class="op">)</span></code></pre></div>
<p><img src="graphical_model_assessment_original_files/figure-html/qresiduals-5a-1.png" width="80%" style="display: block; margin: auto;"></p>
<p><img src="graphical_model_assessment_original_files/figure-html/topmodels-5a-1.png" width="100%"></p>
<p>Wrong assumption of underlying distribution, not considering truncation at zero, leads to misspecified model fit in the 2nd line:</p>
<ul>
<li><span class="math inline">\(\dots\)</span></li>
</ul>
</div>
<div id="b-not-accounting-for-truncation-w-regressors" class="section level2">
<h2 class="hasAnchor">
<a href="#b-not-accounting-for-truncation-w-regressors" class="anchor"></a>5b Not Accounting for Truncation w/ regressors</h2>
<p>Artificial data from Logistic distribution with and without truncation at zero. Data generating process with regressors:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">d5b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/crch/man/tnorm.html">rtnorm</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, left <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,
  <span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="op">-</span><span class="fl">0.6</span>, <span class="fl">0.2</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">d5b</span><span class="op">$</span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fl">0.2</span> <span class="op">+</span> <span class="fl">1.8</span> <span class="op">*</span> <span class="va">d5b</span><span class="op">$</span><span class="va">x</span>
<span class="va">d5b</span><span class="op">$</span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fl">0.1</span> <span class="op">+</span> <span class="fl">0.6</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">d5b</span><span class="op">$</span><span class="va">z</span><span class="op">)</span><span class="op">)</span>

<span class="va">d5b</span><span class="op">$</span><span class="va">ytn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/crch/man/tnorm.html">rtnorm</a></span><span class="op">(</span><span class="fl">1000</span>, mean <span class="op">=</span> <span class="va">d5b</span><span class="op">$</span><span class="va">mu</span>, sd <span class="op">=</span> <span class="va">d5b</span><span class="op">$</span><span class="va">sigma</span>, left <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="va">d5b</span><span class="op">$</span><span class="va">yn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/crch/man/tnorm.html">rtnorm</a></span><span class="op">(</span><span class="fl">1000</span>, mean <span class="op">=</span> <span class="va">d5b</span><span class="op">$</span><span class="va">mu</span>, sd <span class="op">=</span> <span class="va">d5b</span><span class="op">$</span><span class="va">sigma</span><span class="op">)</span></code></pre></div>
<p><img src="graphical_model_assessment_original_files/figure-html/curves-5b-1.png" width="60%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## correct truncated normal fit</span>
<span class="va">m5b_tn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/crch/man/crch.html">crch</a></span><span class="op">(</span><span class="va">ytn</span> <span class="op">~</span> <span class="va">x</span> <span class="op">|</span> <span class="va">z</span>, data <span class="op">=</span> <span class="va">d5b</span>, dist <span class="op">=</span> <span class="st">"gaussian"</span>, truncated <span class="op">=</span> <span class="cn">TRUE</span>, left <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>

<span class="co">## incorrect normal fit</span>
<span class="va">m5b_n1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/crch/man/crch.html">crch</a></span><span class="op">(</span><span class="va">ytn</span> <span class="op">~</span> <span class="va">x</span> <span class="op">|</span> <span class="va">z</span>, data <span class="op">=</span> <span class="va">d5b</span>, dist <span class="op">=</span> <span class="st">"gaussian"</span>, truncated <span class="op">=</span> <span class="cn">TRUE</span>, left <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span><span class="op">)</span>

<span class="co">## correct normal fit</span>
<span class="va">m5b_n2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/crch/man/crch.html">crch</a></span><span class="op">(</span><span class="va">yn</span> <span class="op">~</span> <span class="va">x</span> <span class="op">|</span> <span class="va">z</span>, data <span class="op">=</span> <span class="va">d5b</span>, dist <span class="op">=</span> <span class="st">"gaussian"</span>, truncated <span class="op">=</span> <span class="cn">TRUE</span>, left <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span><span class="op">)</span></code></pre></div>
<p><img src="graphical_model_assessment_original_files/figure-html/qresiduals-5b-1.png" width="80%" style="display: block; margin: auto;"></p>
<p><img src="graphical_model_assessment_original_files/figure-html/topmodels-5b-1.png" width="100%"></p>
<p>Wrong assumption of underlying distribution, not considering truncation at zero, leads to misspecified model fit in the 2nd line:</p>
<ul>
<li><span class="math inline">\(\dots\)</span></li>
</ul>
</div>
<div id="a-not-accounting-for-censoring-wo-regressors" class="section level2">
<h2 class="hasAnchor">
<a href="#a-not-accounting-for-censoring-wo-regressors" class="anchor"></a>6a Not Accounting for Censoring w/o regressors</h2>
<p>Artificial data from Logistic distribution with and without censoring at zero. Data generating process without regressors:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">d6a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  ycn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/crch/man/cnorm.html">rcnorm</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, left <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,
  yn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/crch/man/cnorm.html">rcnorm</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, left <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><img src="graphical_model_assessment_original_files/figure-html/curves-6a-1.png" width="60%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## correct censored normal fit</span>
<span class="va">m6a_cn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/crch/man/crch.html">crch</a></span><span class="op">(</span><span class="va">ycn</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">d6a</span>, dist <span class="op">=</span> <span class="st">"gaussian"</span>, truncated <span class="op">=</span> <span class="cn">FALSE</span>, left <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>

<span class="co">## incorrect normal fit</span>
<span class="va">m6a_n1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/crch/man/crch.html">crch</a></span><span class="op">(</span><span class="va">ycn</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">d6a</span>, dist <span class="op">=</span> <span class="st">"gaussian"</span>, truncated <span class="op">=</span> <span class="cn">FALSE</span>, left <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span><span class="op">)</span>

<span class="co">## correct normal fit</span>
<span class="va">m6a_n2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/crch/man/crch.html">crch</a></span><span class="op">(</span><span class="va">yn</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">d6a</span>, dist <span class="op">=</span> <span class="st">"gaussian"</span>, truncated <span class="op">=</span> <span class="cn">FALSE</span>, left <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span><span class="op">)</span></code></pre></div>
<p><img src="graphical_model_assessment_original_files/figure-html/qresiduals-6a-1.png" width="80%" style="display: block; margin: auto;"></p>
<p><img src="graphical_model_assessment_original_files/figure-html/topmodels-6a-1.png" width="100%"></p>
<p>Wrong assumption of underlying distribution, not considering censoring at zero, leads to misspecified model fit in the 2nd line:</p>
<ul>
<li><span class="math inline">\(\dots\)</span></li>
</ul>
</div>
<div id="b-not-accounting-for-censoring-w-regressors" class="section level2">
<h2 class="hasAnchor">
<a href="#b-not-accounting-for-censoring-w-regressors" class="anchor"></a>6b Not Accounting for Censoring w/ regressors</h2>
<p>Artificial data from Logistic distribution with and without censoring at zero. Data generating process with regressors:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">d6b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/crch/man/cnorm.html">rcnorm</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, left <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,
  <span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="op">-</span><span class="fl">0.6</span>, <span class="fl">0.2</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">d6b</span><span class="op">$</span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fl">0.2</span> <span class="op">+</span> <span class="fl">1.8</span> <span class="op">*</span> <span class="va">d6b</span><span class="op">$</span><span class="va">x</span>
<span class="va">d6b</span><span class="op">$</span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fl">0.1</span> <span class="op">+</span> <span class="fl">0.6</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">d6b</span><span class="op">$</span><span class="va">z</span><span class="op">)</span><span class="op">)</span>

<span class="va">d6b</span><span class="op">$</span><span class="va">ycn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/crch/man/cnorm.html">rcnorm</a></span><span class="op">(</span><span class="fl">1000</span>, mean <span class="op">=</span> <span class="va">d6b</span><span class="op">$</span><span class="va">mu</span>, sd <span class="op">=</span> <span class="va">d6b</span><span class="op">$</span><span class="va">sigma</span>, left <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="va">d6b</span><span class="op">$</span><span class="va">yn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/crch/man/cnorm.html">rcnorm</a></span><span class="op">(</span><span class="fl">1000</span>, mean <span class="op">=</span> <span class="va">d6b</span><span class="op">$</span><span class="va">mu</span>, sd <span class="op">=</span> <span class="va">d6b</span><span class="op">$</span><span class="va">sigma</span><span class="op">)</span></code></pre></div>
<p><img src="graphical_model_assessment_original_files/figure-html/curves-6b-1.png" width="60%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## correct censored normal fit</span>
<span class="va">m6b_cn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/crch/man/crch.html">crch</a></span><span class="op">(</span><span class="va">ycn</span> <span class="op">~</span> <span class="va">x</span> <span class="op">|</span> <span class="va">z</span>, data <span class="op">=</span> <span class="va">d6b</span>, dist <span class="op">=</span> <span class="st">"gaussian"</span>, truncated <span class="op">=</span> <span class="cn">FALSE</span>, left <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>

<span class="co">## incorrect normal fit</span>
<span class="va">m6b_n1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/crch/man/crch.html">crch</a></span><span class="op">(</span><span class="va">ycn</span> <span class="op">~</span> <span class="va">x</span> <span class="op">|</span> <span class="va">z</span>, data <span class="op">=</span> <span class="va">d6b</span>, dist <span class="op">=</span> <span class="st">"gaussian"</span>, truncated <span class="op">=</span> <span class="cn">FALSE</span>, left <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span><span class="op">)</span>

<span class="co">## correct normal fit</span>
<span class="va">m6b_n2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/crch/man/crch.html">crch</a></span><span class="op">(</span><span class="va">yn</span> <span class="op">~</span> <span class="va">x</span> <span class="op">|</span> <span class="va">z</span>, data <span class="op">=</span> <span class="va">d6b</span>, dist <span class="op">=</span> <span class="st">"gaussian"</span>, truncated <span class="op">=</span> <span class="cn">FALSE</span>, left <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span><span class="op">)</span></code></pre></div>
<p><img src="graphical_model_assessment_original_files/figure-html/qresiduals-6b-1.png" width="80%" style="display: block; margin: auto;"></p>
<p><img src="graphical_model_assessment_original_files/figure-html/topmodels-6b-1.png" width="100%"></p>
<p>Wrong assumption of underlying distribution, not considering censoring at zero, leads to misspecified model fit in the 2nd line:</p>
<ul>
<li><span class="math inline">\(\dots\)</span></li>
</ul>
</div>
<div id="summary" class="section level1">
<h1 class="hasAnchor">
<a href="#summary" class="anchor"></a>Summary</h1>
<ul>
<li>U-shaped histograms indicate underdispersed predictive distributions, hump or inverse-U shaped histograms point at overdispersion, and skewed histograms occur when central tendencies are biased <span class="citation">(Czado, Gneiting, and Held 2009)</span>.</li>
</ul>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-Czado+Gneiting+Held:2009">
<p>Czado, Claudia, Tilmann Gneiting, and Leonhard Held. 2009. “Predictive Model Assessment for Count Data.” <em>Biometrics</em> 65 (4): 1254–61. <a href="https://doi.org/10.1111/j.1541-0420.2009.01191.x">https://doi.org/10.1111/j.1541-0420.2009.01191.x</a>.</p>
</div>
<div id="ref-Kleiber+Zeileis:2016">
<p>Kleiber, Christian, and Achim Zeileis. 2016. “Visualizing Count Data Regressions Using Rootograms.” <em>The American Statistician</em> 70 (3): 296–303. <a href="https://doi.org/10.1080/00031305.2016.1173590">https://doi.org/10.1080/00031305.2016.1173590</a>.</p>
</div>
<div id="ref-Kross:2016">
<p>Kross, Sean. 2016. “A Q-Q Plot Dissection Kit.” <a href="https://seankross.com/2016/02/29/A-Q-Q-Plot-Dissection-Kit.html">https://seankross.com/2016/02/29/A-Q-Q-Plot-Dissection-Kit.html</a>.</p>
</div>
<div id="ref-Love:2018">
<p>Love, Thomas E. 2018. “Data Science for Biological, Medical and Health Research: Notes for 431.” Case Western Reserve University. <a href="https://thomaselove.github.io/2018-431-book/">https://thomaselove.github.io/2018-431-book/</a>.</p>
</div>
<div id="ref-Yearsley:2021">
<p>Yearsley, Jon. 2021. “Examples of Quantile-Quantile Plots.” School of Biology; Environmental Science, UCD Dublin. <a href="https://www.ucd.ie/ecomodel/Resources/QQplots_WebVersion.html">https://www.ucd.ie/ecomodel/Resources/QQplots_WebVersion.html</a>.</p>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Achim Zeileis, Moritz N. Lang.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
