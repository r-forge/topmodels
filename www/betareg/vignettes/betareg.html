<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.53">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Francisco Cribari-Neto">
<meta name="author" content="Achim Zeileis">
<title>Beta Regression in R – betareg</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../betareg.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
<meta property="og:title" content="Beta Regression in R – betareg">
<meta property="og:description" content="This introduction to the R package betareg is a (slightly) modified version of Cribari-Neto and Zeileis (2010), published in the Journal of Statistical Software. A follow-up paper with various extensions is Grün, Kosmidis, and Zeileis (2012) – a slightly modified version of which is also provided within the package as vignette(&quot;betareg-ext&quot;, package = &quot;betareg&quot;)
The class of beta regression models is commonly used by practitioners to model variables that assume values in the standard unit interval \((0, 1)\). It is based on the assumption that the dependent variable is beta-distributed and that its mean is related to a set of regressors through a linear predictor with unknown coefficients and a link function. The model also includes a precision parameter which may be constant or depend on a (potentially different) set of regressors through a link function as well. This approach naturally incorporates features such as heteroskedasticity or skewness which are commonly observed in data taking values in the standard unit interval, such as rates or proportions. This paper describes the betareg package which provides the class of beta regressions in the R system for statistical computing. The underlying theory is briefly outlined, the implementation discussed and illustrated in various replication exercises.">
<meta property="og:image" content="https://topmodels.R-Forge.R-project.org/betareg/vignettes/betareg.png">
<meta property="og:site_name" content="betareg">
<meta name="twitter:title" content="Beta Regression in R – betareg">
<meta name="twitter:description" content="This introduction to the R package betareg is a (slightly) modified version of Cribari-Neto and Zeileis (2010), published in the Journal of Statistical Software. A follow-up paper with various extensions is Grün, Kosmidis, and Zeileis (2012) – a slightly modified version of which is also provided within the package as vignette(&quot;betareg-ext&quot;, package = &quot;betareg&quot;)
The class of beta regression models is commonly used by practitioners to model variables that assume values in the standard unit interval \((0, 1)\). It is based on the assumption that the dependent variable is beta-distributed and that its mean is related to a set of regressors through a linear predictor with unknown coefficients and a link function. The model also includes a precision parameter which may be constant or depend on a (potentially different) set of regressors through a link function as well. This approach naturally incorporates features such as heteroskedasticity or skewness which are commonly observed in data taking values in the standard unit interval, such as rates or proportions. This paper describes the betareg package which provides the class of beta regressions in the R system for statistical computing. The underlying theory is briefly outlined, the implementation discussed and illustrated in various replication exercises.">
<meta name="twitter:image" content="https://topmodels.R-Forge.R-project.org/betareg/vignettes/betareg.png">
<meta name="twitter:image:alt" content="betareg: Beta Regression in R">
<meta name="twitter:site" content="@AchimZeileis">
<meta name="twitter:card" content="summary">
</head>
<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../betareg-wide.png" alt="betareg logo" class="navbar-logo"></a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Get started</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-documentation" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Documentation</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-documentation">
<li>
    <a class="dropdown-item" href="../man/betareg.html">
 <span class="dropdown-text">Beta regression</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../man/betatree.html">
 <span class="dropdown-text">Beta regression trees and finite mixtures</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../man/CarTask.html">
 <span class="dropdown-text">Data sets</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../man/dbetar.html">
 <span class="dropdown-text">Distributions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../man/BetaR.html">
 <span class="dropdown-text">distributions3 objects</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-articles" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Articles</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-articles">
<li>
    <a class="dropdown-item" href="../vignettes/betareg.html">
 <span class="dropdown-text">Beta Regression in R (JSS 2010)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../vignettes/betareg-ext.html">
 <span class="dropdown-text">Extended Beta Regression in R: Shaken, Stirred, Mixed, and Partitioned (JSS 2012)</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item">
    <a class="nav-link" href="../NEWS.html"> 
<span class="menu-text">News</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../CITATION.html"> 
<span class="menu-text">Citation</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../contact.html"> 
<span class="menu-text">Contact</span></a>
  </li>  
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item compact">
    <a class="nav-link" href="https://fosstodon.org/@zeileis" target="_blank"> <i class="bi bi-mastodon" role="img" aria-label="@zeileis@fosstodon.org">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://x.com/AchimZeileis" target="_blank"> <i class="bi bi-twitter-x" role="img" aria-label="@AchimZeileis">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://R-Forge.R-project.org/projects/betareg" target="_blank"> <i class="bi bi-code-square" role="img" aria-label="betareg @ R-Forge">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#sec-intro" id="toc-sec-intro" class="nav-link active" data-scroll-target="#sec-intro"><span class="header-section-number">1</span> Introduction</a></li>
  <li><a href="#sec-model" id="toc-sec-model" class="nav-link" data-scroll-target="#sec-model"><span class="header-section-number">2</span> Beta regression</a></li>
  <li><a href="#sec-implementation" id="toc-sec-implementation" class="nav-link" data-scroll-target="#sec-implementation"><span class="header-section-number">3</span> Implementation in R</a></li>
  <li>
<a href="#sec-illustrations" id="toc-sec-illustrations" class="nav-link" data-scroll-target="#sec-illustrations"><span class="header-section-number">4</span> Beta regression in practice</a>
  <ul class="collapse">
<li><a href="#the-basic-model-estimation-inference-diagnostics" id="toc-the-basic-model-estimation-inference-diagnostics" class="nav-link" data-scroll-target="#the-basic-model-estimation-inference-diagnostics"><span class="header-section-number">4.1</span> The basic model: Estimation, inference, diagnostics</a></li>
  <li><a href="#sec-vardisp" id="toc-sec-vardisp" class="nav-link" data-scroll-target="#sec-vardisp"><span class="header-section-number">4.2</span> Variable dispersion model</a></li>
  <li><a href="#selection-of-different-link-functions" id="toc-selection-of-different-link-functions" class="nav-link" data-scroll-target="#selection-of-different-link-functions"><span class="header-section-number">4.3</span> Selection of different link functions</a></li>
  </ul>
</li>
  <li>
<a href="#sec-replications" id="toc-sec-replications" class="nav-link" data-scroll-target="#sec-replications"><span class="header-section-number">5</span> Further replication exercises</a>
  <ul class="collapse">
<li><a href="#dyslexia-and-iq-predicting-reading-accuracy" id="toc-dyslexia-and-iq-predicting-reading-accuracy" class="nav-link" data-scroll-target="#dyslexia-and-iq-predicting-reading-accuracy"><span class="header-section-number">5.1</span> Dyslexia and IQ predicting reading accuracy</a></li>
  <li><a href="#structural-change-testing-in-beta-regressions" id="toc-structural-change-testing-in-beta-regressions" class="nav-link" data-scroll-target="#structural-change-testing-in-beta-regressions"><span class="header-section-number">5.2</span> Structural change testing in beta regressions</a></li>
  </ul>
</li>
  <li><a href="#sec-conclusion" id="toc-sec-conclusion" class="nav-link" data-scroll-target="#sec-conclusion"><span class="header-section-number">6</span> Summary</a></li>
  <li><a href="#acknowledgments" id="toc-acknowledgments" class="nav-link" data-scroll-target="#acknowledgments">Acknowledgments</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header"><h1 class="title display-7">Beta Regression in R</h1>
<p class="author">Francisco Cribari-Neto</p>
<p class="author">Achim Zeileis</p>

<div class="abstract">
<div class="abstract-title">Abstract</div>
<p>This introduction to the R package <strong>betareg</strong> is a (slightly) modified version of <span class="citation" data-cites="betareg:Cribari-Neto+Zeileis:2010">Cribari-Neto and Zeileis (<a href="#ref-betareg:Cribari-Neto+Zeileis:2010" role="doc-biblioref">2010</a>)</span>, published in the <em>Journal of Statistical Software</em>. A follow-up paper with various extensions is <span class="citation" data-cites="betareg:Gruen+Kosmidis+Zeileis:2012">Grün, Kosmidis, and Zeileis (<a href="#ref-betareg:Gruen+Kosmidis+Zeileis:2012" role="doc-biblioref">2012</a>)</span> – a slightly modified version of which is also provided within the package as <code><a href="https://betareg.R-Forge.R-project.org/vignettes/betareg-ext.html">vignette("betareg-ext", package = "betareg")</a></code><br>
The class of beta regression models is commonly used by practitioners to model variables that assume values in the standard unit interval <span class="math inline">\((0, 1)\)</span>. It is based on the assumption that the dependent variable is beta-distributed and that its mean is related to a set of regressors through a linear predictor with unknown coefficients and a link function. The model also includes a precision parameter which may be constant or depend on a (potentially different) set of regressors through a link function as well. This approach naturally incorporates features such as heteroskedasticity or skewness which are commonly observed in data taking values in the standard unit interval, such as rates or proportions. This paper describes the <strong>betareg</strong> package which provides the class of beta regressions in the R system for statistical computing. The underlying theory is briefly outlined, the implementation discussed and illustrated in various replication exercises.</p>
</div>
</header><section id="sec-intro" class="level2" data-number="1"><h2 data-number="1" class="anchored" data-anchor-id="sec-intro">
<span class="header-section-number">1</span> Introduction</h2>
<p>How should one perform a regression analysis in which the dependent variable (or response variable), <span class="math inline">\(y\)</span>, assumes values in the standard unit interval <span class="math inline">\((0,1)\)</span>? The usual practice used to be to transform the data so that the transformed response, say <span class="math inline">\(\tilde y\)</span>, assumes values in the real line and then apply a standard linear regression analysis. A commonly used transformation is the logit, <span class="math inline">\(\tilde y =
\log(y/(1-y))\)</span>. This approach, nonetheless, has shortcomings. First, the regression parameters are interpretable in terms of the mean of <span class="math inline">\(\tilde y\)</span>, and not in terms of the mean of <span class="math inline">\(y\)</span> (given Jensen’s inequality). Second, regressions involving data from the unit interval such as rates and proportions are typically heteroskedastic: they display more variation around the mean and less variation as we approach the lower and upper limits of the standard unit interval. Finally, the distributions of rates and proportions are typically asymmetric, and thus Gaussian-based approximations for interval estimation and hypothesis testing can be quite inaccurate in small samples. <span class="citation" data-cites="betareg:Ferrari+Cribari-Neto:2004">Ferrari and Cribari-Neto (<a href="#ref-betareg:Ferrari+Cribari-Neto:2004" role="doc-biblioref">2004</a>)</span> proposed a regression model for continuous variates that assume values in the standard unit interval, e.g., rates, proportions, or concentration indices. Since the model is based on the assumption that the response is beta-distributed, they called their model <em>the beta regression model</em>. In their model, the regression parameters are interpretable in terms of the mean of <span class="math inline">\(y\)</span> (the variable of interest) and the model is naturally heteroskedastic and easily accomodates asymmetries. A variant of the beta regression model that allows for nonlinearities and variable dispersion was proposed by <span class="citation" data-cites="betareg:Simas+Barreto-Souza+Rocha:2010">Simas, Barreto-Souza, and Rocha (<a href="#ref-betareg:Simas+Barreto-Souza+Rocha:2010" role="doc-biblioref">2010</a>)</span>. In particular, in this more general model, the parameter accounting for the precision of the data is not assumed to be constant across observations but it is allowed to vary, leading to the <em>variable dispersion beta regression model</em>.</p>
<p>The chief motivation for the beta regression model lies in the flexibility delivered by the assumed beta law. The beta density can assume a number of different shapes depending on the combination of parameter values, including left- and right-skewed or the flat shape of the uniform density (which is a special case of the more general beta density). This is illustrated in <a href="#fig-beta-distributions" class="quarto-xref">Figure&nbsp;1</a> which depicts several different beta densities. Following <span class="citation" data-cites="betareg:Ferrari+Cribari-Neto:2004">Ferrari and Cribari-Neto (<a href="#ref-betareg:Ferrari+Cribari-Neto:2004" role="doc-biblioref">2004</a>)</span>, the densities are parameterized in terms of the mean <span class="math inline">\(\mu\)</span> and the precision parameter <span class="math inline">\(\phi\)</span>; all details are explained in the next section. The evident flexiblity makes the beta distribution an attractive candidate for data-driven statistical modeling.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-beta-distributions" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-beta-distributions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="betareg_files/figure-html/fig-beta-distributions-1.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-beta-distributions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Probability density functions for beta distributions with varying parameters <span class="math inline">\(\mu = 0.10, 0.25, 0.50, 0.75, 0.90\)</span> and <span class="math inline">\(\phi = 5\)</span> (left) and <span class="math inline">\(\phi = 100\)</span> (right).
</figcaption></figure>
</div>
</div>
</div>
<p>The idea underlying beta regression models dates back to earlier approaches such as <span class="citation" data-cites="betareg:Williams:1982">Williams (<a href="#ref-betareg:Williams:1982" role="doc-biblioref">1982</a>)</span> or <span class="citation" data-cites="betareg:Prentice:1986">Prentice (<a href="#ref-betareg:Prentice:1986" role="doc-biblioref">1986</a>)</span>. The initial motivation was to model binomial random variables with extra variation. The model postulated for the (discrete) variate of interest included a more flexible variation structure determined by independent beta-distributed variables which are related to a set of independent variables through a regression structure. However, unlike the more recent literature, the main focus was to model binomial random variables. Our interest in what follows will be more closely related to the recent literature, i.e., modeling continous random variables that assume values in <span class="math inline">\((0,1)\)</span>, such as rates, proportions, and concentration or inequality indices (e.g., Gini).</p>
<p>In this paper, we describe the <strong>betareg</strong> package which can be used to perform inference in both fixed and variable dispersion beta regressions. The package is implemented in the R system for statistical computing <span class="citation" data-cites="betareg:R:2009">(<a href="#ref-betareg:R:2009" role="doc-biblioref">R Core Team 2024</a>)</span> and available from the Comprehensive R Archive Network (CRAN) at <a href="http://CRAN.R-project.org/package=betareg" class="uri">http://CRAN.R-project.org/package=betareg</a>. The initial version of the package was written by <span class="citation" data-cites="betareg:Simas+Rocha:2006">Simas and Rocha (<a href="#ref-betareg:Simas+Rocha:2006" role="doc-biblioref">2006</a>)</span> up to version 1.2 which was orphaned and archived on CRAN in mid-2009. Starting from version 2.0-0, Achim Zeileis took over maintenance after rewriting/extending the package’s functionality.</p>
<p>The paper unfolds as follows: <a href="#sec-model" class="quarto-xref">Section&nbsp;2</a> outlines the theory underlying the beta regression model before <a href="#sec-implementation" class="quarto-xref">Section&nbsp;3</a> describes its implementation in R. <a href="#sec-illustrations" class="quarto-xref">Section&nbsp;4</a> and <a href="#sec-replications" class="quarto-xref">Section&nbsp;5</a> provide various empirical applications: The former focuses on illustrating various aspects of beta regressions in practice while the latter provides further replications of previously published empirical research. Finally, <a href="#sec-conclusion" class="quarto-xref">Section&nbsp;6</a> contains concluding remarks and directions for future research and implementation.</p>
</section><section id="sec-model" class="level2" data-number="2"><h2 data-number="2" class="anchored" data-anchor-id="sec-model">
<span class="header-section-number">2</span> Beta regression</h2>
<p>The class of beta regression models, as introduced by <span class="citation" data-cites="betareg:Ferrari+Cribari-Neto:2004">Ferrari and Cribari-Neto (<a href="#ref-betareg:Ferrari+Cribari-Neto:2004" role="doc-biblioref">2004</a>)</span>, is useful for modeling continuous variables <span class="math inline">\(y\)</span> that assume values in the open standard unit interval <span class="math inline">\((0,1)\)</span>. Note that if the variable takes on values in <span class="math inline">\((a, b)\)</span> (with <span class="math inline">\(a &lt; b\)</span> known) one can model <span class="math inline">\((y - a)/(b - a)\)</span>. Furthermore, if <span class="math inline">\(y\)</span> also assumes the extremes <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span>, a useful transformation in practice is <span class="math inline">\((y \cdot (n - 1) + 0.5) / n\)</span> where <span class="math inline">\(n\)</span> is the sample size <span class="citation" data-cites="betareg:Smithson+Verkuilen:2006">(<a href="#ref-betareg:Smithson+Verkuilen:2006" role="doc-biblioref">Smithson and Verkuilen 2006</a>)</span>.</p>
<p>The beta regression model is based on an alternative parameterization of the beta density in terms of the variate mean and a precision parameter. The beta density is usually expressed as</p>
<p><span class="math display">\[
f(y;p,q) = \frac{\Gamma(p+q)}{\Gamma(p)\Gamma(q)}y^{p-1}(1-y)^{q-1}, \quad 0&lt;y&lt;1,
\]</span></p>
<p>where <span class="math inline">\(p,q &gt;0\)</span> and <span class="math inline">\(\Gamma(\cdot)\)</span> is the gamma function.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> <span class="citation" data-cites="betareg:Ferrari+Cribari-Neto:2004">Ferrari and Cribari-Neto (<a href="#ref-betareg:Ferrari+Cribari-Neto:2004" role="doc-biblioref">2004</a>)</span> proposed a different parameterization by setting <span class="math inline">\(\mu = p/(p+q)\)</span> and <span class="math inline">\(\phi = p+q\)</span>:</p>
<p><span id="eq-density0"><span class="math display">\[
f(y;\mu,\phi) = \frac{\Gamma(\phi)}{\Gamma(\mu\phi)\Gamma((1-\mu)\phi)}y^{\mu\phi-1}(1-y)^{(1-\mu)\phi-1}, \quad 0&lt;y&lt;1,
\tag{1}\]</span></span></p>
<p>with <span class="math inline">\(0&lt;\mu&lt;1\)</span> and <span class="math inline">\(\phi&gt;0\)</span>. We write <span class="math inline">\(y \,\sim\, \mathcal{B}(\mu, \phi)\)</span>. Here, <span class="math inline">\(\text{E}(y) = \mu\)</span> and <span class="math inline">\(\text{Var}(y) = \mu(1-\mu)/(1+\phi)\)</span>. The parameter <span class="math inline">\(\phi\)</span> is known as the precision parameter since, for fixed <span class="math inline">\(\mu\)</span>, the larger <span class="math inline">\(\phi\)</span> the smaller the variance of <span class="math inline">\(y\)</span>; <span class="math inline">\(\phi^{-1}\)</span> is a dispersion parameter.</p>
<p>Let <span class="math inline">\(y_1,\ldots,y_n\)</span> be a random sample such that <span class="math inline">\(y_i \sim
{\mathcal{B}}(\mu_i,\phi)\)</span>, <span class="math inline">\(i=1,\ldots,n\)</span>. The beta regression model is defined as</p>
<p><span class="math display">\[
g(\mu_i) = x_{i}^\top \beta = \eta_i,
\]</span></p>
<p>where <span class="math inline">\(\beta=(\beta_1,\ldots,\beta_k)^\top\)</span> is a <span class="math inline">\(k \times 1\)</span> vector of unknown regression parameters (<span class="math inline">\(k&lt;n\)</span>), <span class="math inline">\(x_i = (x_{i1},\ldots,x_{ik})^\top\)</span> is the vector of <span class="math inline">\(k\)</span> regressors (or independent variables or covariates) and <span class="math inline">\(\eta_i\)</span> is a linear predictor (i.e., <span class="math inline">\(\eta_i = \beta_1 x_{i1} + \cdots + \beta_k x_{ik}\)</span>; usually <span class="math inline">\(x_{i1}=1\)</span> for all <span class="math inline">\(i\)</span> so that the model has an intercept).<br>
Here, <span class="math inline">\(g(\cdot): (0,1) \mapsto
\mathrm{I\! R}\)</span> is a link function, which is strictly increasing and twice differentiable. The main motivation for using a link function in the regression structure is twofold. First, both sides of the regression equation assume values in the real line when a link function is applied to <span class="math inline">\(\mu_i\)</span>. Second, there is an added flexibility since the practitioner can choose the function that yields the best fit. Some useful link functions are: logit <span class="math inline">\(g(\mu) = \log(\mu/(1-\mu))\)</span>; probit <span class="math inline">\(g(\mu) = \Phi^{-1}(\mu)\)</span>, where <span class="math inline">\(\Phi(\cdot)\)</span> is the standard normal distribution function; complementary log-log <span class="math inline">\(g(\mu) = \log\{-\log(1-\mu)\}\)</span>; log-log <span class="math inline">\(g(\mu) = -\log\{-\log(\mu)\}\)</span>; and Cauchy <span class="math inline">\(g(\mu) = \tan\{\pi(\mu - 0.5)\}\)</span>. Note that the variance of <span class="math inline">\(y\)</span> is a function of <span class="math inline">\(\mu\)</span> which renders the regression model based on this parameterization naturally heteroskedastic. In particular,</p>
<p><span id="eq-variance"><span class="math display">\[
   \text{Var}(y_i) = \frac{\mu_i(1-\mu_i)}{1+\phi}
             = \frac{g^{-1}(x_i^{\top}\beta)[1-g^{-1}(x_i^{\top}\beta)]}{1+\phi}.
\tag{2}\]</span></span></p>
<p>The log-likelihood function is <span class="math inline">\(\ell(\beta,\phi)=\sum_{i=1}^n\ell_i(\mu_i,\phi)\)</span>, where</p>
<p><span id="eq-loglik"><span class="math display">\[
\begin{eqnarray}
  \ell_i(\mu_i,\phi) &amp; = &amp; \log \Gamma(\phi)-\log\Gamma(\mu_i\phi) - \log \Gamma((1-\mu_i)\phi) +(\mu_i\phi-1)\log y_i \\
                     &amp;   &amp; + \{(1-\mu_i)\phi-1\}\log(1-y_i).
\end{eqnarray}
\tag{3}\]</span></span></p>
<p>Notice that <span class="math inline">\(\mu_i=g^{-1}(x_i^{\top}\beta)\)</span> is a function of <span class="math inline">\(\beta\)</span>, the vector of regression parameters. Parameter estimation is performed by maximum likelihood (ML).</p>
<p>An extension of the beta regression model above which was employed by <span class="citation" data-cites="betareg:Smithson+Verkuilen:2006">Smithson and Verkuilen (<a href="#ref-betareg:Smithson+Verkuilen:2006" role="doc-biblioref">2006</a>)</span> and formally introduced (along with further extensions) by <span class="citation" data-cites="betareg:Simas+Barreto-Souza+Rocha:2010">Simas, Barreto-Souza, and Rocha (<a href="#ref-betareg:Simas+Barreto-Souza+Rocha:2010" role="doc-biblioref">2010</a>)</span> is the variable dispersion beta regression model. In this model the precision parameter is not constant for all observations but instead modeled in a similar fashion as the mean parameter. More specifically, <span class="math inline">\(y_i \, \sim \, {\mathcal B}(\mu_i, \phi_i)\)</span> independently, <span class="math inline">\(i=1,\ldots,n\)</span>, and</p>
<p><span id="eq-meanprecision"><span class="math display">\[
\begin{eqnarray}
  g_1(\mu_i)  &amp; = &amp; \eta_{1i} = x_i^\top \beta,  \\
  g_2(\phi_i) &amp; = &amp; \eta_{2i} = z_i^\top \gamma,
\end{eqnarray}
\tag{4}\]</span></span></p>
<p>where <span class="math inline">\(\beta=(\beta_1, \ldots, \beta_k)^{\top}\)</span>, <span class="math inline">\(\gamma=(\gamma_1,\ldots,\gamma_h)^{\top}\)</span>, <span class="math inline">\(k+h&lt;n\)</span>, are the sets of regression coefficients in the two equations, <span class="math inline">\(\eta_{1i}\)</span> and <span class="math inline">\(\eta_{2i}\)</span> are the linear predictors, and <span class="math inline">\(x_i\)</span> and <span class="math inline">\(z_i\)</span> are regressor vectors. As before, both coefficient vectors are estimated by ML, simply replacing <span class="math inline">\(\phi\)</span> by <span class="math inline">\(\phi_i\)</span> in <a href="#eq-loglik" class="quarto-xref">Equation&nbsp;3</a>.</p>
<p><span class="citation" data-cites="betareg:Simas+Barreto-Souza+Rocha:2010">Simas, Barreto-Souza, and Rocha (<a href="#ref-betareg:Simas+Barreto-Souza+Rocha:2010" role="doc-biblioref">2010</a>)</span> further extend the model above by allowing nonlinear predictors in <a href="#eq-meanprecision" class="quarto-xref">Equation&nbsp;4</a>. Also, they have obtained analytical bias corrections for the ML estimators of the parameters, thus generalizing the results of <span class="citation" data-cites="betareg:Ospina+Cribari-Neto+Vasconcellos:2006">Ospina, Cribari-Neto, and Vasconcellos (<a href="#ref-betareg:Ospina+Cribari-Neto+Vasconcellos:2006" role="doc-biblioref">2006</a>)</span>, who derived bias corrections for fixed dispersion beta regressions. However, as these extensions are not (yet) part of the <strong>betareg</strong> package, we confine ourselves to these short references and do not provide detailed formulas.</p>
<p>Various types of residuals are available for beta regression models. The raw response residuals <span class="math inline">\(y_i - \hat \mu_i\)</span> are typically not used due to the heteroskedasticity inherent in the model (see <a href="#eq-variance" class="quarto-xref">Equation&nbsp;2</a>). Hence, a natural alternative are <em>Pearson residuals</em> which <span class="citation" data-cites="betareg:Ferrari+Cribari-Neto:2004">Ferrari and Cribari-Neto (<a href="#ref-betareg:Ferrari+Cribari-Neto:2004" role="doc-biblioref">2004</a>)</span> call <em>standardized ordinary residuals</em> and define as</p>
<p><span id="eq-pearson"><span class="math display">\[
  r_{\mathrm{P}, i} = \frac{y_i - \hat{\mu}_i}{\sqrt{\widehat{\text{Var}}(y_i)}},
\tag{5}\]</span></span></p>
<p>where <span class="math inline">\(\widehat{\text{Var}}(y_i) = \hat{\mu}_i(1-\hat{\mu}_i)/
(1+\hat{\phi_i})\)</span>, <span class="math inline">\(\hat{\mu}_i = g_1^{-1}(x_i^\top\,\hat{\beta})\)</span>, and <span class="math inline">\(\hat{\phi}_i = g_2^{-1}(z_i^\top\,\hat{\gamma})\)</span>. Similarly, deviance residuals can be defined in the standard way via signed contributions to the excess likelihood. Further residuals were proposed by <span class="citation" data-cites="betareg:Espinheira+Ferrari+Cribari-Neto:2008a">Espinheira, Ferrari, and Cribari-Neto (<a href="#ref-betareg:Espinheira+Ferrari+Cribari-Neto:2008a" role="doc-biblioref">2008b</a>)</span>, in particular one residual with better properties that they named <em>standardized weighted residual 2</em>:</p>
<p><span id="eq-sweighted2"><span class="math display">\[
  r_{\mathrm{sw2}, i} = \frac{y^*_i - {\hat{{\mu}}^*}_i}{\sqrt{\hat{v}_i(1 - h_{ii})}},
\tag{6}\]</span></span></p>
<p>where <span class="math inline">\(y_i^* = \log\{ y_i / (1-y_i)\}\)</span> and <span class="math inline">\(\mu_i^* = \psi(\mu_i\phi)- \psi((1-\mu_i)\phi)\)</span>, <span class="math inline">\(\psi(\cdot)\)</span> denoting the digamma function. Standardization is then by <span class="math inline">\(v_i = \left\{ \psi'(\mu_i\phi) + \psi'((1-\mu_i)\phi)\right\}\)</span> and <span class="math inline">\(h_{ii}\)</span>, the <span class="math inline">\(i\)</span>th diagonal element of the hat matrix . Hats denote evaluation at the ML estimates.</p>
<p>It is noteworthy that the beta regression model described above was developed to allow practitioners to model continuous variates that assume values in the unit interval such as rates, proportions, and concentration or inequality indices (e.g., Gini). However, the data types that can be modeled using beta regressions also encompass proportions of “successes” from a number of trials, if the number of trials is large enough to justify a continuous model. In this case, beta regression is similar to a binomial generalized linear model (GLM) but provides some more flexibility – in particular when the trials are not independent and the standard binomial model might be too strict. In such a situation, the fixed dispersion beta regression is similar to the quasi-binomial model <span class="citation" data-cites="betareg:McCullagh+Nelder:1989">(<a href="#ref-betareg:McCullagh+Nelder:1989" role="doc-biblioref">McCullagh and Nelder 1989</a>)</span> but fully parametric. Furthermore, it can be naturally extended to variable dispersions.</p>
</section><section id="sec-implementation" class="level2" data-number="3"><h2 data-number="3" class="anchored" data-anchor-id="sec-implementation">
<span class="header-section-number">3</span> Implementation in R</h2>
<p>To turn the conceptual model from the previous section into computational tools in R, it helps to emphasize some properties of the model: It is a standard maximum likelihood (ML) task for which there is no closed-form solution but numerical optimization is required. Furthermore, the model shares some properties (such as linear predictor, link function, dispersion parameter) with generalized linear models <span class="citation" data-cites="betareg:McCullagh+Nelder:1989">(GLMS, <a href="#ref-betareg:McCullagh+Nelder:1989" role="doc-biblioref">McCullagh and Nelder 1989</a>)</span>, but it is not a special case of this framework (not even for fixed dispersion). There are various models with implementations in R that have similar features – here, we specifically reuse some of the ideas employed for generalized count data regression by <span class="citation" data-cites="betareg:Zeileis+Kleiber+Jackman:2008">Zeileis, Kleiber, and Jackman (<a href="#ref-betareg:Zeileis+Kleiber+Jackman:2008" role="doc-biblioref">2008</a>)</span>.</p>
<p>The main model-fitting function in <strong>betareg</strong> is <code>betareg()</code> which takes a fairly standard approach for implementing ML regression models in R: <code>formula</code> plus <code>data</code> is used for model and data specification, then the likelihood and corresponding gradient (or estimating function) is set up, <code><a href="https://rdrr.io/r/stats/optim.html">optim()</a></code> is called for maximizing the likelihood, and finally an object of S3 class <code>"betareg"</code> is returned for which a large set of methods to standard generics is available. The workhorse function is <code>betareg.fit()</code> which provides the core computations without <code>formula</code>-related data pre- and post-processing. <strong>Update:</strong> Recently, <code>betareg()</code> has been extended to optionally include an additional Fisher scoring iteration after the <code><a href="https://rdrr.io/r/stats/optim.html">optim()</a></code> optimization in order to improve the ML result (or apply a bias correction or reduction).</p>
<p>The model-fitting function <code>betareg()</code> and its associated class are designed to be as similar as possible to the standard <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code> function <span class="citation" data-cites="betareg:R:2009">(<a href="#ref-betareg:R:2009" role="doc-biblioref">R Core Team 2024</a>)</span> for fitting GLMs. An important difference is that there are potentially two equations for mean and precision (<a href="#eq-meanprecision" class="quarto-xref">Equation&nbsp;4</a>), and consequently two regressor matrices, two linear predictors, two sets of coefficients, etc. In this respect, the design of <code>betareg()</code> is similar to the functions described by <span class="citation" data-cites="betareg:Zeileis+Kleiber+Jackman:2008">Zeileis, Kleiber, and Jackman (<a href="#ref-betareg:Zeileis+Kleiber+Jackman:2008" role="doc-biblioref">2008</a>)</span> for fitting zero-inflation and hurdle models which also have two model components. The arguments of <code>betareg()</code> are</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">betareg</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, <span class="va">subset</span>, <span class="va">na.action</span>, <span class="va">weights</span>, <span class="va">offset</span>,</span>
<span>  link <span class="op">=</span> <span class="st">"logit"</span>, link.phi <span class="op">=</span> <span class="cn">NULL</span>, control <span class="op">=</span> <span class="fu">betareg.control</span><span class="op">(</span><span class="va">...</span><span class="op">)</span>,</span>
<span>  model <span class="op">=</span> <span class="cn">TRUE</span>, y <span class="op">=</span> <span class="cn">TRUE</span>, x <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>where the first line contains the standard model-frame specifications <span class="citation" data-cites="betareg:Chambers+Hastie:1992">(see <a href="#ref-betareg:Chambers+Hastie:1992" role="doc-biblioref">Chambers and Hastie 1992</a>)</span>, the second line has the arguments specific to beta regression models and the arguments in the last line control some components of the return value.</p>
<div id="tbl-methods" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-methods-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Functions and methods for objects of class <code>"betareg"</code>. The first 17 functions refer to methods, the last five are generic functions whose default methods work because of the information supplied by the methods above.
</figcaption><div aria-describedby="tbl-methods-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 22%">
<col style="width: 77%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Function</th>
<th style="text-align: left;">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code><a href="https://rdrr.io/r/base/print.html">print()</a></code></td>
<td style="text-align: left;">Simple printed display with coefficient estimates</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code></td>
<td style="text-align: left;">Standard regression output (coefficient estimates, standard errors, partial Wald tests); returns an object of class <code>"summary.betareg"</code> containing the relevant summary statistics (which has a <code><a href="https://rdrr.io/r/base/print.html">print()</a></code> method)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code><a href="https://rdrr.io/r/stats/coef.html">coef()</a></code></td>
<td style="text-align: left;">Extract coefficients of model (full, mean, or precision components), a single vector of all coefficients by default</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code><a href="https://rdrr.io/r/stats/vcov.html">vcov()</a></code></td>
<td style="text-align: left;">Associated covariance matrix (with matching names)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code><a href="https://rdrr.io/r/stats/predict.html">predict()</a></code></td>
<td style="text-align: left;">Predictions (of means <span class="math inline">\(\mu_i\)</span>, linear predictors <span class="math inline">\(\eta_{1i}\)</span>, precision parameter <span class="math inline">\(\phi_i\)</span>, or variances <span class="math inline">\(\mu_i (1 - \mu_i) / (1 + \phi_i)\)</span>) for new data</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code><a href="https://rdrr.io/r/stats/fitted.values.html">fitted()</a></code></td>
<td style="text-align: left;">Fitted means for observed data</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code><a href="https://rdrr.io/r/stats/residuals.html">residuals()</a></code></td>
<td style="text-align: left;">Extract residuals (deviance, Pearson, response, quantile, or different weighted residuals), see <span class="citation" data-cites="betareg:Espinheira+Ferrari+Cribari-Neto:2008a">Espinheira, Ferrari, and Cribari-Neto (<a href="#ref-betareg:Espinheira+Ferrari+Cribari-Neto:2008a" role="doc-biblioref">2008b</a>)</span>, defaulting to quantile residuals since version 3.2-0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code><a href="https://sandwich.R-Forge.R-project.org/reference/estfun.html">estfun()</a></code></td>
<td style="text-align: left;">Compute empirical estimating functions (or score functions), evaluated at observed data and estimated parameters, see <span class="citation" data-cites="betareg:Zeileis:2006a">Zeileis (<a href="#ref-betareg:Zeileis:2006a" role="doc-biblioref">2006b</a>)</span>
</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code><a href="https://sandwich.R-Forge.R-project.org/reference/bread.html">bread()</a></code></td>
<td style="text-align: left;">Extract “bread” matrix for sandwich estimators, see <span class="citation" data-cites="betareg:Zeileis:2006a">Zeileis (<a href="#ref-betareg:Zeileis:2006a" role="doc-biblioref">2006b</a>)</span>
</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code><a href="https://rdrr.io/r/stats/terms.html">terms()</a></code></td>
<td style="text-align: left;">Extract terms of model components</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix()</a></code></td>
<td style="text-align: left;">Extract model matrix of model components</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code><a href="https://rdrr.io/r/stats/model.frame.html">model.frame()</a></code></td>
<td style="text-align: left;">Extract full original model frame</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code><a href="https://rdrr.io/r/stats/logLik.html">logLik()</a></code></td>
<td style="text-align: left;">Extract fitted log-likelihood</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code></td>
<td style="text-align: left;">Diagnostic plots of residuals, predictions, leverages etc.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code><a href="https://rdrr.io/r/stats/influence.measures.html">hatvalues()</a></code></td>
<td style="text-align: left;">Hat values (diagonal of hat matrix)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code><a href="https://rdrr.io/r/stats/influence.measures.html">cooks.distance()</a></code></td>
<td style="text-align: left;">(Approximation of) Cook’s distance</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>gleverage()</code></td>
<td style="text-align: left;">Compute generalized leverage, see <span class="citation" data-cites="betareg:Wei+Hu+Fung:1998">Wei, Hu, and Fung (<a href="#ref-betareg:Wei+Hu+Fung:1998" role="doc-biblioref">1998</a>)</span> and <span class="citation" data-cites="betareg:Rocha+Simas:2010">Rocha and Simas (<a href="#ref-betareg:Rocha+Simas:2010" role="doc-biblioref">2010</a>)</span>
</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code><a href="https://rdrr.io/pkg/lmtest/man/coeftest.html">coeftest()</a></code></td>
<td style="text-align: left;">Partial Wald tests of coefficients</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code><a href="https://rdrr.io/pkg/lmtest/man/waldtest.html">waldtest()</a></code></td>
<td style="text-align: left;">Wald tests of nested models</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>linear.hypothesis()</code></td>
<td style="text-align: left;">Wald tests of linear hypotheses</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code><a href="https://rdrr.io/pkg/lmtest/man/lrtest.html">lrtest()</a></code></td>
<td style="text-align: left;">Likelihood ratio tests of nested models</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code><a href="https://rdrr.io/r/stats/AIC.html">AIC()</a></code></td>
<td style="text-align: left;">Compute information criteria (AIC, BIC, etc.)</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>If a <code>formula</code> of type <code>y ~ x1 + x2</code> is supplied, it describes <span class="math inline">\(y_i\)</span> and <span class="math inline">\(x_i\)</span> for the mean equation of the beta regression (<a href="#eq-meanprecision" class="quarto-xref">Equation&nbsp;4</a>). In this case a constant <span class="math inline">\(\phi_i\)</span> is assumed, i.e., <span class="math inline">\(z_i = 1\)</span> and <span class="math inline">\(g_2\)</span> is the identity link, corresponding to the basic beta regression model as introduced in <span class="citation" data-cites="betareg:Ferrari+Cribari-Neto:2004">Ferrari and Cribari-Neto (<a href="#ref-betareg:Ferrari+Cribari-Neto:2004" role="doc-biblioref">2004</a>)</span>. However, a second set of regressors can be specified by a two-part formula of type <code>y ~ x1 + x2 | z1 + z2 + z3</code> as provided in the <strong>Formula</strong> package <span class="citation" data-cites="betareg:Zeileis+Croissant:2010">(<a href="#ref-betareg:Zeileis+Croissant:2010" role="doc-biblioref">Zeileis and Croissant 2010</a>)</span>. This model has the same mean equation as above but the regressors <span class="math inline">\(z_i\)</span> in the precision equation (<a href="#eq-meanprecision" class="quarto-xref">Equation&nbsp;4</a>) are taken from the <code>~ z1 + z2 + z3</code> part. The default link function in this case is the log link <span class="math inline">\(g_2(\cdot) = \log(\cdot)\)</span>. Consequently, <code>y ~ x1 + x2</code> and <code>y ~ x1 + x2 | 1</code> correspond to equivalent beta likelihoods but use different parametrizations for <span class="math inline">\(\phi_i\)</span>: simply <span class="math inline">\(\phi_i = \gamma_1\)</span> in the former case and <span class="math inline">\(\log(\phi_i) = \gamma_1\)</span> in the latter case. The link for the <span class="math inline">\(\phi_i\)</span> precision equation can be changed by <code>link.phi</code> in both cases where <code>"identity"</code>, <code>"log"</code>, and <code>"sqrt"</code> are allowed as admissible values. The default for the <span class="math inline">\(\mu_i\)</span> mean equation is always the logit link but all link functions for the <code>binomial</code> family in <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code> are allowed as well as the log-log link: <code>"logit"</code>, <code>"probit"</code>, <code>"cloglog"</code>, <code>"cauchit"</code>, <code>"log"</code>, and <code>"loglog"</code>.</p>
<p>ML estimation of all parameters employing analytical gradients is carried out using R’s <code><a href="https://rdrr.io/r/stats/optim.html">optim()</a></code> with control options set in <code>betareg.control()</code>. All of <code><a href="https://rdrr.io/r/stats/optim.html">optim()</a></code>’s methods are available but the default is<br><code>"BFGS"</code>, which is typically regarded to be the best-performing method <span class="citation" data-cites="betareg:Mittelhammer+Judge+Miller:2000">(<a href="#ref-betareg:Mittelhammer+Judge+Miller:2000" role="doc-biblioref">Mittelhammer, Judge, and Miller 2000, sec. 8.13</a>)</span> with the most effective updating formula of all quasi-Newton methods <span class="citation" data-cites="betareg:Nocedal+Wright:1999">(<a href="#ref-betareg:Nocedal+Wright:1999" role="doc-biblioref">Nocedal and Wright 1999, 197</a>)</span>. Starting values can be user-supplied, otherwise the <span class="math inline">\(\beta\)</span> starting values are estimated by a regression of <span class="math inline">\(g_1(y_i)\)</span> on <span class="math inline">\(x_i\)</span>. The starting values for the <span class="math inline">\(\gamma\)</span> intercept are chosen as described in <span class="citation" data-cites="betareg:Ferrari+Cribari-Neto:2004">Ferrari and Cribari-Neto (<a href="#ref-betareg:Ferrari+Cribari-Neto:2004" role="doc-biblioref">2004, 805</a>)</span>, corresponding to a constant <span class="math inline">\(\phi_i\)</span> (plus a link transformation, if any). All further <span class="math inline">\(\gamma\)</span> coefficients (if any) are initially set to zero. The covariance matrix estimate is derived analytically as in <span class="citation" data-cites="betareg:Simas+Barreto-Souza+Rocha:2010">Simas, Barreto-Souza, and Rocha (<a href="#ref-betareg:Simas+Barreto-Souza+Rocha:2010" role="doc-biblioref">2010</a>)</span>. However, by setting <code>hessian = TRUE</code> the numerical Hessian matrix returned by <code><a href="https://rdrr.io/r/stats/optim.html">optim()</a></code> can also be obtained. <strong>Update:</strong> In recent versions of <strong>betareg</strong>, the <code><a href="https://rdrr.io/r/stats/optim.html">optim()</a></code> is still performed but optionally it may be complemented by a subsequent additional Fisher scoring iteration to improve the result.</p>
<p>The returned fitted-model object of class <code>"betareg"</code> is a list similar to <code>"glm"</code> objects. Some of its elements – such as <code>coefficients</code> or <code>terms</code> – are lists with a mean and precision component, respectively.</p>
<p>A set of standard extractor functions for fitted model objects is available for objects of class <code>"betareg"</code>, including the usual <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> method that includes partial Wald tests for all coefficients. No <code><a href="https://rdrr.io/r/stats/anova.html">anova()</a></code> method is provided, but the general <code><a href="https://rdrr.io/pkg/lmtest/man/coeftest.html">coeftest()</a></code> and <code><a href="https://rdrr.io/pkg/lmtest/man/waldtest.html">waldtest()</a></code> from <strong>lmtest</strong> <span class="citation" data-cites="betareg:Zeileis+Hothorn:2002">(<a href="#ref-betareg:Zeileis+Hothorn:2002" role="doc-biblioref">Zeileis and Hothorn 2002</a>)</span>, and <code>linear.hypothesis()</code> from <strong>car</strong> <span class="citation" data-cites="betareg:Fox+Weisberg:2019">(<a href="#ref-betareg:Fox+Weisberg:2019" role="doc-biblioref">Fox and Weisberg 2019</a>)</span> can be used for Wald tests while <code><a href="https://rdrr.io/pkg/lmtest/man/lrtest.html">lrtest()</a></code> from <strong>lmtest</strong> provides for likelihood-ratio tests of nested models. See <a href="#tbl-methods" class="quarto-xref">Table&nbsp;1</a> for a list of all available methods. Most of these are standard in base R, however, methods to a few less standard generics are also provided. Specifically, there are tools related to specification testing and computation of sandwich covariance matrices as discussed by <span class="citation" data-cites="betareg:Zeileis:2004">Zeileis (<a href="#ref-betareg:Zeileis:2004" role="doc-biblioref">2004</a>)</span>,betareg:Zeileis:2006a as well as a method to a new generic for computing generalized leverages <span class="citation" data-cites="betareg:Wei+Hu+Fung:1998">(<a href="#ref-betareg:Wei+Hu+Fung:1998" role="doc-biblioref">Wei, Hu, and Fung 1998</a>)</span>.</p>
</section><section id="sec-illustrations" class="level2" data-number="4"><h2 data-number="4" class="anchored" data-anchor-id="sec-illustrations">
<span class="header-section-number">4</span> Beta regression in practice</h2>
<p>To illustrate the usage of <strong>betareg</strong> in practice we replicate and slightly extend some of the analyses from the original papers that suggested the methodology. More specifically, we estimate and compare various flavors of beta regression models for the gasoline yield data of <span class="citation" data-cites="betareg:Prater:1956">Prater (<a href="#ref-betareg:Prater:1956" role="doc-biblioref">1956</a>)</span>, see <a href="#fig-GasolineYield" class="quarto-xref">Figure&nbsp;2</a>, and for the household food expenditure data taken from <span class="citation" data-cites="betareg:Griffiths+Hill+Judge:1993">Griffiths, Hill, and Judge (<a href="#ref-betareg:Griffiths+Hill+Judge:1993" role="doc-biblioref">1993</a>)</span>, see <a href="#fig-FoodExpenditure" class="quarto-xref">Figure&nbsp;4</a>). Further pure replication exercises are provided in <a href="#sec-replications" class="quarto-xref">Section&nbsp;5</a>.</p>
<section id="the-basic-model-estimation-inference-diagnostics" class="level3" data-number="4.1"><h3 data-number="4.1" class="anchored" data-anchor-id="the-basic-model-estimation-inference-diagnostics">
<span class="header-section-number">4.1</span> The basic model: Estimation, inference, diagnostics</h3>
<section id="praters-gasoline-yield-data" class="level4" data-number="4.1.1"><h4 data-number="4.1.1" class="anchored" data-anchor-id="praters-gasoline-yield-data">
<span class="header-section-number">4.1.1</span> Prater’s gasoline yield data</h4>
<p>The basic beta regression model as suggested by <span class="citation" data-cites="betareg:Ferrari+Cribari-Neto:2004">Ferrari and Cribari-Neto (<a href="#ref-betareg:Ferrari+Cribari-Neto:2004" role="doc-biblioref">2004</a>)</span> is illustrated in Section 4 of their paper using two empirical examples. The first example employs the well-known gasoline yield data taken from <span class="citation" data-cites="betareg:Prater:1956">Prater (<a href="#ref-betareg:Prater:1956" role="doc-biblioref">1956</a>)</span>. The variable of interest is <code>yield</code>, the proportion of crude oil converted to gasoline after distillation and fractionation, for which a beta regression model is rather natural. <span class="citation" data-cites="betareg:Ferrari+Cribari-Neto:2004">Ferrari and Cribari-Neto (<a href="#ref-betareg:Ferrari+Cribari-Neto:2004" role="doc-biblioref">2004</a>)</span> employ two explanatory variables: <code>temp</code>, the temperature (in degrees Fahrenheit) at which all gasoline has vaporized, and <code>batch</code>, a factor indicating ten unique batches of conditions in the experiments (depending on further variables). The data, encompassing 32 observations, is visualized in <a href="#fig-GasolineYield" class="quarto-xref">Figure&nbsp;2</a>.</p>
<p><span class="citation" data-cites="betareg:Ferrari+Cribari-Neto:2004">Ferrari and Cribari-Neto (<a href="#ref-betareg:Ferrari+Cribari-Neto:2004" role="doc-biblioref">2004</a>)</span> start out with a model where <code>yield</code> depends on <code>batch</code> and <code>temp</code>, employing the standard logit link. In <strong>betareg</strong>, this can be fitted via</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"GasolineYield"</span>, package <span class="op">=</span> <span class="st">"betareg"</span><span class="op">)</span></span>
<span><span class="va">gy_logit</span> <span class="op">&lt;-</span> <span class="fu">betareg</span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="va">batch</span> <span class="op">+</span> <span class="va">temp</span>, data <span class="op">=</span> <span class="va">GasolineYield</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">gy_logit</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## betareg(formula = yield ~ batch + temp, data = GasolineYield)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Quantile residuals:</span></span>
<span><span class="co">##    Min     1Q Median     3Q    Max </span></span>
<span><span class="co">## -2.140 -0.570  0.120  0.704  1.751 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients (mean model with logit link):</span></span>
<span><span class="co">##              Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">## (Intercept) -6.159571   0.182325  -33.78  &lt; 2e-16 ***</span></span>
<span><span class="co">## batch1       1.727729   0.101229   17.07  &lt; 2e-16 ***</span></span>
<span><span class="co">## batch2       1.322597   0.117902   11.22  &lt; 2e-16 ***</span></span>
<span><span class="co">## batch3       1.572310   0.116105   13.54  &lt; 2e-16 ***</span></span>
<span><span class="co">## batch4       1.059714   0.102360   10.35  &lt; 2e-16 ***</span></span>
<span><span class="co">## batch5       1.133752   0.103523   10.95  &lt; 2e-16 ***</span></span>
<span><span class="co">## batch6       1.040162   0.106036    9.81  &lt; 2e-16 ***</span></span>
<span><span class="co">## batch7       0.543692   0.109127    4.98  6.3e-07 ***</span></span>
<span><span class="co">## batch8       0.495901   0.108926    4.55  5.3e-06 ***</span></span>
<span><span class="co">## batch9       0.385793   0.118593    3.25   0.0011 ** </span></span>
<span><span class="co">## temp         0.010967   0.000413   26.58  &lt; 2e-16 ***</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Phi coefficients (precision model with identity link):</span></span>
<span><span class="co">##       Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">## (phi)      440        110       4  6.3e-05 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Type of estimator: ML (maximum likelihood)</span></span>
<span><span class="co">## Log-likelihood: 84.8 on 12 Df</span></span>
<span><span class="co">## Pseudo R-squared: 0.962</span></span>
<span><span class="co">## Number of iterations: 51 (BFGS) + 3 (Fisher scoring)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>which replicates their Table 1. The goodness of fit is assessed using different types of diagnostic displays shown in their Figure 2. This graphic can be reproduced (in a slightly different order) using the <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> method for <code>"betareg"</code> objects, see <a href="#fig-GasolineYield-plot" class="quarto-xref">Figure&nbsp;3</a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-GasolineYield" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-GasolineYield-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="betareg_files/figure-html/fig-GasolineYield-1.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-GasolineYield-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Gasoline yield data from <span class="citation" data-cites="betareg:Prater:1956">Prater (<a href="#ref-betareg:Prater:1956" role="doc-biblioref">1956</a>)</span>: Proportion of crude oil converted to gasoline explained by temperature (in degrees Fahrenheit) at which all gasoline has vaporized and given batch (indicated by gray level). Fitted curves correspond to beta regressions <code>gy_loglog</code> with log-log link (solid, red) and <code>gy_logit</code> with logit link (dashed, blue). Both curves were evaluated at varying temperature with the intercept for batch 6 (i.e., roughly the average intercept).
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/warning.html">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">RNGversion</a></span><span class="op">(</span><span class="st">"3.5.0"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">gy_logit</span>, which <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, type <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">gy_logit</span>, which <span class="op">=</span> <span class="fl">5</span>, type <span class="op">=</span> <span class="st">"deviance"</span>, sub.caption <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">gy_logit</span>, which <span class="op">=</span> <span class="fl">1</span>, type <span class="op">=</span> <span class="st">"deviance"</span>, sub.caption <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-GasolineYield-plot" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-GasolineYield-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="betareg_files/figure-html/fig-GasolineYield-plot-1.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-GasolineYield-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Diagnostic plots for beta regression model <code>gy_logit</code>.
</figcaption></figure>
</div>
</div>
</div>
<p>As observation 4 corresponds to a large Cook’s distance and large residual, <span class="citation" data-cites="betareg:Ferrari+Cribari-Neto:2004">Ferrari and Cribari-Neto (<a href="#ref-betareg:Ferrari+Cribari-Neto:2004" role="doc-biblioref">2004</a>)</span> decided to refit the model excluding this observation. While this does not change the coefficients in the mean model very much, the precision parameter <span class="math inline">\(\phi\)</span> increases clearly.</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gy_logit4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span><span class="va">gy_logit</span>, subset <span class="op">=</span> <span class="op">-</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">gy_logit</span>, model <span class="op">=</span> <span class="st">"precision"</span><span class="op">)</span></span>
<span><span class="co">##  (phi) </span></span>
<span><span class="co">## 440.28</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">gy_logit4</span>, model <span class="op">=</span> <span class="st">"precision"</span><span class="op">)</span></span>
<span><span class="co">##  (phi) </span></span>
<span><span class="co">## 577.79</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="household-food-expenditures" class="level4" data-number="4.1.2"><h4 data-number="4.1.2" class="anchored" data-anchor-id="household-food-expenditures">
<span class="header-section-number">4.1.2</span> Household food expenditures</h4>
<p><span class="citation" data-cites="betareg:Ferrari+Cribari-Neto:2004">Ferrari and Cribari-Neto (<a href="#ref-betareg:Ferrari+Cribari-Neto:2004" role="doc-biblioref">2004</a>)</span> also consider a second example: household food expenditure data for 38 households taken from <span class="citation" data-cites="betareg:Griffiths+Hill+Judge:1993">Griffiths, Hill, and Judge (<a href="#ref-betareg:Griffiths+Hill+Judge:1993" role="doc-biblioref">1993</a>)</span> (Table 15.4). The dependent variable is <code>food/income</code>, the proportion of household <code>income</code> spent on <code>food</code>. Two explanatory variables are available: the previously mentioned household <code>income</code> and the number of <code>persons</code> living in the household. All three variables are visualized in <a href="#fig-FoodExpenditure" class="quarto-xref">Figure&nbsp;4</a>.</p>
<p>To start their analysis, <span class="citation" data-cites="betareg:Ferrari+Cribari-Neto:2004">Ferrari and Cribari-Neto (<a href="#ref-betareg:Ferrari+Cribari-Neto:2004" role="doc-biblioref">2004</a>)</span> consider a simple linear regression model fitted by ordinary least squares (OLS):</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"FoodExpenditure"</span>, package <span class="op">=</span> <span class="st">"betareg"</span><span class="op">)</span></span>
<span><span class="va">fe_lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">food</span><span class="op">/</span><span class="va">income</span><span class="op">)</span> <span class="op">~</span> <span class="va">income</span> <span class="op">+</span> <span class="va">persons</span>, data <span class="op">=</span> <span class="va">FoodExpenditure</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To show that this model exhibits heteroskedasticity, they employ the studentized <span class="citation" data-cites="betareg:Breusch+Pagan:1979">Breusch and Pagan (<a href="#ref-betareg:Breusch+Pagan:1979" role="doc-biblioref">1979</a>)</span> test of <span class="citation" data-cites="betareg:Koenker:1981">Koenker (<a href="#ref-betareg:Koenker:1981" role="doc-biblioref">1981</a>)</span> which is available in R in the <strong>lmtest</strong> package <span class="citation" data-cites="betareg:Zeileis+Hothorn:2002">(<a href="#ref-betareg:Zeileis+Hothorn:2002" role="doc-biblioref">Zeileis and Hothorn 2002</a>)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"lmtest"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/bptest.html">bptest</a></span><span class="op">(</span><span class="va">fe_lm</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  studentized Breusch-Pagan test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  fe_lm</span></span>
<span><span class="co">## BP = 5.93, df = 2, p-value = 0.051</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>One alternative would be to consider a logit-transformed response in a traditional OLS regression but this would make the residuals asymmetric. However, both issues – heteroskedasticity and skewness – can be alleviated when a beta regression model with a logit link for the mean is used.</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fe_beta</span> <span class="op">&lt;-</span> <span class="fu">betareg</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">food</span><span class="op">/</span><span class="va">income</span><span class="op">)</span> <span class="op">~</span> <span class="va">income</span> <span class="op">+</span> <span class="va">persons</span>,</span>
<span>  data <span class="op">=</span> <span class="va">FoodExpenditure</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fe_beta</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## betareg(formula = I(food/income) ~ income + persons, data = FoodExpenditure)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Quantile residuals:</span></span>
<span><span class="co">##    Min     1Q Median     3Q    Max </span></span>
<span><span class="co">## -2.533 -0.460  0.170  0.642  1.773 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients (mean model with logit link):</span></span>
<span><span class="co">##             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">## (Intercept) -0.62255    0.22385   -2.78   0.0054 ** </span></span>
<span><span class="co">## income      -0.01230    0.00304   -4.05  5.1e-05 ***</span></span>
<span><span class="co">## persons      0.11846    0.03534    3.35   0.0008 ***</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Phi coefficients (precision model with identity link):</span></span>
<span><span class="co">##       Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">## (phi)    35.61       8.08    4.41    1e-05 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Type of estimator: ML (maximum likelihood)</span></span>
<span><span class="co">## Log-likelihood: 45.3 on 4 Df</span></span>
<span><span class="co">## Pseudo R-squared: 0.388</span></span>
<span><span class="co">## Number of iterations: 28 (BFGS) + 4 (Fisher scoring)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This replicates Table 2 from <span class="citation" data-cites="betareg:Ferrari+Cribari-Neto:2004">Ferrari and Cribari-Neto (<a href="#ref-betareg:Ferrari+Cribari-Neto:2004" role="doc-biblioref">2004</a>)</span>. The predicted means of the linear and the beta regression model, respectively, are very similar: the proportion of household income spent on food decreases with the overall income level but increases in the number of persons in the household (see also <a href="#fig-FoodExpenditure" class="quarto-xref">Figure&nbsp;4</a>).</p>
<p>Below, further extended models will be considered for these data sets and hence all model comparisons are deferred.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-FoodExpenditure" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-FoodExpenditure-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="betareg_files/figure-html/fig-FoodExpenditure-1.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-FoodExpenditure-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Household food expenditure data from <span class="citation" data-cites="betareg:Griffiths+Hill+Judge:1993">Griffiths, Hill, and Judge (<a href="#ref-betareg:Griffiths+Hill+Judge:1993" role="doc-biblioref">1993</a>)</span>: Proportion of household income spent on food explained by household income and number of persons in household (indicated by gray level). Fitted curves correspond to beta regressions <code>fe_beta</code> with fixed dispersion (long-dashed, blue), <code>fe_beta2</code> with variable dispersion (solid, red), and the linear regression <code>fe_lin</code> (dashed, black). All curves were evaluated at varying income with the intercept for mean number of persons ($ = <code>r round(mean(FoodExpenditure$persons), digits = 2)</code>$).
</figcaption></figure>
</div>
</div>
</div>
</section></section><section id="sec-vardisp" class="level3" data-number="4.2"><h3 data-number="4.2" class="anchored" data-anchor-id="sec-vardisp">
<span class="header-section-number">4.2</span> Variable dispersion model</h3>
<section id="praters-gasoline-yield-data-1" class="level4" data-number="4.2.1"><h4 data-number="4.2.1" class="anchored" data-anchor-id="praters-gasoline-yield-data-1">
<span class="header-section-number">4.2.1</span> Prater’s gasoline yield data</h4>
<p>Although the beta model already incorporates naturally a certain pattern in the variances of the response (see <a href="#eq-variance" class="quarto-xref">Equation&nbsp;2</a>), it might be necessary to incorporate further regressors to account for heteroskedasticity as in <a href="#eq-meanprecision" class="quarto-xref">Equation&nbsp;4</a>. For illustration of this approach, the example from Section 3 of the online supplements to <span class="citation" data-cites="betareg:Simas+Barreto-Souza+Rocha:2010">Simas, Barreto-Souza, and Rocha (<a href="#ref-betareg:Simas+Barreto-Souza+Rocha:2010" role="doc-biblioref">2010</a>)</span> is considered. This investigates Prater’s gasoline yield data based on the same mean equation as above, but now with temperature <code>temp</code> as an additional regressor for the precision parameter <span class="math inline">\(\phi_i\)</span>:</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gy_logit2</span> <span class="op">&lt;-</span> <span class="fu">betareg</span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="va">batch</span> <span class="op">+</span> <span class="va">temp</span> <span class="op">|</span> <span class="va">temp</span>, data <span class="op">=</span> <span class="va">GasolineYield</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>for which <code>summary(gy_logit2)</code> yields the MLE column in Table 19 of <span class="citation" data-cites="betareg:Simas+Barreto-Souza+Rocha:2010">Simas, Barreto-Souza, and Rocha (<a href="#ref-betareg:Simas+Barreto-Souza+Rocha:2010" role="doc-biblioref">2010</a>)</span>. To save space, only the parameters pertaining to <span class="math inline">\(\phi_i\)</span> are reported here</p>
<div class="cell">
<pre><code>##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  1.36409    1.22578    1.11     0.27    
## temp         0.01457    0.00362    4.03  5.7e-05 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<p>which signal a significant improvement by including the <code>temp</code> regressor. Instead of using this Wald test, the models can also be compared by means of a likelihood-ratio test (see their Table 18) that confirms the results:</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/lrtest.html">lrtest</a></span><span class="op">(</span><span class="va">gy_logit</span>, <span class="va">gy_logit2</span><span class="op">)</span></span>
<span><span class="co">## Likelihood ratio test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model 1: yield ~ batch + temp</span></span>
<span><span class="co">## Model 2: yield ~ batch + temp | temp</span></span>
<span><span class="co">##   #Df LogLik Df Chisq Pr(&gt;Chisq)  </span></span>
<span><span class="co">## 1  12   84.8                      </span></span>
<span><span class="co">## 2  13   87.0  1  4.36      0.037 *</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that this can also be interpreted as testing the null hypothesis of equidispersion against a specific alternative of variable dispersion.</p>
</section><section id="household-food-expenditures-1" class="level4" data-number="4.2.2"><h4 data-number="4.2.2" class="anchored" data-anchor-id="household-food-expenditures-1">
<span class="header-section-number">4.2.2</span> Household food expenditures</h4>
<p>For the household food expenditure data, the Breusch-Pagan test carried out above illustrated that there is heteroskedasticity that can be captured by the regressors <code>income</code> and <code>persons</code>. Closer investigation reveals that this is mostly due to the number of persons in the household, also brought out graphically by some of the outliers with high values in this variable in <a href="#fig-FoodExpenditure" class="quarto-xref">Figure&nbsp;4</a>. Hence, it seems natural to consider the model employed above with <code>persons</code> as an additional regressor in the precision equation.</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fe_beta2</span> <span class="op">&lt;-</span> <span class="fu">betareg</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">food</span><span class="op">/</span><span class="va">income</span><span class="op">)</span> <span class="op">~</span> <span class="va">income</span> <span class="op">+</span> <span class="va">persons</span> <span class="op">|</span> <span class="va">persons</span>,</span>
<span>  data <span class="op">=</span> <span class="va">FoodExpenditure</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This leads to significant improvements in terms of the likelihood and the associated BIC.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/lrtest.html">lrtest</a></span><span class="op">(</span><span class="va">fe_beta</span>, <span class="va">fe_beta2</span><span class="op">)</span></span>
<span><span class="co">## Likelihood ratio test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model 1: I(food/income) ~ income + persons</span></span>
<span><span class="co">## Model 2: I(food/income) ~ income + persons | persons</span></span>
<span><span class="co">##   #Df LogLik Df Chisq Pr(&gt;Chisq)   </span></span>
<span><span class="co">## 1   4   45.3                       </span></span>
<span><span class="co">## 2   5   49.2  1   7.7     0.0055 **</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span><span class="op">(</span><span class="va">fe_beta</span>, <span class="va">fe_beta2</span>, k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">FoodExpenditure</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">##          df     AIC</span></span>
<span><span class="co">## fe_beta   4 -76.117</span></span>
<span><span class="co">## fe_beta2  5 -80.182</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Thus, there is evidence for variable dispersion and model <code>fe_beta2</code> seems to be preferable. As visualized in <a href="#fig-FoodExpenditure" class="quarto-xref">Figure&nbsp;4</a>, it describes a similar relationship between response and explanatory variables although with a somewhat shrunken <code>income</code> slope.</p>
</section></section><section id="selection-of-different-link-functions" class="level3" data-number="4.3"><h3 data-number="4.3" class="anchored" data-anchor-id="selection-of-different-link-functions">
<span class="header-section-number">4.3</span> Selection of different link functions</h3>
<section id="praters-gasoline-yield-data-2" class="level4" data-number="4.3.1"><h4 data-number="4.3.1" class="anchored" data-anchor-id="praters-gasoline-yield-data-2">
<span class="header-section-number">4.3.1</span> Prater’s gasoline yield data</h4>
<p>As in binomial GLMs, selection of an appropriate link function can greatly improve the model fit <span class="citation" data-cites="betareg:McCullagh+Nelder:1989">(<a href="#ref-betareg:McCullagh+Nelder:1989" role="doc-biblioref">McCullagh and Nelder 1989</a>)</span>, especially if extreme proportions (close to <span class="math inline">\(0\)</span> or <span class="math inline">\(1\)</span>) have been observed in the data. To illustrate this problem in beta regressions, we replicate parts of the analysis in Section 5 of <span class="citation" data-cites="betareg:Cribari-Neto+Lima:2007">Cribari-Neto and Lima (<a href="#ref-betareg:Cribari-Neto+Lima:2007" role="doc-biblioref">2007</a>)</span>. This reconsiders Prater’s gasoline yield data but employs a log-log link instead of the previously used (default) logit link</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gy_loglog</span> <span class="op">&lt;-</span> <span class="fu">betareg</span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="va">batch</span> <span class="op">+</span> <span class="va">temp</span>, data <span class="op">=</span> <span class="va">GasolineYield</span>,</span>
<span>  link <span class="op">=</span> <span class="st">"loglog"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>which clearly improves the pseudo <span class="math inline">\(R^2\)</span> of the model:</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">gy_logit</span><span class="op">)</span><span class="op">$</span><span class="va">pseudo.r.squared</span></span>
<span><span class="co">## [1] 0.96173</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">gy_loglog</span><span class="op">)</span><span class="op">$</span><span class="va">pseudo.r.squared</span></span>
<span><span class="co">## [1] 0.98523</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Similarly, the AIC<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> (and BIC) of the fitted model is not only superior to the logit model with fixed dispersion <code>gy_logit</code> but also to the logit model with variable dispersion <code>gy_logit2</code> considered in the previous section.</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span><span class="op">(</span><span class="va">gy_logit</span>, <span class="va">gy_logit2</span>, <span class="va">gy_loglog</span><span class="op">)</span></span>
<span><span class="co">##           df     AIC</span></span>
<span><span class="co">## gy_logit  12 -145.60</span></span>
<span><span class="co">## gy_logit2 13 -147.95</span></span>
<span><span class="co">## gy_loglog 12 -168.31</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Moreover, if <code>temp</code> were included as a regressor in the precision equation of <code>gy_loglog</code>, it would no longer yield significant improvements. Thus, improvement of the model fit in the mean equation by adoption of the log-log link has waived the need for a variable precision equation.</p>
<p>To underline the appropriateness of the log-log specification, <span class="citation" data-cites="betareg:Cribari-Neto+Lima:2007">Cribari-Neto and Lima (<a href="#ref-betareg:Cribari-Neto+Lima:2007" role="doc-biblioref">2007</a>)</span> consider a sequence of diagnostic tests inspired by the RESET [regression specification error test; <span class="citation" data-cites="betareg:Ramsey:1969">Ramsey (<a href="#ref-betareg:Ramsey:1969" role="doc-biblioref">1969</a>)</span>] in linear regression models. To check for misspecifications, they consider powers of fitted means or linear predictors to be included as auxiliary regressors in the mean equation. In well-specified models, these should not yield significant improvements. For the gasoline yield model, this can only be obtained for the log-log link while all other link functions result in significant results indicating misspecification. Below, this is exemplified for a likelihood-ratio test of squared linear predictors. Analogous results can be obtained for <code>type = "response"</code> or higher powers.</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/lrtest.html">lrtest</a></span><span class="op">(</span><span class="va">gy_logit</span>, <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">gy_logit</span>, type <span class="op">=</span> <span class="st">"link"</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## Likelihood ratio test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model 1: yield ~ batch + temp</span></span>
<span><span class="co">## Model 2: yield ~ batch + temp + I(predict(gy_logit, type = "link")^2)</span></span>
<span><span class="co">##   #Df LogLik Df Chisq Pr(&gt;Chisq)    </span></span>
<span><span class="co">## 1  12   84.8                        </span></span>
<span><span class="co">## 2  13   96.0  1  22.4    2.2e-06 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/lrtest.html">lrtest</a></span><span class="op">(</span><span class="va">gy_loglog</span>, <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">gy_loglog</span>, type <span class="op">=</span> <span class="st">"link"</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## Likelihood ratio test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model 1: yield ~ batch + temp</span></span>
<span><span class="co">## Model 2: yield ~ batch + temp + I(predict(gy_loglog, type = "link")^2)</span></span>
<span><span class="co">##   #Df LogLik Df Chisq Pr(&gt;Chisq)</span></span>
<span><span class="co">## 1  12   96.2                    </span></span>
<span><span class="co">## 2  13   97.0  1  1.67        0.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The improvement of the model fit can also be brought out graphically by comparing absolute raw residuals (i.e., <span class="math inline">\(y_i - \hat \mu_i\)</span>) from both models as in <a href="#fig-GasolineYield-diagnostics" class="quarto-xref">Figure&nbsp;5</a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-GasolineYield-diagnostics" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-GasolineYield-diagnostics-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="betareg_files/figure-html/fig-GasolineYield-diagnostics-1.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-GasolineYield-diagnostics-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Scatterplot comparing the absolute raw residuals from beta regression modes with log-log link (x-axis) and logit link (y-axis).
</figcaption></figure>
</div>
</div>
</div>
<p>This shows that there are a few observations clearly above the diagonal (where the log-log-link fits better than the logit link) whereas there are fewer such observations below the diagonal. A different diagnostic display that is useful in this situation <span class="citation" data-cites="betareg:Cribari-Neto+Lima:2007">(and is employed by <a href="#ref-betareg:Cribari-Neto+Lima:2007" role="doc-biblioref">Cribari-Neto and Lima 2007</a>)</span> is a plot of predicted values (<span class="math inline">\(\hat \mu_i\)</span>) vs.&nbsp;observed values (<span class="math inline">\(y_i\)</span>) for each model. This can be created by <code>plot(gy_logit, which = 6)</code> and <code>plot(gy_loglog, which = 6)</code>, respectively.</p>
<p>In principle, the link function <span class="math inline">\(g_2\)</span> in the precision equation could also influence the model fit. However, as the best-fitting model <code>gy_loglog</code> has a constant <span class="math inline">\(\phi\)</span>, all links <span class="math inline">\(g_2\)</span> lead to equivalent estimates of <span class="math inline">\(\phi\)</span> and thus to equivalent fitted log-likelihoods. However, the link function can have consequences in terms of the inference about <span class="math inline">\(\phi\)</span> and in terms of convergence of the optimization. Typically, a log-link leads to somewhat improved quadratic approximations of the likelihood and less iterations in the optimization. For example, refitting <code>gy_loglog</code> with <span class="math inline">\(g_2(\cdot) = \log(\cdot)\)</span> converges more quickly:</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gy_loglog2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span><span class="va">gy_loglog</span>, link.phi <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">gy_loglog2</span><span class="op">)</span><span class="op">$</span><span class="va">iterations</span></span>
<span><span class="co">##   optim scoring </span></span>
<span><span class="co">##      21       2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>with a lower number of iterations than for <code>gy_loglog</code> which had 51, 2 iterations.</p>
</section><section id="household-food-expenditures-2" class="level4" data-number="4.3.2"><h4 data-number="4.3.2" class="anchored" data-anchor-id="household-food-expenditures-2">
<span class="header-section-number">4.3.2</span> Household food expenditures</h4>
<p>One could conduct a similar analysis as above for the household food expenditure data. However, as the response takes less extreme observations than for the gasoline yield data, the choice of link function is less important. In fact, refitting the model with various link functions shows no large differences in the resulting log-likelihoods. These can be easily extracted from fitted models using the <code><a href="https://rdrr.io/r/stats/logLik.html">logLik()</a></code> function, e.g., <code>logLik(fe_beta2)</code>. Below we use a compact <code><a href="https://rdrr.io/r/base/lapply.html">sapply()</a></code> call to obtain this for updated versions of <code>fe_beta2</code> with all available link functions.</p>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"logit"</span>, <span class="st">"probit"</span>, <span class="st">"cloglog"</span>, <span class="st">"cauchit"</span>, <span class="st">"loglog"</span><span class="op">)</span>,</span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span><span class="va">fe_beta2</span>, link <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">##   logit  probit cloglog cauchit  loglog </span></span>
<span><span class="co">##  49.185  49.080  49.359  50.011  48.867</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Only the Cauchy link performs somewhat better than the logit link and might hence deserve further investigation.</p>
</section></section></section><section id="sec-replications" class="level2" data-number="5"><h2 data-number="5" class="anchored" data-anchor-id="sec-replications">
<span class="header-section-number">5</span> Further replication exercises</h2>
<p>In this section, further empirical illustrations of beta regressions are provided. While the emphasis in the previous section was to present how the various features of <strong>betareg</strong> can be used in pracice, we focus more narrowly on replication of previously published research articles below.</p>
<section id="dyslexia-and-iq-predicting-reading-accuracy" class="level3" data-number="5.1"><h3 data-number="5.1" class="anchored" data-anchor-id="dyslexia-and-iq-predicting-reading-accuracy">
<span class="header-section-number">5.1</span> Dyslexia and IQ predicting reading accuracy</h3>
<p>We consider an application that analyzes reading accuracy data for nondyslexic and dyslexic Australian children <span class="citation" data-cites="betareg:Smithson+Verkuilen:2006">(<a href="#ref-betareg:Smithson+Verkuilen:2006" role="doc-biblioref">Smithson and Verkuilen 2006</a>)</span>.<br>
The variable of interest is <code>accuracy</code> providing the scores on a test of reading accuracy taken by 44 children, which is predicted by the two regressors <code>dyslexia</code> (a factor with sum contrasts separating a dyslexic and a control group) and nonverbal intelligent quotient (<code>iq</code>, converted to <span class="math inline">\(z\)</span> scores), see <a href="#fig-ReadingSkills" class="quarto-xref">Figure&nbsp;6</a> for a visualization. The sample includes 19 dyslexics and 25 controls who were recruited from primary schools in the Australian Capital Territory. The children’s ages ranged from eight years five months to twelve years three months; mean reading accuracy was 0.606 for dyslexic readers and 0.900 for controls.</p>
<p><span class="citation" data-cites="betareg:Smithson+Verkuilen:2006">Smithson and Verkuilen (<a href="#ref-betareg:Smithson+Verkuilen:2006" role="doc-biblioref">2006</a>)</span> set out to investigate whether <code>dyslexia</code> contributes to the explanation of <code>accuracy</code> even when corrected for <code>iq</code> score (which is on average lower for dyslexics). Hence, they consider separate regressions for the two groups fitted by the interaction of both regressors. To show that OLS regression is no suitable tool in this situation, they first fit a linear regression of the logit-transformed response:</p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"ReadingSkills"</span>, package <span class="op">=</span> <span class="st">"betareg"</span><span class="op">)</span></span>
<span><span class="va">rs_ols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html">qlogis</a></span><span class="op">(</span><span class="va">accuracy</span><span class="op">)</span> <span class="op">~</span> <span class="va">dyslexia</span> <span class="op">*</span> <span class="va">iq</span>, data <span class="op">=</span> <span class="va">ReadingSkills</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/coeftest.html">coeftest</a></span><span class="op">(</span><span class="va">rs_ols</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## t test of coefficients:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept)    1.601      0.226    7.09  1.4e-08 ***</span></span>
<span><span class="co">## dyslexia      -1.206      0.226   -5.34  4.0e-06 ***</span></span>
<span><span class="co">## iq             0.359      0.225    1.59    0.119    </span></span>
<span><span class="co">## dyslexia:iq   -0.423      0.225   -1.88    0.068 .  </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The interaction effect does not appear to be significant, however this is a result of the poor fit of the linear regression as will be shown below. <a href="#fig-ReadingSkills" class="quarto-xref">Figure&nbsp;6</a> clearly shows that the data are asymmetric and heteroskedastic (especially in the control group). Hence, <span class="citation" data-cites="betareg:Smithson+Verkuilen:2006">Smithson and Verkuilen (<a href="#ref-betareg:Smithson+Verkuilen:2006" role="doc-biblioref">2006</a>)</span> fit a beta regression model, again with separate means for both groups, but they also allow the dispersion to depend on the main effects of both variables.</p>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">rs_beta</span> <span class="op">&lt;-</span> <span class="fu">betareg</span><span class="op">(</span><span class="va">accuracy</span> <span class="op">~</span> <span class="va">dyslexia</span> <span class="op">*</span> <span class="va">iq</span> <span class="op">|</span> <span class="va">dyslexia</span> <span class="op">+</span> <span class="va">iq</span>,</span>
<span>  data <span class="op">=</span> <span class="va">ReadingSkills</span>, hessian <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/coeftest.html">coeftest</a></span><span class="op">(</span><span class="va">rs_beta</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## z test of coefficients:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##                   Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">## (Intercept)          1.123      0.151    7.44  9.8e-14 ***</span></span>
<span><span class="co">## dyslexia            -0.742      0.151   -4.90  9.7e-07 ***</span></span>
<span><span class="co">## iq                   0.486      0.167    2.91  0.00360 ** </span></span>
<span><span class="co">## dyslexia:iq         -0.581      0.173   -3.37  0.00076 ***</span></span>
<span><span class="co">## (phi)_(Intercept)    3.304      0.227   14.59  &lt; 2e-16 ***</span></span>
<span><span class="co">## (phi)_dyslexia       1.747      0.294    5.94  2.8e-09 ***</span></span>
<span><span class="co">## (phi)_iq             1.229      0.460    2.67  0.00749 ** </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This shows that precision increases with <code>iq</code> and is lower for controls while in the mean equation there is a significant interaction between <code>iq</code> and <code>dyslexia</code>. As <a href="#fig-ReadingSkills" class="quarto-xref">Figure&nbsp;6</a> illustrates, the beta regression fit does not differ much from the OLS fit for the dyslexics group (with responses close to <span class="math inline">\(0.5\)</span>) but fits much better in the control group (with responses close to <span class="math inline">\(1\)</span>).</p>
<p>The estimates above replicate those in Table 5 of <span class="citation" data-cites="betareg:Smithson+Verkuilen:2006">Smithson and Verkuilen (<a href="#ref-betareg:Smithson+Verkuilen:2006" role="doc-biblioref">2006</a>)</span>, except for the signs of the coefficients of the dispersion submodel which they defined in the opposite way. Note that their results have been obtained with numeric rather than analytic standard errors hence <code>hessian = TRUE</code> is set above for replication. The results are also confirmed by <span class="citation" data-cites="betareg:Espinheira+Ferrari+Cribari-Neto:2008b">Espinheira, Ferrari, and Cribari-Neto (<a href="#ref-betareg:Espinheira+Ferrari+Cribari-Neto:2008b" role="doc-biblioref">2008a</a>)</span>, who have also concluded that the dispersion is variable. As pointed out in <a href="#sec-vardisp" class="quarto-xref">Section&nbsp;4.2</a>, to formally test equidispersion against variable dispersion <code>lrtest(rs_beta, . ~ . | 1)</code> (or the analogous <code><a href="https://rdrr.io/pkg/lmtest/man/waldtest.html">waldtest()</a></code>) can be used.</p>
<p><span class="citation" data-cites="betareg:Smithson+Verkuilen:2006">Smithson and Verkuilen (<a href="#ref-betareg:Smithson+Verkuilen:2006" role="doc-biblioref">2006</a>)</span> also consider two other psychometric applications of beta regressions the data for which are also provided in the <strong>betareg</strong> package: see <code>?MockJurors</code> and <code>?StressAnxiety</code>. Furthermore, <code>demo("SmithsonVerkuilen2006", package = "betareg")</code> is a complete replication script with comments.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-ReadingSkills" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-ReadingSkills-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="betareg_files/figure-html/fig-ReadingSkills-1.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ReadingSkills-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Reading skills data from <span class="citation" data-cites="betareg:Smithson+Verkuilen:2006">Smithson and Verkuilen (<a href="#ref-betareg:Smithson+Verkuilen:2006" role="doc-biblioref">2006</a>)</span> : Linearly transformed reading accuracy by IQ score and dyslexia status (control, blue vs.&nbsp;dyslexic, red). Fitted curves correspond to beta regression <code>rs_beta</code> (solid) and OLS regression with logit-transformed dependent variable <code>rs_ols</code> (dashed).
</figcaption></figure>
</div>
</div>
</div>
</section><section id="structural-change-testing-in-beta-regressions" class="level3" data-number="5.2"><h3 data-number="5.2" class="anchored" data-anchor-id="structural-change-testing-in-beta-regressions">
<span class="header-section-number">5.2</span> Structural change testing in beta regressions</h3>
<p>As already illustrated in <a href="#sec-illustrations" class="quarto-xref">Section&nbsp;4</a>, <code>"betareg"</code> objects can be plugged into various inference functions from other packages because they provide suitable methods to standard generic functions (see <a href="#tbl-methods" class="quarto-xref">Table&nbsp;1</a>). Hence <code><a href="https://rdrr.io/pkg/lmtest/man/lrtest.html">lrtest()</a></code> could be used for performing likelihood-ratio testing inference and similarly <code><a href="https://rdrr.io/pkg/lmtest/man/coeftest.html">coeftest()</a></code>, <code><a href="https://rdrr.io/pkg/lmtest/man/waldtest.html">waldtest()</a></code> from <strong>lmtest</strong> <span class="citation" data-cites="betareg:Zeileis+Hothorn:2002">(<a href="#ref-betareg:Zeileis+Hothorn:2002" role="doc-biblioref">Zeileis and Hothorn 2002</a>)</span> and <code>linear.hypothesis()</code> from <strong>car</strong> <span class="citation" data-cites="betareg:Fox+Weisberg:2019">(<a href="#ref-betareg:Fox+Weisberg:2019" role="doc-biblioref">Fox and Weisberg 2019</a>)</span> can be employed for carrying out different flavors of Wald tests.</p>
<p>In this section, we illustrate yet another generic inference approach implemented in the <strong>strucchange</strong> package for structural change testing. This is concerned with a different testing problem compared to the functions above: It assesses whether the model parameters are stable throughout the entire sample or whether they change over the observations <span class="math inline">\(i = 1, \dots, n\)</span>. This is of particular interest in time series applications where the regression coefficients <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\gamma\)</span> change at some unknown time in the sample period <span class="citation" data-cites="betareg:Zeileis:2006">(see <a href="#ref-betareg:Zeileis:2006" role="doc-biblioref">Zeileis 2006a</a> for more details and references to the literature)</span>.</p>
<p>While originally written for linear regression models <span class="citation" data-cites="betareg:Zeileis+Leisch+Hornik:2002">(<a href="#ref-betareg:Zeileis+Leisch+Hornik:2002" role="doc-biblioref">Zeileis et al. 2002</a>)</span>, <strong>strucchange</strong> was extended by <span class="citation" data-cites="betareg:Zeileis:2006">Zeileis (<a href="#ref-betareg:Zeileis:2006" role="doc-biblioref">2006a</a>)</span> to compute generalized fluctuation tests for structural change in models that are based on suitable estimating functions. The idea is to capture systematic deviations from parameter stability by cumulative sums of the empirical estimating functions: If the parameters are stable, the cumulative sum process should fluctuate randomly around zero. However, if there is an abrupt shift in the parameters, the cumulative sums will deviate clearly from zero and have a peak at around the time of the shift. If the estimating functions can be extracted by an <code><a href="https://sandwich.R-Forge.R-project.org/reference/estfun.html">estfun()</a></code> method (as for <code>"betareg"</code> objects), models can simply be plugged into the <code><a href="https://rdrr.io/pkg/strucchange/man/gefp.html">gefp()</a></code> function for computing these cumulative sums (also known as generalized empirical fluctuation processes). To illustrate this, we replicate the example from Section 5.3 in <span class="citation" data-cites="betareg:Zeileis:2006">Zeileis (<a href="#ref-betareg:Zeileis:2006" role="doc-biblioref">2006a</a>)</span>.</p>
<p>Two artificial data sets are considered: a series <code>y1</code> with a change in the mean <span class="math inline">\(\mu\)</span>, and a series <code>y2</code> with a change in the precision <span class="math inline">\(\phi\)</span>. Both simulated series start with the parameters <span class="math inline">\(\mu = 0.3\)</span> and <span class="math inline">\(\phi = 4\)</span> and for the first series <span class="math inline">\(\mu\)</span> changes to <span class="math inline">\(0.5\)</span> after 75% of the observations while <span class="math inline">\(\phi\)</span> remains constant whereas for the second series <span class="math inline">\(\phi\)</span> changes to <span class="math inline">\(8\)</span> after 50% of the observations and <span class="math inline">\(\mu\)</span> remains constant.</p>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warning.html">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">RNGversion</a></span><span class="op">(</span><span class="st">"3.5.0"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">y1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">rbeta</a></span><span class="op">(</span><span class="fl">150</span>, <span class="fl">0.3</span> <span class="op">*</span> <span class="fl">4</span>, <span class="fl">0.7</span> <span class="op">*</span> <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">rbeta</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">0.5</span> <span class="op">*</span> <span class="fl">4</span>, <span class="fl">0.5</span> <span class="op">*</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">rbeta</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0.3</span> <span class="op">*</span> <span class="fl">4</span>, <span class="fl">0.7</span> <span class="op">*</span> <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">rbeta</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0.3</span> <span class="op">*</span> <span class="fl">8</span>, <span class="fl">0.7</span> <span class="op">*</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To capture instabilities in the parameters over “time” (i.e., the ordering of the observations), the generalized empirical fluctuation processes can be derived via</p>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"strucchange"</span><span class="op">)</span></span>
<span><span class="va">y1_gefp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/strucchange/man/gefp.html">gefp</a></span><span class="op">(</span><span class="va">y1</span> <span class="op">~</span> <span class="fl">1</span>, fit <span class="op">=</span> <span class="va">betareg</span><span class="op">)</span></span>
<span><span class="va">y2_gefp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/strucchange/man/gefp.html">gefp</a></span><span class="op">(</span><span class="va">y2</span> <span class="op">~</span> <span class="fl">1</span>, fit <span class="op">=</span> <span class="va">betareg</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>and visualized by</p>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">y1_gefp</span>, aggregate <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-strucchange1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-strucchange1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="betareg_files/figure-html/fig-strucchange1-1.png" class="img-fluid figure-img" width="624">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-strucchange1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Structural change tests for artificial data <code>y1</code> with change in <span class="math inline">\(\mu\)</span>.
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">y2_gefp</span>, aggregate <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-strucchange2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-strucchange2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="betareg_files/figure-html/fig-strucchange2-1.png" class="img-fluid figure-img" width="624">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-strucchange2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Structural change tests for artificial data <code>y2</code> with change in <span class="math inline">\(\phi\)</span>.
</figcaption></figure>
</div>
</div>
</div>
<p>The resulting <a href="#fig-strucchange1" class="quarto-xref">Figure&nbsp;7</a> and <a href="#fig-strucchange2" class="quarto-xref">Figure&nbsp;8</a> replicate Figure 4 from <span class="citation" data-cites="betareg:Zeileis:2006">Zeileis (<a href="#ref-betareg:Zeileis:2006" role="doc-biblioref">2006a</a>)</span> and show two 2-dimensional fluctuation processes: one for <code>y1</code> and one for <code>y2</code>. Both fluctuation processes behave as expected: There is no excessive fluctuation of the process pertaining to the parameter that remained constant while there is a clear peak at about the time of the change in the parameter with the shift. In both series the structural change is significant due to the crossing of the red boundary that corresponds to the 5% critical value. For further details see <span class="citation" data-cites="betareg:Zeileis:2006">Zeileis (<a href="#ref-betareg:Zeileis:2006" role="doc-biblioref">2006a</a>)</span>.</p>
</section></section><section id="sec-conclusion" class="level2" data-number="6"><h2 data-number="6" class="anchored" data-anchor-id="sec-conclusion">
<span class="header-section-number">6</span> Summary</h2>
<p>This paper addressed the R implementation of the class of beta regression models available in the <strong>betareg</strong> package. We have presented the fixed and variable dispersion beta regression models, described how one can model rates and proportions using <strong>betareg</strong> and presented several empirical examples reproducing previously published results. Future research and implementation shall focus on the situation where the data contain zeros and/or ones <span class="citation" data-cites="betareg:Kieschnick+McCullough:2003">(see e.g., <a href="#ref-betareg:Kieschnick+McCullough:2003" role="doc-biblioref">Kieschnick and McCullough 2003</a>)</span>. An additional line of research and implementation is that of dynamic beta regression models, such as the class of <span class="math inline">\(\beta\)</span>ARMA models proposed by <span class="citation" data-cites="betareg:Rocha+Cribari-Neto:2009">Rocha and Cribari-Neto (<a href="#ref-betareg:Rocha+Cribari-Neto:2009" role="doc-biblioref">2009</a>)</span>.</p>
</section><section id="acknowledgments" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="acknowledgments">Acknowledgments</h2>
<p>FCN gratefully acknowledges financial support from CNPq/Brazil. Both authors are grateful to A.B. Simas and A.V. Rocha for their work on the previous versions of the <strong>betareg</strong> package (up to version 1.2). Furthermore, detailed and constructive feedback from two anonymous reviewers, the associated editor, as well as from B. Grün was very helpful for enhancing both software and manuscript.</p>
</section><section id="references" class="level2 unnumbered">



</section><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-betareg:Breusch+Pagan:1979" class="csl-entry" role="listitem">
Breusch, Trevor S., and Adrian R. Pagan. 1979. <span>“A Simple Test for Heteroscedasticity and Random Coefficient Variation.”</span> <em>Econometrica</em> 47: 1287–94. <a href="https://doi.org/10.2307/1911963">https://doi.org/10.2307/1911963</a>.
</div>
<div id="ref-betareg:Chambers+Hastie:1992" class="csl-entry" role="listitem">
Chambers, John M., and Trevor J. Hastie, eds. 1992. <em>Statistical Models in <span>S</span></em>. London: Chapman &amp; Hall.
</div>
<div id="ref-betareg:Cribari-Neto+Lima:2007" class="csl-entry" role="listitem">
Cribari-Neto, Francisco, and Leonardo B. Lima. 2007. <span>“A Misspecification Test for Beta Regressions.”</span>
</div>
<div id="ref-betareg:Cribari-Neto+Zeileis:2010" class="csl-entry" role="listitem">
Cribari-Neto, Francisco, and Achim Zeileis. 2010. <span>“Beta Regression in <span>R</span>.”</span> <em>Journal of Statistical Software</em> 34 (2): 1–24. <a href="https://doi.org/10.18637/jss.v034.i02">https://doi.org/10.18637/jss.v034.i02</a>.
</div>
<div id="ref-betareg:Espinheira+Ferrari+Cribari-Neto:2008b" class="csl-entry" role="listitem">
Espinheira, PatrL., Silvia L. P. Ferrari, and Francisco Cribari-Neto. 2008a. <span>“Influence Diagnostics in Beta Regression.”</span> <em>Computational Statistics &amp; Data Analysis</em> 52 (9): 4417–31. <a href="https://doi.org/10.1016/j.csda.2008.02.028">https://doi.org/10.1016/j.csda.2008.02.028</a>.
</div>
<div id="ref-betareg:Espinheira+Ferrari+Cribari-Neto:2008a" class="csl-entry" role="listitem">
———. 2008b. <span>“On Beta Regression Residuals.”</span> <em>Journal of Applied Statistics</em> 35 (4): 407–19. <a href="https://doi.org/10.1080/02664760701834931">https://doi.org/10.1080/02664760701834931</a>.
</div>
<div id="ref-betareg:Ferrari+Cribari-Neto:2004" class="csl-entry" role="listitem">
Ferrari, Silvia L. P., and Francisco Cribari-Neto. 2004. <span>“Beta Regression for Modelling Rates and Proportions.”</span> <em>Journal of Applied Statistics</em> 31 (7): 799–815. <a href="https://doi.org/10.1080/0266476042000214501">https://doi.org/10.1080/0266476042000214501</a>.
</div>
<div id="ref-betareg:Fox+Weisberg:2019" class="csl-entry" role="listitem">
Fox, John, and Sanford Weisberg. 2019. <em>An <span>R</span> Companion to Applied Regression</em>. 3rd ed. Thousand Oaks, CA: Sage Publications.
</div>
<div id="ref-betareg:Griffiths+Hill+Judge:1993" class="csl-entry" role="listitem">
Griffiths, William E., R. Carter Hill, and George G. Judge. 1993. <em>Learning and Practicing Econometrics</em>. New York: John Wiley &amp; Sons.
</div>
<div id="ref-betareg:Gruen+Kosmidis+Zeileis:2012" class="csl-entry" role="listitem">
Grün, Bettina, Ioannis Kosmidis, and Achim Zeileis. 2012. <span>“Extended Beta Regression in <span>R</span>: Shaken, Stirred, Mixed, and Partitioned.”</span> <em>Journal of Statistical Software</em> 48 (11): 1–25. <a href="https://doi.org/10.18637/jss.v048.i11">https://doi.org/10.18637/jss.v048.i11</a>.
</div>
<div id="ref-betareg:Kieschnick+McCullough:2003" class="csl-entry" role="listitem">
Kieschnick, Robert, and Bruce D. McCullough. 2003. <span>“Regression Analysis of Variates Observed on <span class="math inline">\((0, 1)\)</span>: Percentages, Proportions and Fractions.”</span> <em>Statistical Modelling</em> 3 (3): 193–213. <a href="https://doi.org/10.1191/1471082x03st053oa">https://doi.org/10.1191/1471082x03st053oa</a>.
</div>
<div id="ref-betareg:Koenker:1981" class="csl-entry" role="listitem">
Koenker, Roger. 1981. <span>“A Note on Studentizing a Test for Heteroscedasticity.”</span> <em>Journal of Econometrics</em> 17: 107–12. <a href="https://doi.org/10.1016/0304-4076(81)90062-2">https://doi.org/10.1016/0304-4076(81)90062-2</a>.
</div>
<div id="ref-betareg:McCullagh+Nelder:1989" class="csl-entry" role="listitem">
McCullagh, Peter, and John A. Nelder. 1989. <em>Generalized Linear Models</em>. 2nd ed. London: Chapman &amp; Hall.
</div>
<div id="ref-betareg:Mittelhammer+Judge+Miller:2000" class="csl-entry" role="listitem">
Mittelhammer, Ron C., George G. Judge, and Douglas J. Miller. 2000. <em>Econometric Foundations</em>. New York: Cambridge University Press.
</div>
<div id="ref-betareg:Nocedal+Wright:1999" class="csl-entry" role="listitem">
Nocedal, Jorge, and Stephen J. Wright. 1999. <em>Numerical Optimization</em>. New York: Springer-Verlag. <a href="https://doi.org/10.1007/b98874">https://doi.org/10.1007/b98874</a>.
</div>
<div id="ref-betareg:Ospina+Cribari-Neto+Vasconcellos:2006" class="csl-entry" role="listitem">
Ospina, R., Francisco Cribari-Neto, and K. L. P. Vasconcellos. 2006. <span>“Improved Point and Interval Estimation for a Beta Regression Model.”</span> <em>Computational Statistics &amp; Data Analysis</em> 51 (2): 960–81. <a href="https://doi.org/10.1016/j.csda.2005.10.002">https://doi.org/10.1016/j.csda.2005.10.002</a>.
</div>
<div id="ref-betareg:Prater:1956" class="csl-entry" role="listitem">
Prater, Nilon H. 1956. <span>“Estimate Gasoline Yields from Crudes.”</span> <em>Petroleum Refiner</em> 35 (5): 236–38. <a href="https://doi.org/10.1021/cen-v034n040.p4816a">https://doi.org/10.1021/cen-v034n040.p4816a</a>.
</div>
<div id="ref-betareg:Prentice:1986" class="csl-entry" role="listitem">
Prentice, Ross L. 1986. <span>“Binary Regression Using an Extended Beta-Binomial Distribution, with Discussion of Correlation Induced by Covariate Measurement.”</span> <em>Journal of the American Statistical Association</em> 81 (394): 321–27. <a href="https://doi.org/10.2307/2289219">https://doi.org/10.2307/2289219</a>.
</div>
<div id="ref-betareg:R:2009" class="csl-entry" role="listitem">
R Core Team. 2024. <em><span>R</span>: <span>A</span> Language and Environment for Statistical Computing</em>. Vienna: R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
<div id="ref-betareg:Ramsey:1969" class="csl-entry" role="listitem">
Ramsey, James B. 1969. <span>“Tests for Specification Error in Classical Linear Least Squares Regression Analysis.”</span> <em>Journal of the Royal Statistical Society B</em> 31: 350–71. <a href="https://doi.org/10.1111/j.2517-6161.1969.tb00796.x">https://doi.org/10.1111/j.2517-6161.1969.tb00796.x</a>.
</div>
<div id="ref-betareg:Rocha+Cribari-Neto:2009" class="csl-entry" role="listitem">
Rocha, Andréa V., and Francisco Cribari-Neto. 2009. <span>“Beta Autoregressive Moving Average Models.”</span> <em>Test</em> 18: 529–45. <a href="https://doi.org/10.1007/s11749-008-0112-z">https://doi.org/10.1007/s11749-008-0112-z</a>.
</div>
<div id="ref-betareg:Rocha+Simas:2010" class="csl-entry" role="listitem">
Rocha, Andréa V., and Alexandre B. Simas. 2010. <span>“Influence Diagnostics in a General Class of Beta Regression Models.”</span> <em>Test</em> 20: 95–119. <a href="https://doi.org/10.1007/s11749-010-0189-z">https://doi.org/10.1007/s11749-010-0189-z</a>.
</div>
<div id="ref-betareg:Simas+Barreto-Souza+Rocha:2010" class="csl-entry" role="listitem">
Simas, Alexandre B., Wagner Barreto-Souza, and Andréa V. Rocha. 2010. <span>“Improved Estimators for a General Class of Beta Regression Models.”</span> <em>Computational Statistics &amp; Data Analysis</em> 54 (2): 348–66. <a href="https://doi.org/10.1016/j.csda.2009.08.017">https://doi.org/10.1016/j.csda.2009.08.017</a>.
</div>
<div id="ref-betareg:Simas+Rocha:2006" class="csl-entry" role="listitem">
Simas, Alexandre B., and Andréa V. Rocha. 2006. <em><span class="nocase">betareg</span>: Beta Regression</em>. <a href="https://CRAN.R-project.org/src/contrib/Archive/betareg/">https://CRAN.R-project.org/src/contrib/Archive/betareg/</a>.
</div>
<div id="ref-betareg:Smithson+Verkuilen:2006" class="csl-entry" role="listitem">
Smithson, Michael, and Jay Verkuilen. 2006. <span>“A Better Lemon Squeezer? Maximum-Likelihood Regression with Beta-Distributed Dependent Variables.”</span> <em>Psychological Methods</em> 11 (1): 54–71. <a href="https://doi.org/10.1037/1082-989x.11.1.54">https://doi.org/10.1037/1082-989x.11.1.54</a>.
</div>
<div id="ref-betareg:Vasconcellos+Cribari-Neto:2005" class="csl-entry" role="listitem">
Vasconcellos, Klaus L. P., and Francisco Cribari-Neto. 2005. <span>“Improved Maximum Likelihood Estimation in a New Class of Beta Regression Models.”</span> <em>Brazilian Journal of Probability and Statistics</em> 19 (1): 13–31. <a href="https://doi.org/10.1080/00949650212144">https://doi.org/10.1080/00949650212144</a>.
</div>
<div id="ref-betareg:Wei+Hu+Fung:1998" class="csl-entry" role="listitem">
Wei, Bo-Cheng, Yue-Qing Hu, and Wing-Kam Fung. 1998. <span>“Generalized Leverage and Its Applications.”</span> <em>Scandinavian Journal of Statistics</em> 25 (1): 25–37. <a href="https://doi.org/10.1111/1467-9469.00086">https://doi.org/10.1111/1467-9469.00086</a>.
</div>
<div id="ref-betareg:Williams:1982" class="csl-entry" role="listitem">
Williams, D. A. 1982. <span>“Extra Binomial Variation in Logistic Linear Models.”</span> <em>Applied Statistics</em> 31 (2): 144–48. <a href="https://doi.org/10.2307/2347977">https://doi.org/10.2307/2347977</a>.
</div>
<div id="ref-betareg:Zeileis:2004" class="csl-entry" role="listitem">
Zeileis, Achim. 2004. <span>“Econometric Computing with <span>HC</span> and <span>HAC</span> Covariance Matrix Estimators.”</span> <em>Journal of Statistical Software</em> 11 (10): 1–17. <a href="https://doi.org/10.18637/jss.v011.i10">https://doi.org/10.18637/jss.v011.i10</a>.
</div>
<div id="ref-betareg:Zeileis:2006" class="csl-entry" role="listitem">
———. 2006a. <span>“Implementing a Class of Structural Change Tests: An Econometric Computing Approach.”</span> <em>Computational Statistics &amp; Data Analysis</em> 50 (11): 2987–3008. <a href="https://doi.org/10.1016/j.csda.2005.07.001">https://doi.org/10.1016/j.csda.2005.07.001</a>.
</div>
<div id="ref-betareg:Zeileis:2006a" class="csl-entry" role="listitem">
———. 2006b. <span>“Object-Oriented Computation of Sandwich Estimators.”</span> <em>Journal of Statistical Software</em> 16 (9): 1–16. <a href="https://doi.org/10.18637/jss.v016.i09">https://doi.org/10.18637/jss.v016.i09</a>.
</div>
<div id="ref-betareg:Zeileis+Croissant:2010" class="csl-entry" role="listitem">
Zeileis, Achim, and Yves Croissant. 2010. <span>“Extended Model Formulas in <span>R</span>: Multiple Parts and Multiple Responses.”</span> <em>Journal of Statistical Software</em> 34 (1): 1–13. <a href="https://doi.org/10.18637/jss.v034.i01">https://doi.org/10.18637/jss.v034.i01</a>.
</div>
<div id="ref-betareg:Zeileis+Hothorn:2002" class="csl-entry" role="listitem">
Zeileis, Achim, and Torsten Hothorn. 2002. <span>“Diagnostic Checking in Regression Relationships.”</span> <em>R News</em> 2 (3): 7–10. <a href="https://doi.org/10.32614/CRAN.package.lmtest">https://doi.org/10.32614/CRAN.package.lmtest</a>.
</div>
<div id="ref-betareg:Zeileis+Kleiber+Jackman:2008" class="csl-entry" role="listitem">
Zeileis, Achim, Christian Kleiber, and Simon Jackman. 2008. <span>“Regression Models for Count Data in <span>R</span>.”</span> <em>Journal of Statistical Software</em> 27 (8): 1–25. <a href="https://doi.org/10.18637/jss.v027.i08">https://doi.org/10.18637/jss.v027.i08</a>.
</div>
<div id="ref-betareg:Zeileis+Leisch+Hornik:2002" class="csl-entry" role="listitem">
Zeileis, Achim, Friedrich Leisch, Kurt Hornik, and Christian Kleiber. 2002. <span>“<span class="nocase">strucchange</span>: <span>A</span>n <span>R</span> Package for Testing for Structural Change in Linear Regression Models.”</span> <em>Journal of Statistical Software</em> 7 (2): 1–38. <a href="https://doi.org/10.18637/jss.v007.i02">https://doi.org/10.18637/jss.v007.i02</a>.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>
<ol>
<li id="fn1"><p>A beta regression model based on this parameterization was proposed by <span class="citation" data-cites="betareg:Vasconcellos+Cribari-Neto:2005">Vasconcellos and Cribari-Neto (<a href="#ref-betareg:Vasconcellos+Cribari-Neto:2005" role="doc-biblioref">2005</a>)</span>. We shall, however, focus on the parameterization indexed by the mean and a precision parameter.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>In R, the BIC can be computed by means of <code><a href="https://rdrr.io/r/stats/AIC.html">AIC()</a></code> when <span class="math inline">\(\log(n)\)</span> is supplied as the penalty term <code>k</code>.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Note that <span class="citation" data-cites="betareg:Cribari-Neto+Lima:2007">Cribari-Neto and Lima (<a href="#ref-betareg:Cribari-Neto+Lima:2007" role="doc-biblioref">2007</a>)</span> did not account for estimation of <span class="math inline">\(\phi\)</span> in their degrees of freedom. Hence, their reported AICs differ by 2.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></div></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/topmodels\.R-Forge\.R-project\.org\/betareg\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>