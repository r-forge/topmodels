<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.53">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Zero-augmented models – countreg</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../countreg.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
<meta property="og:title" content="Zero-augmented models – countreg">
<meta property="og:description" content="">
<meta property="og:image" content="https://topmodels.R-Forge.R-project.org/countreg/vignettes/countreg.png">
<meta property="og:site_name" content="countreg">
<meta name="twitter:title" content="Zero-augmented models – countreg">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://topmodels.R-Forge.R-project.org/countreg/vignettes/countreg.png">
<meta name="twitter:image:alt" content="countreg: Count Data Regression in R">
<meta name="twitter:site" content="@AchimZeileis">
<meta name="twitter:card" content="summary">
</head>
<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../countreg-wide.png" alt="countreg logo" class="navbar-logo"></a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Get started</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-documentation" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Documentation</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-documentation">
<li>
    <a class="dropdown-item" href="../man/nbreg.html">
 <span class="dropdown-text">Negative binomial regression</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../man/hurdle.html">
 <span class="dropdown-text">Hurdle models</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../man/zeroinfl.html">
 <span class="dropdown-text">Zero-inflated models</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../man/zerotrunc.html">
 <span class="dropdown-text">Zero-truncated models</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../man/FLXMRnegbin.html">
 <span class="dropdown-text">Finite mixtures, boosting, GLMs</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../man/disptest.html">
 <span class="dropdown-text">Diagnostic tests</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../man/CrabSatellites.html">
 <span class="dropdown-text">Data sets</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../man/binom.html">
 <span class="dropdown-text">Distribution extensions</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-vignettes" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Vignettes</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-vignettes">
<li>
    <a class="dropdown-item" href="../vignettes/intro.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../vignettes/basics.html">
 <span class="dropdown-text">Basics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../vignettes/zero-augmented.html">
 <span class="dropdown-text">Zero-augmented models</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item">
    <a class="nav-link" href="../NEWS.html"> 
<span class="menu-text">News</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../CITATION.html"> 
<span class="menu-text">Citation</span></a>
  </li>  
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item">
    <a class="nav-link" href="../contact.html"> 
<span class="menu-text">Contact</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://R-Forge.R-project.org/projects/countreg"> <i class="bi bi-code" role="img" aria-label="countreg @ R-Forge">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#hurdle-models" id="toc-hurdle-models" class="nav-link active" data-scroll-target="#hurdle-models"><span class="header-section-number">1</span> Hurdle models</a></li>
  <li><a href="#zero-inflated-models" id="toc-zero-inflated-models" class="nav-link" data-scroll-target="#zero-inflated-models"><span class="header-section-number">2</span> Zero-inflated models</a></li>
  <li>
<a href="#sec-illustrations" id="toc-sec-illustrations" class="nav-link" data-scroll-target="#sec-illustrations"><span class="header-section-number">3</span> Illustrations</a>
  <ul class="collapse">
<li><a href="#hurdle-regression" id="toc-hurdle-regression" class="nav-link" data-scroll-target="#hurdle-regression"><span class="header-section-number">3.1</span> Hurdle regression</a></li>
  <li><a href="#zero-inflated-regression" id="toc-zero-inflated-regression" class="nav-link" data-scroll-target="#zero-inflated-regression"><span class="header-section-number">3.2</span> Zero-inflated regression</a></li>
  <li><a href="#comparison" id="toc-comparison" class="nav-link" data-scroll-target="#comparison"><span class="header-section-number">3.3</span> Comparison</a></li>
  </ul>
</li>
  <li><a href="#sec-hurdle" id="toc-sec-hurdle" class="nav-link" data-scroll-target="#sec-hurdle"><span class="header-section-number">4</span> Technical details for hurdle models</a></li>
  <li><a href="#sec-zeroinfl" id="toc-sec-zeroinfl" class="nav-link" data-scroll-target="#sec-zeroinfl"><span class="header-section-number">5</span> Technical details for zero-inflated models</a></li>
  <li><a href="#sec-methods" id="toc-sec-methods" class="nav-link" data-scroll-target="#sec-methods"><span class="header-section-number">6</span> Methods for fitted zero-inflated and hurdle models</a></li>
  
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header"><h1 class="title display-7">Zero-augmented models</h1>

</header><div class="hidden">
<p><span class="math display">\[
\newcommand{\E}{\mathsf{E}}
\newcommand{\VAR}{\mathsf{VAR}}
\newcommand{\COV}{\mathsf{COV}}
\newcommand{\Prob}{\mathsf{P}}
\]</span></p>
</div>
<section id="hurdle-models" class="level2" data-number="1"><h2 data-number="1" class="anchored" data-anchor-id="hurdle-models">
<span class="header-section-number">1</span> Hurdle models</h2>
<p>In addition to over-dispersion, many empirical count data sets exhibit more zero observations than would be allowed for by the Poisson model. One model class capable of capturing both properties is the hurdle model, originally proposed by <span class="citation" data-cites="countreg:Mullahy:1986">Mullahy (<a href="#ref-countreg:Mullahy:1986" role="doc-biblioref">1986</a>)</span> in the econometrics literature <span class="citation" data-cites="countreg:Cameron+Trivedi:1998 countreg:Cameron+Trivedi:2005">(see <a href="#ref-countreg:Cameron+Trivedi:1998" role="doc-biblioref">Cameron and Trivedi 1998</a>; <a href="#ref-countreg:Cameron+Trivedi:2005" role="doc-biblioref">Cameron and Trivedi 2005</a> for an overview)</span>. They are two-component models: A truncated count component, such as Poisson, geometric or negative binomial, is employed for positive counts, and a hurdle component models zero vs.&nbsp;larger counts. For the latter, either a binomial model or a censored count distribution can be employed.</p>
<p>More formally, the hurdle model combines a count data model <span class="math inline">\(f_\mathrm{count}(y; x, \beta)\)</span> (that is left-truncated at <span class="math inline">\(y = 1\)</span>) and a zero hurdle model <span class="math inline">\(f_\mathrm{zero}(y; z, \gamma)\)</span> (right-censored at <span class="math inline">\(y = 1\)</span>): <span id="eq-hurdle"><span class="math display">\[
f_\mathrm{hurdle}(y; x, z, \beta, \gamma) =
  \left\{
  \begin{array}{ll}
  f_\mathrm{zero}(0; z, \gamma) &amp; \mbox{if } y = 0, \\
  (1 - f_\mathrm{zero}(0; z, \gamma)) \cdot
  f_\mathrm{count}(y; x, \beta)/(1 - f_\mathrm{count}(0; x, \beta)) &amp; \mbox{if } y &gt; 0
  \end{array}
  \right.
\tag{1}\]</span></span> The model parameters <span class="math inline">\(\beta\)</span>, <span class="math inline">\(\gamma\)</span>, and potentially one or two additional dispersion parameters <span class="math inline">\(\theta\)</span> (if <span class="math inline">\(f_\mathrm{count}\)</span> or <span class="math inline">\(f_\mathrm{zero}\)</span> or both are negative binomial densities) are estimated by ML, where the specification of the likelihood has the advantage that the count and the hurdle component can be maximized separately. The corresponding mean regression relationship is given by <span id="eq-hurdle-mean"><span class="math display">\[
\log(\mu_i) \quad = \quad x_i^\top \beta +
                    \log(1 - f_\mathrm{zero}(0; z_i, \gamma)) -
            \log(1 - f_\mathrm{count}(0; x_i, \beta)),
\tag{2}\]</span></span> again using the canonical log link. For interpreting the zero model as a hurdle, a binomial GLM is probably the most intuitive specification<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. Another useful interpretation arises if the same regressors <span class="math inline">\(x_i = z_i\)</span> are used in the same count model in both components <span class="math inline">\(f_\mathrm{count} = f_\mathrm{zero}\)</span>: A test of the hypothesis <span class="math inline">\(\beta = \gamma\)</span> then tests whether the hurdle is needed or not.</p>
<p>In R, hurdle count data models can be fitted with the <code>hurdle()</code> function from the <strong>countreg</strong> package <span class="citation" data-cites="countreg:Zeileis+Kleiber:2013">(<a href="#ref-countreg:Zeileis+Kleiber:2013" role="doc-biblioref">Zeileis and Kleiber 2013</a>)</span>. Both its fitting function and the returned model objects of class <code>hurdle</code> are modelled after the corresponding GLM functionality in R. The arguments of <code>hurdle()</code> are given by</p>
<pre><code>hurdle(formula, data, subset, na.action, weights, offset,
  dist = "poisson", zero.dist = "binomial", link = "logit",
  control = hurdle.control(...),
  model = TRUE, y = TRUE, x = FALSE, ...)</code></pre>
<p>where the first line contains the standard model-frame specifications, the second and third lines have the arguments specific to hurdle models and the arguments in the last line control some components of the return value.</p>
<p>If a <code>formula</code> of type <code>y ~ x1 + x2</code> is supplied, it not only describes the count regression relationship of <span class="math inline">\(y_i\)</span> and <span class="math inline">\(x_i\)</span> but also implies that the same set of regressors is used for the zero hurdle component <span class="math inline">\(z_i = x_i\)</span>. This is could be made more explicit by equivalently writing the formula as <code>y ~ x1 + x2 | x1 + x2</code>. Of course, a different set of regressors could be specified for the zero hurdle component, e.g., <code>y ~ x1 + x2 | z1 + z2 + z3</code>, giving the count data model <code>y ~ x1 + x2</code> conditional on (<code>|</code>) the zero hurdle model <code>y ~ z1 + z2 + z3</code>.</p>
<p>The model likelihood can be specified by the <code>dist</code>, <code>zero.dist</code> and <code>link</code> arguments. The count data distribution <code>dist</code> is <code>"poisson"</code> by default (it can also be set to <code>"negbin"</code> or <code>"geometric"</code>), for which the canonical log link is always used. The distribution for the zero hurdle model can be specified via <code>zero.dist</code>. The default is a binomial model with <code>link</code> (defaulting to <code>"logit"</code>, but all link functions of the <code><a href="https://rdrr.io/r/stats/family.html">binomial()</a></code> family are also supported), alternatively a right-censored count distribution (Poisson, negative binomial or geometric, all with log link) could be specified.</p>
<p>ML estimation of all parameters employing analytical gradients is carried out using R’s <code><a href="https://rdrr.io/r/stats/optim.html">optim()</a></code> with control options set in <code>hurdle.control()</code>. Starting values can be user-supplied, otherwise they are estimated by <code><a href="https://rdrr.io/r/stats/glm.html">glm.fit()</a></code> (the default). The covariance matrix estimate is derived numerically using the Hessian matrix returned by <code><a href="https://rdrr.io/r/stats/optim.html">optim()</a></code>. See <a href="#sec-hurdle" class="quarto-xref">Section&nbsp;4</a> for further technical details.</p>
<p>The returned fitted-model object of class <code>hurdle</code> is a list similar to <code>glm</code> objects. Some of its elements—such as <code>coefficients</code> or <code>terms</code>—are lists with a zero and count component, respectively. For details see <a href="#sec-hurdle" class="quarto-xref">Section&nbsp;4</a>.</p>
<p>A set of standard extractor functions for fitted model objects is available for objects of class <code>hurdle</code>, including the usual <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> method that provides partial Wald tests for all coefficients. No <code><a href="https://rdrr.io/r/stats/anova.html">anova()</a></code> method is provided, but the general <code>coeftest()</code>, <code>waldtest()</code> from <strong>lmtest</strong>, and <code>linearHypothesis()</code> from <strong>car</strong> can be used for Wald tests and <code>lrtest()</code> from <strong>lmtest</strong> for LR tests of nested models. The function <code>hurdletest()</code> is a convenience interface to <code>linearHypothesis()</code> for testing for the presence of a hurdle (which is only applicable if the same regressors and the same count distribution are used in both components).</p>
</section><section id="zero-inflated-models" class="level2" data-number="2"><h2 data-number="2" class="anchored" data-anchor-id="zero-inflated-models">
<span class="header-section-number">2</span> Zero-inflated models</h2>
<p>Zero-inflated models <span class="citation" data-cites="countreg:Mullahy:1986 countreg:Lambert:1992">(<a href="#ref-countreg:Mullahy:1986" role="doc-biblioref">Mullahy 1986</a>; <a href="#ref-countreg:Lambert:1992" role="doc-biblioref">Lambert 1992</a>)</span> are another model class capable of dealing with excess zero counts <span class="citation" data-cites="countreg:Cameron+Trivedi:1998 countreg:Cameron+Trivedi:2005">(see <a href="#ref-countreg:Cameron+Trivedi:1998" role="doc-biblioref">Cameron and Trivedi 1998</a>; <a href="#ref-countreg:Cameron+Trivedi:2005" role="doc-biblioref">2005</a> for an overview)</span>. They are two-component mixture models combining a point mass at zero with a count distribution such as Poisson, geometric or negative binomial. Thus, there are two sources of zeros: zeros may come from both the point mass and from the count component. For modeling the unobserved state (zero vs.&nbsp;count), a binary model is used: in the simplest case only with an intercept but potentially containing regressors.</p>
<p>Formally, the zero-inflated density is a mixture of a point mass at zero <span class="math inline">\(I_{\{0\}}(y)\)</span> and a count distribution <span class="math inline">\(f_\mathrm{count}(y; x, \beta)\)</span>. The probability of observing a zero count is inflated with probability <span class="math inline">\(\pi = f_\mathrm{zero}(0; z, \gamma)\)</span>: <span id="eq-zeroinfl"><span class="math display">\[
f_\mathrm{zeroinfl}(y; x, z, \beta, \gamma) \quad = \quad
  f_\mathrm{zero}(0; z, \gamma) \cdot I_{\{0\}}(y) \; + \;
  (1 - f_\mathrm{zero}(0; z, \gamma)) \cdot f_\mathrm{count}(y; x, \beta),
\tag{3}\]</span></span> where <span class="math inline">\(I(\cdot)\)</span> is the indicator function and the unobserved probability <span class="math inline">\(\pi\)</span> of belonging to the point mass component is modelled by a binomial GLM <span class="math inline">\(\pi = g^{-1}(z^\top \gamma)\)</span>. The corresponding regression equation for the mean is <span id="eq-zeroinfl-mean"><span class="math display">\[
\mu_i \quad = \quad \pi_i \cdot 0 \; + \; (1 - \pi_i) \cdot \exp(x_i^\top \beta),
\tag{4}\]</span></span> using the canonical log link. The vector of regressors in the zero-inflation model <span class="math inline">\(z_i\)</span> and the regressors in the count component <span class="math inline">\(x_i\)</span> need not to be distinct—in the simplest case, <span class="math inline">\(z_i = 1\)</span> is just an intercept. The default link function <span class="math inline">\(g(\pi)\)</span> in binomial GLMs is the logit link, but other links such as the probit are also available. The full set of parameters of <span class="math inline">\(\beta\)</span>, <span class="math inline">\(\gamma\)</span>, and potentially the dispersion parameter <span class="math inline">\(\theta\)</span> (if a negative binomial count model is used) can be estimated by ML. Inference is typically performed for <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\gamma\)</span>, while <span class="math inline">\(\theta\)</span> is treated as a nuisance parameter even if a negative binomial model is used.</p>
<p>In R, zero-inflated count data models can be fitted with the <code>zeroinfl()</code> function from the <strong>countreg</strong> package. Both the fitting function interface and the returned model objects of class <code>zeroinfl</code> are almost identical to the corresponding <code>hurdle()</code> functionality and again modelled after the corresponding GLM functionality in R. The arguments of <code>zeroinfl()</code> are given by</p>
<pre><code>zeroinfl(formula, data, subset, na.action, weights, offset,
  dist = "poisson", link = "logit", control = zeroinfl.control(...),
  model = TRUE, y = TRUE, x = FALSE, ...)</code></pre>
<p>where all arguments have almost the same meaning as for <code>hurdle()</code>. The main difference is that there is no <code>zero.dist</code> argument: a binomial model is always used for distribution in the zero-inflation component.</p>
<p>Again, ML estimates of all parameters are obtained from <code><a href="https://rdrr.io/r/stats/optim.html">optim()</a></code>, with control options set in <code>zeroinfl.control()</code> and employing analytical gradients. Starting values can be user-supplied, estimated by the expectation maximization (EM) algorithm, or by <code><a href="https://rdrr.io/r/stats/glm.html">glm.fit()</a></code> (the default). The covariance matrix estimate is derived numerically using the Hessian matrix returned by <code><a href="https://rdrr.io/r/stats/optim.html">optim()</a></code>. Using EM estimation for deriving starting values is typically slower but can be numerically more stable. It already maximizes the likelihood, but a single <code><a href="https://rdrr.io/r/stats/optim.html">optim()</a></code> iteration is used for determining the covariance matrix estimate. See <a href="#sec-zeroinfl" class="quarto-xref">Section&nbsp;5</a> for further technical details.</p>
<p>The returned fitted model object is of class <code>zeroinfl</code> whose structure is virtually identical to that of <code>hurdle</code> models. As above, a set of standard extractor functions for fitted model objects is available for objects of class <code>zeroinfl</code>, including the usual <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> method that provides partial Wald tests for all coefficients. Again, no <code><a href="https://rdrr.io/r/stats/anova.html">anova()</a></code> method is provided, but the general functions <code>coeftest()</code> and <code>waldtest()</code> from <strong>lmtest</strong>, as well as <code>linearHypothesis()</code> from <strong>car</strong> can be used for Wald tests, and <code>lrtest()</code> from <strong>lmtest</strong> for LR tests of nested models.</p>
</section><section id="sec-illustrations" class="level2" data-number="3"><h2 data-number="3" class="anchored" data-anchor-id="sec-illustrations">
<span class="header-section-number">3</span> Illustrations</h2>
<p>In the following, we illustrate hurdle and zero-inflated models by applying them to the cross-sectional data set used in <span class="citation" data-cites="countreg:Deb+Trivedi:1997">Deb and Trivedi (<a href="#ref-countreg:Deb+Trivedi:1997" role="doc-biblioref">1997</a>)</span>. It is based on the US National Medical Expenditure Survey (NMES) for 1987/88 and is available from the data archive of the <em>Journal of Applied Econometrics</em> at <a href="https://journaldata.zbw.eu/dataset/demand-for-medical-care-by-the-elderly-a-finite-mixture-approach" class="uri">https://journaldata.zbw.eu/dataset/demand-for-medical-care-by-the-elderly-a-finite-mixture-approach</a>. It was prepared for the R package <strong>AER</strong> accompanying <span class="citation" data-cites="countreg:Kleiber+Zeileis:2008">Kleiber and Zeileis (<a href="#ref-countreg:Kleiber+Zeileis:2008" role="doc-biblioref">2008</a>)</span> and is also available as <code>DebTrivedi.rda</code> in the <em>Journal of Statistical Software</em> together with <span class="citation" data-cites="countreg:Zeileis:2006">Zeileis (<a href="#ref-countreg:Zeileis:2006" role="doc-biblioref">2006</a>)</span>. The same data set is used to illustrate some basic count data models in the article <a href="../vignettes/basics.html#sec-illustrations">“Basics”</a>, which contains a more detailed description and a basic exploratory analysis of the data.</p>
<p>The objective is to model the number of physician office visits <code>visits</code> using the health status variables <code>health</code> (self-perceived health status), <code>chronic</code> (number of chronic conditions), as well as the socio-economic variables <code>gender</code>, <code>school</code> (number of years of education), and <code>insurance</code> (private insurance indicator) as regressors. For convenience, we select the variables used from the full data set:</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"NMES1988"</span>, package <span class="op">=</span> <span class="st">"AER"</span><span class="op">)</span></span>
<span><span class="va">dt</span> <span class="op">&lt;-</span> <span class="va">NMES1988</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">13</span>, <span class="fl">15</span>, <span class="fl">18</span><span class="op">)</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>At the end, we will provide a brief comparison between the zero-adjusted models and the basic count data models illustrated in <a href="../vignettes/basics.html#sec-illustrations">“Basics”</a>.</p>
<section id="hurdle-regression" class="level3" data-number="3.1"><h3 data-number="3.1" class="anchored" data-anchor-id="hurdle-regression">
<span class="header-section-number">3.1</span> Hurdle regression</h3>
<p>The exploratory analysis in <a href="../vignettes/basics.html#sec-illustrations">“Basics”</a> conveyed the impression that there might be more zero observations than explained by the basic count data distributions, hence a negative binomial hurdle model is fitted via</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fm_hurdle0</span> <span class="op">&lt;-</span> <span class="fu">hurdle</span><span class="op">(</span><span class="va">visits</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">dt</span>, dist <span class="op">=</span> <span class="st">"negbin"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This uses the same type of count data model as in the preceeding section but it is now truncated for <code>visits &lt; 1</code> and has an additional hurdle component modeling zero vs.&nbsp;count observations. By default, the hurdle component is a binomial GLM with logit link which contains all regressors used in the count model. The associated coefficient estimates and partial Wald tests for both model components are displayed via</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fm_hurdle0</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
hurdle(formula = visits ~ ., data = dt, dist = "negbin")

Pearson residuals:
    Min      1Q  Median      3Q     Max 
-1.1362 -0.7069 -0.2790  0.3066 17.1420 

Count model coefficients (truncated negbin with log link):
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)      1.194286   0.060182  19.844  &lt; 2e-16 ***
healthpoor       0.382645   0.048855   7.832 4.79e-15 ***
healthexcellent -0.368340   0.067493  -5.457 4.83e-08 ***
chronic          0.147537   0.012654  11.659  &lt; 2e-16 ***
gendermale      -0.056464   0.033144  -1.704  0.08846 .  
school           0.021187   0.004632   4.574 4.79e-06 ***
insuranceyes     0.130454   0.043511   2.998  0.00272 ** 
Log(theta)       0.269981   0.043070   6.268 3.65e-10 ***
Zero hurdle model coefficients (binomial with logit link):
                Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)      0.07459    0.13919   0.536   0.5920    
healthpoor       0.04995    0.15969   0.313   0.7544    
healthexcellent -0.30883    0.14256  -2.166   0.0303 *  
chronic          0.55842    0.04505  12.395  &lt; 2e-16 ***
gendermale      -0.40145    0.08737  -4.595 4.33e-06 ***
school           0.05821    0.01196   4.867 1.13e-06 ***
insuranceyes     0.74670    0.10059   7.424 1.14e-13 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Theta: count = 1.3099
Number of iterations in BFGS optimization: 14 
Log-likelihood: -1.215e+04 on 15 Df</code></pre>
</div>
</div>
<p>The coefficients in the count component resemble those from the previous models, but the increase in the log-likelihood (see also <a href="#tbl-summary" class="quarto-xref">Table&nbsp;1</a>) conveys that the model has improved by including the hurdle component. However, it might be possible to omit the <code>health</code> variable from the hurdle model. To test this hypothesis, the reduced model is fitted via</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fm_hurdle</span> <span class="op">&lt;-</span> <span class="fu">hurdle</span><span class="op">(</span><span class="va">visits</span> <span class="op">~</span> <span class="va">.</span> <span class="op">|</span> <span class="va">chronic</span> <span class="op">+</span> <span class="va">insurance</span> <span class="op">+</span> <span class="va">school</span> <span class="op">+</span> <span class="va">gender</span>,</span>
<span>  data <span class="op">=</span> <span class="va">dt</span>, dist <span class="op">=</span> <span class="st">"negbin"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>and can then be compared to the full model in a Wald test</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">waldtest</span><span class="op">(</span><span class="va">fm_hurdle0</span>, <span class="va">fm_hurdle</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Wald test

Model 1: visits ~ .
Model 2: visits ~ . | chronic + insurance + school + gender
  Res.Df Df  Chisq Pr(&gt;Chisq)  
1   4391                       
2   4393 -2 4.8785    0.08723 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>or an LR test</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">lrtest</span><span class="op">(</span><span class="va">fm_hurdle0</span>, <span class="va">fm_hurdle</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>which leads to virtually identical results.</p>
</section><section id="zero-inflated-regression" class="level3" data-number="3.2"><h3 data-number="3.2" class="anchored" data-anchor-id="zero-inflated-regression">
<span class="header-section-number">3.2</span> Zero-inflated regression</h3>
<p>A different way of augmenting the negative binomial count model <code>fm_nbin</code> with additional probability weight for zero counts is a zero-inflated negative binomial (ZINB) regression. The default model is fitted via</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fm_zinb0</span> <span class="op">&lt;-</span> <span class="fu">zeroinfl</span><span class="op">(</span><span class="va">visits</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">dt</span>, dist <span class="op">=</span> <span class="st">"negbin"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As for the hurdle model above, all regressors from the count model are also used in the zero-inflation model. Again, we can modify the regressors in the zero-inflation part, e.g., by fitting a second model</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fm_zinb</span> <span class="op">&lt;-</span> <span class="fu">zeroinfl</span><span class="op">(</span><span class="va">visits</span> <span class="op">~</span> <span class="va">.</span> <span class="op">|</span> <span class="va">chronic</span> <span class="op">+</span> <span class="va">insurance</span> <span class="op">+</span> <span class="va">school</span> <span class="op">+</span> <span class="va">gender</span>,</span>
<span>  data <span class="op">=</span> <span class="va">dt</span>, dist <span class="op">=</span> <span class="st">"negbin"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>that has the same variables in the zero-inflation part as the hurdle component in <code>fm_hurdle</code>. By omitting the <code>health</code> variable, the fit does not change significantly which can again be brought out by a Wald test</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">waldtest</span><span class="op">(</span><span class="va">fm_zinb0</span>, <span class="va">fm_zinb</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Wald test

Model 1: visits ~ .
Model 2: visits ~ . | chronic + insurance + school + gender
  Res.Df Df  Chisq Pr(&gt;Chisq)
1   4391                     
2   4393 -2 0.0937     0.9542</code></pre>
</div>
</div>
<p>or an LR test <code>lrtest(fm_zinb0, fm_zinb)</code> that produces virtually identical results. The chosen fitted model can again be inspected via</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fm_zinb</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>See <a href="#tbl-summary" class="quarto-xref">Table&nbsp;1</a> for a more concise summary.</p>
<div class="cell">
<div id="tbl-summary" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Summary of fitted count regression models for NMES data (including the models from <a href="../vignettes/basics.html#sec-illustrations">“Basics”</a>): coefficient estimates from count model, zero-inflation model (both with standard errors in parantheses) , number of estimated parameters, maximized log-likelihood, AIC, BIC and expected number of zeros (sum of fitted densities evaluated at zero). The observed number of zeros is 683 in 4406 observations.
</figcaption><div aria-describedby="tbl-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
 

  
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>tinytable_xqun60yecvj99h3qv9dg</title>
<style>
.table td.tinytable_css_3tn47ir14g38lgalp43h, .table th.tinytable_css_3tn47ir14g38lgalp43h {    border-bottom: solid 0.1em #d3d8dc; }
.table td.tinytable_css_kzdw9dcx9sucr6w8u8ei, .table th.tinytable_css_kzdw9dcx9sucr6w8u8ei {    text-align: left; }
.table td.tinytable_css_dfa6tsq58wvysj4rc4ke, .table th.tinytable_css_dfa6tsq58wvysj4rc4ke {    text-align: center; }
.table td.tinytable_css_ydkyevtl8zkqhyhh6jcl, .table th.tinytable_css_ydkyevtl8zkqhyhh6jcl {    text-align: center; }
.table td.tinytable_css_o2v33prh8pguh00hgk8q, .table th.tinytable_css_o2v33prh8pguh00hgk8q {    text-align: center; }
.table td.tinytable_css_wnlqy1bodz0ixt4wqmop, .table th.tinytable_css_wnlqy1bodz0ixt4wqmop {    text-align: center; }
.table td.tinytable_css_yt36pd1ccshlq8egu668, .table th.tinytable_css_yt36pd1ccshlq8egu668 {    text-align: center; }
.table td.tinytable_css_brfzyqjy55hb8bb3fdfh, .table th.tinytable_css_brfzyqjy55hb8bb3fdfh {    text-align: center; }
.table td.tinytable_css_6gh6pbcoto321m6d628z, .table th.tinytable_css_6gh6pbcoto321m6d628z {    border-bottom: solid 0.05em black; }
.table td.tinytable_css_jfx3xlqopxa8s1l3cp9b, .table th.tinytable_css_jfx3xlqopxa8s1l3cp9b {    border-bottom: solid 0.05em black; }
    </style>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script><div class="container">
      <table class="table table-borderless" id="tinytable_xqun60yecvj99h3qv9dg" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
<thead><tr>
<th scope="col"> </th>
                <th scope="col">ML-Pois</th>
                <th scope="col">Adj-Pois</th>
                <th scope="col">Quasi-Pois</th>
                <th scope="col">NB</th>
                <th scope="col">NB-Hurdle</th>
                <th scope="col">ZINB</th>
              </tr></thead>
<tbody>
<tr>
<td>(Intercept)                </td>
                  <td>1.035     </td>
                  <td>1.035     </td>
                  <td>1.035  </td>
                  <td>0.940     </td>
                  <td>1.194     </td>
                  <td>1.198     </td>
                </tr>
<tr>
<td>                           </td>
                  <td>(0.024)   </td>
                  <td>(0.065)   </td>
                  <td>(0.063)</td>
                  <td>(0.055)   </td>
                  <td>(0.060)   </td>
                  <td>(0.057)   </td>
                </tr>
<tr>
<td>healthpoor                 </td>
                  <td>0.318     </td>
                  <td>0.318     </td>
                  <td>0.318  </td>
                  <td>0.368     </td>
                  <td>0.383     </td>
                  <td>0.349     </td>
                </tr>
<tr>
<td>                           </td>
                  <td>(0.017)   </td>
                  <td>(0.056)   </td>
                  <td>(0.046)</td>
                  <td>(0.049)   </td>
                  <td>(0.049)   </td>
                  <td>(0.046)   </td>
                </tr>
<tr>
<td>healthexcellent            </td>
                  <td>-0.379    </td>
                  <td>-0.379    </td>
                  <td>-0.379 </td>
                  <td>-0.374    </td>
                  <td>-0.368    </td>
                  <td>-0.354    </td>
                </tr>
<tr>
<td>                           </td>
                  <td>(0.030)   </td>
                  <td>(0.078)   </td>
                  <td>(0.080)</td>
                  <td>(0.062)   </td>
                  <td>(0.067)   </td>
                  <td>(0.061)   </td>
                </tr>
<tr>
<td>chronic                    </td>
                  <td>0.169     </td>
                  <td>0.169     </td>
                  <td>0.169  </td>
                  <td>0.196     </td>
                  <td>0.148     </td>
                  <td>0.150     </td>
                </tr>
<tr>
<td>                           </td>
                  <td>(0.004)   </td>
                  <td>(0.012)   </td>
                  <td>(0.012)</td>
                  <td>(0.012)   </td>
                  <td>(0.013)   </td>
                  <td>(0.012)   </td>
                </tr>
<tr>
<td>gendermale                 </td>
                  <td>-0.108    </td>
                  <td>-0.108    </td>
                  <td>-0.108 </td>
                  <td>-0.115    </td>
                  <td>-0.056    </td>
                  <td>-0.072    </td>
                </tr>
<tr>
<td>                           </td>
                  <td>(0.013)   </td>
                  <td>(0.036)   </td>
                  <td>(0.034)</td>
                  <td>(0.032)   </td>
                  <td>(0.033)   </td>
                  <td>(0.032)   </td>
                </tr>
<tr>
<td>school                     </td>
                  <td>0.026     </td>
                  <td>0.026     </td>
                  <td>0.026  </td>
                  <td>0.027     </td>
                  <td>0.021     </td>
                  <td>0.022     </td>
                </tr>
<tr>
<td>                           </td>
                  <td>(0.002)   </td>
                  <td>(0.005)   </td>
                  <td>(0.005)</td>
                  <td>(0.004)   </td>
                  <td>(0.005)   </td>
                  <td>(0.004)   </td>
                </tr>
<tr>
<td>insuranceyes               </td>
                  <td>0.216     </td>
                  <td>0.216     </td>
                  <td>0.216  </td>
                  <td>0.250     </td>
                  <td>0.130     </td>
                  <td>0.151     </td>
                </tr>
<tr>
<td>                           </td>
                  <td>(0.017)   </td>
                  <td>(0.043)   </td>
                  <td>(0.045)</td>
                  <td>(0.040)   </td>
                  <td>(0.044)   </td>
                  <td>(0.042)   </td>
                </tr>
<tr>
<td>(Intercept)           </td>
                  <td>          </td>
                  <td>          </td>
                  <td>       </td>
                  <td>          </td>
                  <td>0.054     </td>
                  <td>-0.098    </td>
                </tr>
<tr>
<td>                           </td>
                  <td>          </td>
                  <td>          </td>
                  <td>       </td>
                  <td>          </td>
                  <td>(0.137)   </td>
                  <td>(0.274)   </td>
                </tr>
<tr>
<td>chronic               </td>
                  <td>          </td>
                  <td>          </td>
                  <td>       </td>
                  <td>          </td>
                  <td>0.577     </td>
                  <td>-1.302    </td>
                </tr>
<tr>
<td>                           </td>
                  <td>          </td>
                  <td>          </td>
                  <td>       </td>
                  <td>          </td>
                  <td>(0.043)   </td>
                  <td>(0.191)   </td>
                </tr>
<tr>
<td>insuranceyes          </td>
                  <td>          </td>
                  <td>          </td>
                  <td>       </td>
                  <td>          </td>
                  <td>0.742     </td>
                  <td>-1.193    </td>
                </tr>
<tr>
<td>                           </td>
                  <td>          </td>
                  <td>          </td>
                  <td>       </td>
                  <td>          </td>
                  <td>(0.100)   </td>
                  <td>(0.228)   </td>
                </tr>
<tr>
<td>school                </td>
                  <td>          </td>
                  <td>          </td>
                  <td>       </td>
                  <td>          </td>
                  <td>0.056     </td>
                  <td>-0.087    </td>
                </tr>
<tr>
<td>                           </td>
                  <td>          </td>
                  <td>          </td>
                  <td>       </td>
                  <td>          </td>
                  <td>(0.012)   </td>
                  <td>(0.027)   </td>
                </tr>
<tr>
<td>gendermale            </td>
                  <td>          </td>
                  <td>          </td>
                  <td>       </td>
                  <td>          </td>
                  <td>-0.406    </td>
                  <td>0.583     </td>
                </tr>
<tr>
<td>                           </td>
                  <td>          </td>
                  <td>          </td>
                  <td>       </td>
                  <td>          </td>
                  <td>(0.087)   </td>
                  <td>(0.204)   </td>
                </tr>
<tr>
<td>AIC                        </td>
                  <td>36597.0   </td>
                  <td>36597.0   </td>
                  <td>       </td>
                  <td>24469.9   </td>
                  <td>24331.1   </td>
                  <td>24336.9   </td>
                </tr>
<tr>
<td>BIC                        </td>
                  <td>36641.7   </td>
                  <td>36641.7   </td>
                  <td>       </td>
                  <td>24521.0   </td>
                  <td>24414.2   </td>
                  <td>24419.9   </td>
                </tr>
<tr>
<td>Log.Lik.                   </td>
                  <td>-18291.494</td>
                  <td>-18291.494</td>
                  <td>       </td>
                  <td>-12226.953</td>
                  <td>-12152.560</td>
                  <td>-12155.431</td>
                </tr>
<tr>
<td>no. of parameters          </td>
                  <td>7         </td>
                  <td>7         </td>
                  <td>8      </td>
                  <td>8         </td>
                  <td>13        </td>
                  <td>13        </td>
                </tr>
<tr>
<td>$\sum_{i} \hat{f}_{i}(0)$</td>
                  <td>46        </td>
                  <td>          </td>
                  <td>       </td>
                  <td>618       </td>
                  <td>683       </td>
                  <td>712       </td>
                </tr>
</tbody>
</table>
</div>

    <script>
      function styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(i, j, css_id) {
        var table = document.getElementById("tinytable_xqun60yecvj99h3qv9dg");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_xqun60yecvj99h3qv9dg');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_tinytable_i8uey7yhq8p9jgtwtbx2(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_xqun60yecvj99h3qv9dg");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }

window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(0, 0, 'tinytable_css_3tn47ir14g38lgalp43h') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(0, 1, 'tinytable_css_3tn47ir14g38lgalp43h') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(0, 2, 'tinytable_css_3tn47ir14g38lgalp43h') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(0, 3, 'tinytable_css_3tn47ir14g38lgalp43h') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(0, 4, 'tinytable_css_3tn47ir14g38lgalp43h') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(0, 5, 'tinytable_css_3tn47ir14g38lgalp43h') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(0, 6, 'tinytable_css_3tn47ir14g38lgalp43h') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(0, 0, 'tinytable_css_kzdw9dcx9sucr6w8u8ei') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(1, 0, 'tinytable_css_kzdw9dcx9sucr6w8u8ei') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(2, 0, 'tinytable_css_kzdw9dcx9sucr6w8u8ei') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(3, 0, 'tinytable_css_kzdw9dcx9sucr6w8u8ei') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(4, 0, 'tinytable_css_kzdw9dcx9sucr6w8u8ei') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(5, 0, 'tinytable_css_kzdw9dcx9sucr6w8u8ei') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(6, 0, 'tinytable_css_kzdw9dcx9sucr6w8u8ei') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(7, 0, 'tinytable_css_kzdw9dcx9sucr6w8u8ei') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(8, 0, 'tinytable_css_kzdw9dcx9sucr6w8u8ei') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(9, 0, 'tinytable_css_kzdw9dcx9sucr6w8u8ei') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(10, 0, 'tinytable_css_kzdw9dcx9sucr6w8u8ei') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(11, 0, 'tinytable_css_kzdw9dcx9sucr6w8u8ei') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(12, 0, 'tinytable_css_kzdw9dcx9sucr6w8u8ei') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(13, 0, 'tinytable_css_kzdw9dcx9sucr6w8u8ei') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(14, 0, 'tinytable_css_kzdw9dcx9sucr6w8u8ei') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(15, 0, 'tinytable_css_kzdw9dcx9sucr6w8u8ei') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(16, 0, 'tinytable_css_kzdw9dcx9sucr6w8u8ei') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(17, 0, 'tinytable_css_kzdw9dcx9sucr6w8u8ei') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(18, 0, 'tinytable_css_kzdw9dcx9sucr6w8u8ei') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(19, 0, 'tinytable_css_kzdw9dcx9sucr6w8u8ei') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(20, 0, 'tinytable_css_kzdw9dcx9sucr6w8u8ei') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(21, 0, 'tinytable_css_kzdw9dcx9sucr6w8u8ei') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(22, 0, 'tinytable_css_kzdw9dcx9sucr6w8u8ei') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(23, 0, 'tinytable_css_kzdw9dcx9sucr6w8u8ei') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(24, 0, 'tinytable_css_kzdw9dcx9sucr6w8u8ei') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(25, 0, 'tinytable_css_kzdw9dcx9sucr6w8u8ei') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(26, 0, 'tinytable_css_kzdw9dcx9sucr6w8u8ei') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(27, 0, 'tinytable_css_kzdw9dcx9sucr6w8u8ei') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(28, 0, 'tinytable_css_kzdw9dcx9sucr6w8u8ei') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(29, 0, 'tinytable_css_kzdw9dcx9sucr6w8u8ei') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(0, 1, 'tinytable_css_dfa6tsq58wvysj4rc4ke') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(1, 1, 'tinytable_css_dfa6tsq58wvysj4rc4ke') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(2, 1, 'tinytable_css_dfa6tsq58wvysj4rc4ke') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(3, 1, 'tinytable_css_dfa6tsq58wvysj4rc4ke') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(4, 1, 'tinytable_css_dfa6tsq58wvysj4rc4ke') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(5, 1, 'tinytable_css_dfa6tsq58wvysj4rc4ke') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(6, 1, 'tinytable_css_dfa6tsq58wvysj4rc4ke') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(7, 1, 'tinytable_css_dfa6tsq58wvysj4rc4ke') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(8, 1, 'tinytable_css_dfa6tsq58wvysj4rc4ke') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(9, 1, 'tinytable_css_dfa6tsq58wvysj4rc4ke') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(10, 1, 'tinytable_css_dfa6tsq58wvysj4rc4ke') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(11, 1, 'tinytable_css_dfa6tsq58wvysj4rc4ke') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(12, 1, 'tinytable_css_dfa6tsq58wvysj4rc4ke') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(13, 1, 'tinytable_css_dfa6tsq58wvysj4rc4ke') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(14, 1, 'tinytable_css_dfa6tsq58wvysj4rc4ke') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(15, 1, 'tinytable_css_dfa6tsq58wvysj4rc4ke') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(16, 1, 'tinytable_css_dfa6tsq58wvysj4rc4ke') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(17, 1, 'tinytable_css_dfa6tsq58wvysj4rc4ke') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(18, 1, 'tinytable_css_dfa6tsq58wvysj4rc4ke') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(19, 1, 'tinytable_css_dfa6tsq58wvysj4rc4ke') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(20, 1, 'tinytable_css_dfa6tsq58wvysj4rc4ke') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(21, 1, 'tinytable_css_dfa6tsq58wvysj4rc4ke') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(22, 1, 'tinytable_css_dfa6tsq58wvysj4rc4ke') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(23, 1, 'tinytable_css_dfa6tsq58wvysj4rc4ke') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(24, 1, 'tinytable_css_dfa6tsq58wvysj4rc4ke') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(25, 1, 'tinytable_css_dfa6tsq58wvysj4rc4ke') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(26, 1, 'tinytable_css_dfa6tsq58wvysj4rc4ke') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(27, 1, 'tinytable_css_dfa6tsq58wvysj4rc4ke') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(28, 1, 'tinytable_css_dfa6tsq58wvysj4rc4ke') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(29, 1, 'tinytable_css_dfa6tsq58wvysj4rc4ke') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(0, 2, 'tinytable_css_ydkyevtl8zkqhyhh6jcl') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(1, 2, 'tinytable_css_ydkyevtl8zkqhyhh6jcl') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(2, 2, 'tinytable_css_ydkyevtl8zkqhyhh6jcl') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(3, 2, 'tinytable_css_ydkyevtl8zkqhyhh6jcl') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(4, 2, 'tinytable_css_ydkyevtl8zkqhyhh6jcl') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(5, 2, 'tinytable_css_ydkyevtl8zkqhyhh6jcl') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(6, 2, 'tinytable_css_ydkyevtl8zkqhyhh6jcl') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(7, 2, 'tinytable_css_ydkyevtl8zkqhyhh6jcl') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(8, 2, 'tinytable_css_ydkyevtl8zkqhyhh6jcl') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(9, 2, 'tinytable_css_ydkyevtl8zkqhyhh6jcl') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(10, 2, 'tinytable_css_ydkyevtl8zkqhyhh6jcl') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(11, 2, 'tinytable_css_ydkyevtl8zkqhyhh6jcl') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(12, 2, 'tinytable_css_ydkyevtl8zkqhyhh6jcl') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(13, 2, 'tinytable_css_ydkyevtl8zkqhyhh6jcl') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(14, 2, 'tinytable_css_ydkyevtl8zkqhyhh6jcl') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(15, 2, 'tinytable_css_ydkyevtl8zkqhyhh6jcl') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(16, 2, 'tinytable_css_ydkyevtl8zkqhyhh6jcl') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(17, 2, 'tinytable_css_ydkyevtl8zkqhyhh6jcl') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(18, 2, 'tinytable_css_ydkyevtl8zkqhyhh6jcl') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(19, 2, 'tinytable_css_ydkyevtl8zkqhyhh6jcl') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(20, 2, 'tinytable_css_ydkyevtl8zkqhyhh6jcl') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(21, 2, 'tinytable_css_ydkyevtl8zkqhyhh6jcl') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(22, 2, 'tinytable_css_ydkyevtl8zkqhyhh6jcl') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(23, 2, 'tinytable_css_ydkyevtl8zkqhyhh6jcl') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(24, 2, 'tinytable_css_ydkyevtl8zkqhyhh6jcl') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(25, 2, 'tinytable_css_ydkyevtl8zkqhyhh6jcl') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(26, 2, 'tinytable_css_ydkyevtl8zkqhyhh6jcl') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(27, 2, 'tinytable_css_ydkyevtl8zkqhyhh6jcl') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(28, 2, 'tinytable_css_ydkyevtl8zkqhyhh6jcl') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(29, 2, 'tinytable_css_ydkyevtl8zkqhyhh6jcl') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(0, 3, 'tinytable_css_o2v33prh8pguh00hgk8q') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(1, 3, 'tinytable_css_o2v33prh8pguh00hgk8q') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(2, 3, 'tinytable_css_o2v33prh8pguh00hgk8q') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(3, 3, 'tinytable_css_o2v33prh8pguh00hgk8q') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(4, 3, 'tinytable_css_o2v33prh8pguh00hgk8q') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(5, 3, 'tinytable_css_o2v33prh8pguh00hgk8q') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(6, 3, 'tinytable_css_o2v33prh8pguh00hgk8q') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(7, 3, 'tinytable_css_o2v33prh8pguh00hgk8q') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(8, 3, 'tinytable_css_o2v33prh8pguh00hgk8q') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(9, 3, 'tinytable_css_o2v33prh8pguh00hgk8q') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(10, 3, 'tinytable_css_o2v33prh8pguh00hgk8q') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(11, 3, 'tinytable_css_o2v33prh8pguh00hgk8q') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(12, 3, 'tinytable_css_o2v33prh8pguh00hgk8q') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(13, 3, 'tinytable_css_o2v33prh8pguh00hgk8q') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(14, 3, 'tinytable_css_o2v33prh8pguh00hgk8q') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(15, 3, 'tinytable_css_o2v33prh8pguh00hgk8q') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(16, 3, 'tinytable_css_o2v33prh8pguh00hgk8q') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(17, 3, 'tinytable_css_o2v33prh8pguh00hgk8q') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(18, 3, 'tinytable_css_o2v33prh8pguh00hgk8q') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(19, 3, 'tinytable_css_o2v33prh8pguh00hgk8q') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(20, 3, 'tinytable_css_o2v33prh8pguh00hgk8q') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(21, 3, 'tinytable_css_o2v33prh8pguh00hgk8q') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(22, 3, 'tinytable_css_o2v33prh8pguh00hgk8q') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(23, 3, 'tinytable_css_o2v33prh8pguh00hgk8q') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(24, 3, 'tinytable_css_o2v33prh8pguh00hgk8q') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(25, 3, 'tinytable_css_o2v33prh8pguh00hgk8q') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(26, 3, 'tinytable_css_o2v33prh8pguh00hgk8q') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(27, 3, 'tinytable_css_o2v33prh8pguh00hgk8q') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(28, 3, 'tinytable_css_o2v33prh8pguh00hgk8q') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(29, 3, 'tinytable_css_o2v33prh8pguh00hgk8q') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(0, 4, 'tinytable_css_wnlqy1bodz0ixt4wqmop') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(1, 4, 'tinytable_css_wnlqy1bodz0ixt4wqmop') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(2, 4, 'tinytable_css_wnlqy1bodz0ixt4wqmop') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(3, 4, 'tinytable_css_wnlqy1bodz0ixt4wqmop') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(4, 4, 'tinytable_css_wnlqy1bodz0ixt4wqmop') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(5, 4, 'tinytable_css_wnlqy1bodz0ixt4wqmop') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(6, 4, 'tinytable_css_wnlqy1bodz0ixt4wqmop') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(7, 4, 'tinytable_css_wnlqy1bodz0ixt4wqmop') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(8, 4, 'tinytable_css_wnlqy1bodz0ixt4wqmop') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(9, 4, 'tinytable_css_wnlqy1bodz0ixt4wqmop') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(10, 4, 'tinytable_css_wnlqy1bodz0ixt4wqmop') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(11, 4, 'tinytable_css_wnlqy1bodz0ixt4wqmop') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(12, 4, 'tinytable_css_wnlqy1bodz0ixt4wqmop') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(13, 4, 'tinytable_css_wnlqy1bodz0ixt4wqmop') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(14, 4, 'tinytable_css_wnlqy1bodz0ixt4wqmop') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(15, 4, 'tinytable_css_wnlqy1bodz0ixt4wqmop') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(16, 4, 'tinytable_css_wnlqy1bodz0ixt4wqmop') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(17, 4, 'tinytable_css_wnlqy1bodz0ixt4wqmop') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(18, 4, 'tinytable_css_wnlqy1bodz0ixt4wqmop') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(19, 4, 'tinytable_css_wnlqy1bodz0ixt4wqmop') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(20, 4, 'tinytable_css_wnlqy1bodz0ixt4wqmop') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(21, 4, 'tinytable_css_wnlqy1bodz0ixt4wqmop') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(22, 4, 'tinytable_css_wnlqy1bodz0ixt4wqmop') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(23, 4, 'tinytable_css_wnlqy1bodz0ixt4wqmop') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(24, 4, 'tinytable_css_wnlqy1bodz0ixt4wqmop') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(25, 4, 'tinytable_css_wnlqy1bodz0ixt4wqmop') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(26, 4, 'tinytable_css_wnlqy1bodz0ixt4wqmop') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(27, 4, 'tinytable_css_wnlqy1bodz0ixt4wqmop') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(28, 4, 'tinytable_css_wnlqy1bodz0ixt4wqmop') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(29, 4, 'tinytable_css_wnlqy1bodz0ixt4wqmop') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(0, 5, 'tinytable_css_yt36pd1ccshlq8egu668') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(1, 5, 'tinytable_css_yt36pd1ccshlq8egu668') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(2, 5, 'tinytable_css_yt36pd1ccshlq8egu668') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(3, 5, 'tinytable_css_yt36pd1ccshlq8egu668') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(4, 5, 'tinytable_css_yt36pd1ccshlq8egu668') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(5, 5, 'tinytable_css_yt36pd1ccshlq8egu668') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(6, 5, 'tinytable_css_yt36pd1ccshlq8egu668') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(7, 5, 'tinytable_css_yt36pd1ccshlq8egu668') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(8, 5, 'tinytable_css_yt36pd1ccshlq8egu668') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(9, 5, 'tinytable_css_yt36pd1ccshlq8egu668') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(10, 5, 'tinytable_css_yt36pd1ccshlq8egu668') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(11, 5, 'tinytable_css_yt36pd1ccshlq8egu668') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(12, 5, 'tinytable_css_yt36pd1ccshlq8egu668') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(13, 5, 'tinytable_css_yt36pd1ccshlq8egu668') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(14, 5, 'tinytable_css_yt36pd1ccshlq8egu668') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(15, 5, 'tinytable_css_yt36pd1ccshlq8egu668') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(16, 5, 'tinytable_css_yt36pd1ccshlq8egu668') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(17, 5, 'tinytable_css_yt36pd1ccshlq8egu668') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(18, 5, 'tinytable_css_yt36pd1ccshlq8egu668') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(19, 5, 'tinytable_css_yt36pd1ccshlq8egu668') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(20, 5, 'tinytable_css_yt36pd1ccshlq8egu668') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(21, 5, 'tinytable_css_yt36pd1ccshlq8egu668') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(22, 5, 'tinytable_css_yt36pd1ccshlq8egu668') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(23, 5, 'tinytable_css_yt36pd1ccshlq8egu668') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(24, 5, 'tinytable_css_yt36pd1ccshlq8egu668') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(25, 5, 'tinytable_css_yt36pd1ccshlq8egu668') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(26, 5, 'tinytable_css_yt36pd1ccshlq8egu668') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(27, 5, 'tinytable_css_yt36pd1ccshlq8egu668') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(28, 5, 'tinytable_css_yt36pd1ccshlq8egu668') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(29, 5, 'tinytable_css_yt36pd1ccshlq8egu668') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(0, 6, 'tinytable_css_brfzyqjy55hb8bb3fdfh') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(1, 6, 'tinytable_css_brfzyqjy55hb8bb3fdfh') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(2, 6, 'tinytable_css_brfzyqjy55hb8bb3fdfh') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(3, 6, 'tinytable_css_brfzyqjy55hb8bb3fdfh') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(4, 6, 'tinytable_css_brfzyqjy55hb8bb3fdfh') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(5, 6, 'tinytable_css_brfzyqjy55hb8bb3fdfh') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(6, 6, 'tinytable_css_brfzyqjy55hb8bb3fdfh') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(7, 6, 'tinytable_css_brfzyqjy55hb8bb3fdfh') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(8, 6, 'tinytable_css_brfzyqjy55hb8bb3fdfh') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(9, 6, 'tinytable_css_brfzyqjy55hb8bb3fdfh') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(10, 6, 'tinytable_css_brfzyqjy55hb8bb3fdfh') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(11, 6, 'tinytable_css_brfzyqjy55hb8bb3fdfh') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(12, 6, 'tinytable_css_brfzyqjy55hb8bb3fdfh') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(13, 6, 'tinytable_css_brfzyqjy55hb8bb3fdfh') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(14, 6, 'tinytable_css_brfzyqjy55hb8bb3fdfh') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(15, 6, 'tinytable_css_brfzyqjy55hb8bb3fdfh') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(16, 6, 'tinytable_css_brfzyqjy55hb8bb3fdfh') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(17, 6, 'tinytable_css_brfzyqjy55hb8bb3fdfh') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(18, 6, 'tinytable_css_brfzyqjy55hb8bb3fdfh') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(19, 6, 'tinytable_css_brfzyqjy55hb8bb3fdfh') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(20, 6, 'tinytable_css_brfzyqjy55hb8bb3fdfh') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(21, 6, 'tinytable_css_brfzyqjy55hb8bb3fdfh') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(22, 6, 'tinytable_css_brfzyqjy55hb8bb3fdfh') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(23, 6, 'tinytable_css_brfzyqjy55hb8bb3fdfh') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(24, 6, 'tinytable_css_brfzyqjy55hb8bb3fdfh') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(25, 6, 'tinytable_css_brfzyqjy55hb8bb3fdfh') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(26, 6, 'tinytable_css_brfzyqjy55hb8bb3fdfh') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(27, 6, 'tinytable_css_brfzyqjy55hb8bb3fdfh') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(28, 6, 'tinytable_css_brfzyqjy55hb8bb3fdfh') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(29, 6, 'tinytable_css_brfzyqjy55hb8bb3fdfh') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(24, 0, 'tinytable_css_6gh6pbcoto321m6d628z') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(24, 1, 'tinytable_css_6gh6pbcoto321m6d628z') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(24, 2, 'tinytable_css_6gh6pbcoto321m6d628z') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(24, 3, 'tinytable_css_6gh6pbcoto321m6d628z') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(24, 4, 'tinytable_css_6gh6pbcoto321m6d628z') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(24, 5, 'tinytable_css_6gh6pbcoto321m6d628z') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(24, 6, 'tinytable_css_6gh6pbcoto321m6d628z') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(14, 0, 'tinytable_css_jfx3xlqopxa8s1l3cp9b') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(14, 1, 'tinytable_css_jfx3xlqopxa8s1l3cp9b') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(14, 2, 'tinytable_css_jfx3xlqopxa8s1l3cp9b') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(14, 3, 'tinytable_css_jfx3xlqopxa8s1l3cp9b') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(14, 4, 'tinytable_css_jfx3xlqopxa8s1l3cp9b') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(14, 5, 'tinytable_css_jfx3xlqopxa8s1l3cp9b') })
window.addEventListener('load', function () { styleCell_tinytable_i8uey7yhq8p9jgtwtbx2(14, 6, 'tinytable_css_jfx3xlqopxa8s1l3cp9b') })
    </script>
</div>
</div>
</figure>
</div>
</div>
</section><section id="comparison" class="level3" data-number="3.3"><h3 data-number="3.3" class="anchored" data-anchor-id="comparison">
<span class="header-section-number">3.3</span> Comparison</h3>
<p>Having fitted hurdle and zero-inflated models to the demand for medical care in the NMES data, it is, of course, of interest to understand what these models have in common and what their differences are, especially in comparison to the basic count data models described in <a href="../vignettes/basics.html#sec-illustrations">“Basics”</a>. In this section, we show how to compute the components of <a href="#tbl-summary" class="quarto-xref">Table&nbsp;1</a> and provide some further comments and interpretations.</p>
<p>Before we start the analysis, we refit the models from <a href="../vignettes/basics.html#sec-illustrations">“Basics”</a>:</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fm_pois</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">visits</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">dt</span>, family <span class="op">=</span> <span class="va">poisson</span><span class="op">)</span></span>
<span><span class="va">fm_qpois</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">visits</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">dt</span>, family <span class="op">=</span> <span class="va">quasipoisson</span><span class="op">)</span></span>
<span><span class="va">fm_nbin</span> <span class="op">&lt;-</span> <span class="fu">glm.nb</span><span class="op">(</span><span class="va">visits</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">dt</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As a first comparison, it is of natural interest to inspect the estimated regression coefficients in the count data model</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"ML-Pois"</span> <span class="op">=</span> <span class="va">fm_pois</span>, <span class="st">"Quasi-Pois"</span> <span class="op">=</span> <span class="va">fm_qpois</span>, <span class="st">"NB"</span> <span class="op">=</span> <span class="va">fm_nbin</span>,</span>
<span>  <span class="st">"Hurdle-NB"</span> <span class="op">=</span> <span class="va">fm_hurdle</span>, <span class="st">"ZINB"</span> <span class="op">=</span> <span class="va">fm_zinb</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">fm</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The result (see <a href="#tbl-summary" class="quarto-xref">Table&nbsp;1</a>) shows that there are some small differences, especially between the GLMs and the zero-augmented models. However, the zero-augmented models have to be interpreted slightly differently: While the GLMs all have the same mean function (<span class="math inline">\(g(\mu_i) = x_i^\top \beta\)</span>, see <a href="../vignettes/basics.html">“Basics”</a>), the zero-augmentation also enters the mean function, see (<a href="#eq-zeroinfl-mean" class="quarto-xref">4</a>) and (<a href="#eq-hurdle-mean" class="quarto-xref">2</a>). Nevertheless, the overall impression is that the estimated mean functions are rather similar. Moreover, the associated estimated standard errors are very similar as well (see <a href="#tbl-summary" class="quarto-xref">Table&nbsp;1</a>):</p>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="st">"ML-Pois"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html">vcov</a></span><span class="op">(</span><span class="va">fm_pois</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="st">"Adj-Pois"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fu">sandwich</span><span class="op">(</span><span class="va">fm_pois</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">fm</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html">vcov</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The only exception are the model-based standard errors for the Poisson model, when treated as a fully specified model, which is obviously not appropriate for this data set.</p>
<p>In summary, the models are not too different with respect to their fitted mean functions. The differences become obvious if not only the mean but the full likelihood is considered:</p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span>logLik <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">fm</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  Df <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">fm</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="st">"df"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       ML-Pois Quasi-Pois     NB Hurdle-NB   ZINB
logLik  -18291         NA -12227    -12153 -12155
Df           7          8      8        13     13</code></pre>
</div>
</div>
<p>The ML Poisson model is clearly inferior to all other fits. The quasi-Poisson model and the sandwich-adjusted Poisson model are not associated with a fitted likelihood. The negative binomial already improves the fit dramatically but can in turn be improved by the hurdle and zero-inflated models which give almost identical fits. This also reflects that the over-dispersion in the data is captured better by the negative-binomial-based models than the plain Poisson model. Additionally, it is of interest how the zero counts are captured by the various models. Therefore, the observed zero counts are compared to the expected number of zero counts for the likelihood-based models:</p>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Obs"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">dt</span><span class="op">$</span><span class="va">visits</span> <span class="op">&lt;</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  <span class="st">"ML-Pois"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">dpois</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">fm_pois</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="st">"NB"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/NegBinomial.html">dnbinom</a></span><span class="op">(</span><span class="fl">0</span>, mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">fm_nbin</span><span class="op">)</span>, size <span class="op">=</span> <span class="va">fm_nbin</span><span class="op">$</span><span class="va">theta</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="st">"NB-Hurdle"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fm_hurdle</span>, type <span class="op">=</span> <span class="st">"density"</span>, at <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="st">"ZINB"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fm_zinb</span>, type <span class="op">=</span> <span class="st">"density"</span>, at <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Obs   ML-Pois        NB NB-Hurdle      ZINB 
      683        46       618       683       712 </code></pre>
</div>
</div>
<p>Thus, the ML Poisson model is again not appropriate whereas the negative-binomial-based models are much better in modeling the zero counts. By construction, the expected number of zero counts in the hurdle model matches the observed number.</p>
<p>In summary, the hurdle and zero-inflation models lead to the best results (in terms of likelihood) on this data set. Above, their mean function for the count component was already shown to be very similar, below we take a look at the fitted zero components:</p>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">fm</span><span class="op">[</span><span class="fl">4</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">coefficients</span><span class="op">$</span><span class="va">zero</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          (Intercept) chronic insuranceyes school gendermale
Hurdle-NB       0.054   0.577        0.742  0.056     -0.406
ZINB           -0.098  -1.302       -1.193 -0.087      0.583</code></pre>
</div>
</div>
<p>This shows that the absolute values are rather different—which is not surprising as they pertain to slightly different ways of modeling zero counts—but the signs of the coefficients match, i.e., are just inversed. For the hurdle model, the zero hurdle component describes the probability of observing a positive count whereas, for the ZINB model, the zero-inflation component predicts the probability of observing a zero count from the point mass component. Overall, both models lead to the same qualitative results and very similar model fits. Perhaps the hurdle model is slightly preferable because it has the nicer interpretation: there is one process that controls whether a patient sees a physician or not, and a second process that determines how many office visits are made.</p>
</section></section><section id="sec-hurdle" class="level2" data-number="4"><h2 data-number="4" class="anchored" data-anchor-id="sec-hurdle">
<span class="header-section-number">4</span> Technical details for hurdle models</h2>
<p>The fitting of hurdle models via ML in <code>hurdle()</code> is controlled by the arguments in the <code>hurdle.control()</code> wrapper function:</p>
<pre><code>hurdle.control(method = "BFGS", maxit = 10000, trace = FALSE,
  separate = TRUE, start = NULL, ...)</code></pre>
<p>This modifies some default arguments passed on to the optimizer <code><a href="https://rdrr.io/r/stats/optim.html">optim()</a></code>, such as <code>method</code>, <code>maxit</code> and <code>trace</code>. The latter is also used within <code>hurdle()</code> and can be set to produce more verbose output concerning the fitting process. The argument <code>separate</code> controls whether the two components of the model are optimized separately (the default) or not. This is possible because there are no mixed sources for the zeros in the data (unlike in zero-inflation models). The argument <code>start</code> controls the choice of starting values for calling <code><a href="https://rdrr.io/r/stats/optim.html">optim()</a></code>, all remaining arguments passed through <code>...</code> are directly passed on to <code><a href="https://rdrr.io/r/stats/optim.html">optim()</a></code>.</p>
<p>By default, starting values are estimated by calling <code><a href="https://rdrr.io/r/stats/glm.html">glm.fit()</a></code> for both components of the model separately, once for the counts and once for zero vs.&nbsp;non-zero counts. If starting values are supplied, <code>start</code> needs to be set to a named list with the parameters for the <code>$count</code> and <code>$zero</code> part of the model (and potentially a <code>$theta</code> dispersion parameter if a negative binomial distribution is used).</p>
<p>The fitted model object of class <code>hurdle</code> is similar to <code>glm</code> objects and contains sufficient information on all aspects of the fitting process. In particular, the estimated parameters and associated covariances are included as well as the result from the <code><a href="https://rdrr.io/r/stats/optim.html">optim()</a></code> call. Furthermore, the call, formula, terms structure etc. is contained, potentially also the model frame, dependent variable and regressor matrices.</p>
<p>Following <code>glm.nb()</code>, the <span class="math inline">\(\theta\)</span> parameter of the negative binomial distribution is treated as a nuisance parameter. Thus, the <code>$coefficients</code> component of the fitted model object just contains estimates of <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\gamma\)</span> while the estimate of <span class="math inline">\(\theta\)</span> and its standard deviation (on a log scale) are kept in extra list elements <code>$theta</code> and <code>$SE.logtheta</code>.</p>
</section><section id="sec-zeroinfl" class="level2" data-number="5"><h2 data-number="5" class="anchored" data-anchor-id="sec-zeroinfl">
<span class="header-section-number">5</span> Technical details for zero-inflated models</h2>
<p>Both the interface of the <code>zeroinfl()</code> function as well as its fitted model objects are virtually identical to the corresponding <code>hurdle</code> functionality. Hence, we only provide some additional information for those aspects that differ from those discussed above. The details of the ML optimization are again provided by a <code>zeroinfl.control()</code> wrapper:</p>
<pre><code>zeroinfl.control(method = "BFGS", maxit = 10000, trace = FALSE,
  EM = FALSE, start = NULL, ...)</code></pre>
<p>The only new argument here is the argument <code>EM</code> which allows for EM estimation of the starting values. Instead of calling <code><a href="https://rdrr.io/r/stats/glm.html">glm.fit()</a></code> only once for both components of the model, this process can be iterated until convergence of the parameters to the ML estimates. The optimizer is still called subsequently (for a single iteration) to obtain the Hessian matrix from which the estimated covariance matrix can be computed.</p>
</section><section id="sec-methods" class="level2" data-number="6"><h2 data-number="6" class="anchored" data-anchor-id="sec-methods">
<span class="header-section-number">6</span> Methods for fitted zero-inflated and hurdle models</h2>
<p>Users typically should not need to compute on the internal structure of <code>hurdle</code> or <code>zeroinfl</code> objects because a set of standard extractor functions is provided, an overview is given in <a href="#tbl-methods" class="quarto-xref">Table&nbsp;2</a>. This includes methods to the generic functions <code><a href="https://rdrr.io/r/base/print.html">print()</a></code> and <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> which print the estimated coefficients along with further information. The <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> in particular supplies partial Wald tests based on the coefficients and the covariance matrix. As usual, the <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> method returns an object of class <code>summary.hurdle</code> or <code>summary.zeroinfl</code>, respectively, containing the relevant summary statistics which can subsequently be printed using the associated <code><a href="https://rdrr.io/r/base/print.html">print()</a></code> method.</p>
<p>The methods for <code><a href="https://rdrr.io/r/stats/coef.html">coef()</a></code> and <code><a href="https://rdrr.io/r/stats/vcov.html">vcov()</a></code> by default return a single vector of coefficients and their associated covariance matrix, respectively, i.e., all coefficients are concatenated. By setting their <code>model</code> argument, the estimates for a single component can be extracted. Concatenating the parameters by default and providing a matching covariance matrix estimate (that does not contain the covariances of further nuisance parameters) facilitates the application of generic inference functions such as <code>coeftest()</code>, <code>waldtest()</code>, and <code>linearHypothesis()</code>. All of these compute Wald tests for which coefficient estimates and associated covariances is essentially all information required and can therefore be queried in an object-oriented way with the <code><a href="https://rdrr.io/r/stats/coef.html">coef()</a></code> and <code><a href="https://rdrr.io/r/stats/vcov.html">vcov()</a></code> methods.</p>
<p>Similarly, the <code><a href="https://rdrr.io/r/stats/terms.html">terms()</a></code> and <code><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix()</a></code> extractors can be used to extract the relevant information for either component of the model. A <code><a href="https://rdrr.io/r/stats/logLik.html">logLik()</a></code> method is provided, hence <code><a href="https://rdrr.io/r/stats/AIC.html">AIC()</a></code> can be called to compute information criteria and <code>lrtest()</code> for conducting LR tests of nested models.</p>
<p>The <code><a href="https://rdrr.io/r/stats/predict.html">predict()</a></code> method computes predicted means (default) or probabilities (i.e., likelihood contributions) for observed or new data. Additionally, the means from the count and zero component, respectively, can be predicted. For the count component, this is the predicted count mean (without hurdle/inflation): <span class="math inline">\(\exp(x_i^\top \beta)\)</span>. For the zero component, this is the the ratio of probabilities <span class="math inline">\((1 - f_\mathrm{zero}(0; z_i, \gamma))/(1 - f_\mathrm{count}(0; x_i, \beta))\)</span> of observing non-zero counts in hurdle models. In zero-inflation models, it is the probability <span class="math inline">\(f_\mathrm{zero}(0; z_i, \gamma)\)</span> of observing a zero from the point mass component in zero-inflated models</p>
<p>Predicted means for the observed data can also be obtained by the <code><a href="https://rdrr.io/r/stats/fitted.values.html">fitted()</a></code> method. Deviations between observed counts <span class="math inline">\(y_i\)</span> and predicted means <span class="math inline">\(\hat \mu_i\)</span> can be obtained by the <code><a href="https://rdrr.io/r/stats/residuals.html">residuals()</a></code> method returning either raw residuals <span class="math inline">\(y_i - \hat \mu_i\)</span> or the Pearson residuals (raw residuals standardized by square root of the variance function) with the latter being the default.</p>
<div id="tbl-methods" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-methods-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Functions and methods for objects of class <code>zeroinfl</code> and <code>hurdle</code>. The first ten rows refer to methods, the remaining rows contain generic functions whose default methods work because of the information supplied by the methods above.
</figcaption><div aria-describedby="tbl-methods-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 27%">
<col style="width: 72%">
</colgroup>
<thead><tr class="header">
<th>Function</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code><a href="https://rdrr.io/r/base/print.html">print()</a></code></td>
<td>simple printed display with coefficient estimates</td>
</tr>
<tr class="even">
<td><code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code></td>
<td>standard regression output (coefficient estimates, standard errors, partial Wald tests); returns an object of class “<code>summary.</code><em>class</em>” containing the relevant summary statistics (which has a <code><a href="https://rdrr.io/r/base/print.html">print()</a></code> method)</td>
</tr>
<tr class="odd">
<td><code><a href="https://rdrr.io/r/stats/coef.html">coef()</a></code></td>
<td>extract coefficients of model (full or components), a single vector of all coefficients by default</td>
</tr>
<tr class="even">
<td><code><a href="https://rdrr.io/r/stats/vcov.html">vcov()</a></code></td>
<td>associated covariance matrix (with matching names)</td>
</tr>
<tr class="odd">
<td><code><a href="https://rdrr.io/r/stats/predict.html">predict()</a></code></td>
<td>predictions (means or probabilities) for new data</td>
</tr>
<tr class="even">
<td><code><a href="https://rdrr.io/r/stats/fitted.values.html">fitted()</a></code></td>
<td>fitted means for observed data</td>
</tr>
<tr class="odd">
<td><code><a href="https://rdrr.io/r/stats/residuals.html">residuals()</a></code></td>
<td>extract residuals (response or Pearson)</td>
</tr>
<tr class="even">
<td><code><a href="https://rdrr.io/r/stats/terms.html">terms()</a></code></td>
<td>extract terms of model components</td>
</tr>
<tr class="odd">
<td><code><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix()</a></code></td>
<td>extract model matrix of model components</td>
</tr>
<tr class="even">
<td><code><a href="https://rdrr.io/r/stats/logLik.html">logLik()</a></code></td>
<td>extract fitted log-likelihood</td>
</tr>
<tr class="odd">
<td><code>coeftest()</code></td>
<td>partial Wald tests of coefficients</td>
</tr>
<tr class="even">
<td><code>waldtest()</code></td>
<td>Wald tests of nested models</td>
</tr>
<tr class="odd">
<td><code>linearHypothesis()</code></td>
<td>Wald tests of linear hypotheses</td>
</tr>
<tr class="even">
<td><code>lrtest()</code></td>
<td>likelihood ratio tests of nested models</td>
</tr>
<tr class="odd">
<td><code><a href="https://rdrr.io/r/stats/AIC.html">AIC()</a></code></td>
<td>compute information criteria (AIC, BIC, …)</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</section><div id="quarto-appendix" class="default"><section id="replication-of-textbook-results" class="level2 unnumbered appendix"><h2 class="anchored quarto-appendix-heading">Replication of textbook results</h2><div class="quarto-appendix-contents">
<p><span class="citation" data-cites="countreg:Cameron+Trivedi:1998">Cameron and Trivedi (<a href="#ref-countreg:Cameron+Trivedi:1998" role="doc-biblioref">1998, 204</a>)</span> use a somewhat extended version of the model employed above. Because not all variables in that extended model are significant, a reduced set of variables was used throughout the main text. Here, however, we use the full model to show that the tools in <strong>countreg</strong> reproduce the results of <span class="citation" data-cites="countreg:Cameron+Trivedi:1998">Cameron and Trivedi (<a href="#ref-countreg:Cameron+Trivedi:1998" role="doc-biblioref">1998</a>)</span>.</p>
<p>After omitting the responses other than <code>visits</code> and setting <code>"other"</code> as the reference category for <code>region</code> using</p>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt2</span> <span class="op">&lt;-</span> <span class="va">NMES1988</span><span class="op">[</span>, <span class="op">-</span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">dt2</span><span class="op">$</span><span class="va">region</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/relevel.html">relevel</a></span><span class="op">(</span><span class="va">dt2</span><span class="op">$</span><span class="va">region</span>, <span class="st">"other"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>we fit a model that contains all explanatory variables, both in the count model and the zero hurdle model:</p>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fm_hurdle2</span> <span class="op">&lt;-</span> <span class="fu">hurdle</span><span class="op">(</span><span class="va">visits</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">dt2</span>, dist <span class="op">=</span> <span class="st">"negbin"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The resulting coefficient estimates are virtually identical to those published in <span class="citation" data-cites="countreg:Cameron+Trivedi:1998">Cameron and Trivedi (<a href="#ref-countreg:Cameron+Trivedi:1998" role="doc-biblioref">1998, 204</a>)</span>. The associated Wald statistics are also very similar provided that sandwich standard errors are used <span class="citation" data-cites="countreg:Cameron+Trivedi:1998">(which is not stated explicitely in <a href="#ref-countreg:Cameron+Trivedi:1998" role="doc-biblioref">Cameron and Trivedi 1998</a>)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cfz</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">fm_hurdle2</span>, model <span class="op">=</span> <span class="st">"zero"</span><span class="op">)</span></span>
<span><span class="va">cfc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">fm_hurdle2</span>, model <span class="op">=</span> <span class="st">"count"</span><span class="op">)</span></span>
<span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fu">sandwich</span><span class="op">(</span><span class="va">fm_hurdle2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>zero <span class="op">=</span> <span class="va">cfz</span>, zero_t <span class="op">=</span> <span class="va">cfz</span><span class="op">/</span><span class="va">se</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>along <span class="op">=</span> <span class="va">cfc</span><span class="op">)</span><span class="op">]</span>, </span>
<span>  count <span class="op">=</span> <span class="va">cfc</span>, count_t <span class="op">=</span> <span class="va">cfc</span><span class="op">/</span><span class="va">se</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>along <span class="op">=</span> <span class="va">cfc</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">7</span>, <span class="fl">6</span>, <span class="fl">8</span>, <span class="fl">9</span><span class="op">:</span><span class="fl">17</span>, <span class="fl">1</span><span class="op">)</span>,<span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  zero zero_t  count count_t
healthexcellent -0.329 -2.310 -0.378  -4.312
healthpoor       0.071  0.420  0.333   5.863
chronic          0.557 10.547  0.143  10.520
adllimited      -0.188 -1.448  0.129   2.504
regionmidwest    0.101  0.880 -0.016  -0.344
regionnortheast  0.129  1.033  0.104   1.974
regionwest       0.202  1.509  0.123   2.444
age              0.190  2.348 -0.075  -2.339
afamyes         -0.327 -2.450  0.002   0.023
gendermale      -0.464 -4.715  0.004   0.098
marriedyes       0.247  2.379 -0.092  -2.110
school           0.054  4.109  0.022   3.824
income           0.007  0.365 -0.002  -0.380
employedyes     -0.012 -0.085  0.030   0.401
insuranceyes     0.762  6.501  0.227   4.007
medicaidyes      0.554  3.055  0.185   2.777
(Intercept)     -1.475 -2.283  1.631   6.017</code></pre>
</div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">fm_hurdle2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'log Lik.' -12110.49 (df=35)</code></pre>
</div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fl">1</span><span class="op">/</span><span class="va">fm_hurdle2</span><span class="op">$</span><span class="va">theta</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    count 
0.7437966 </code></pre>
</div>
</div>
<p>There are some small and very few larger deviations in the Wald statistics which are probably explicable by different approximations to the gradient of <span class="math inline">\(\theta\)</span> (or <span class="math inline">\(1/\theta\)</span> or <span class="math inline">\(\log(\theta)\)</span>) and the usage of different non-linear optimizers (and at least ten years of software development).</p>
<p>More replication exercises are performed in the example sections of <strong>AER</strong> <span class="citation" data-cites="countreg:Zeileis+Kleiber:2008">(<a href="#ref-countreg:Zeileis+Kleiber:2008" role="doc-biblioref">Zeileis and Kleiber 2008</a>)</span>, the software package accompanying <span class="citation" data-cites="countreg:Kleiber+Zeileis:2008">Kleiber and Zeileis (<a href="#ref-countreg:Kleiber+Zeileis:2008" role="doc-biblioref">2008</a>)</span>.</p>



</div></section><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-countreg:Cameron+Trivedi:1998" class="csl-entry" role="listitem">
Cameron, A. Colin, and Pravin K. Trivedi. 1998. <em>Regression Analysis of Count Data</em>. Cambridge: Cambridge University Press.
</div>
<div id="ref-countreg:Cameron+Trivedi:2005" class="csl-entry" role="listitem">
———. 2005. <em>Microeconometrics: Methods and Applications</em>. Cambridge: Cambridge University Press.
</div>
<div id="ref-countreg:Deb+Trivedi:1997" class="csl-entry" role="listitem">
Deb, Partha, and Pravin K. Trivedi. 1997. <span>“Demand for Medical Care by the Elderly: A Finite Mixture Approach.”</span> <em>Journal of Applied Econometrics</em> 12: 313–36.
</div>
<div id="ref-countreg:Kleiber+Zeileis:2008" class="csl-entry" role="listitem">
Kleiber, Christian, and Achim Zeileis. 2008. <em>Applied Econometrics with <span>R</span></em>. New York: Springer-Verlag.
</div>
<div id="ref-countreg:Lambert:1992" class="csl-entry" role="listitem">
Lambert, Diane. 1992. <span>“Zero-Inflated Poisson Regression, with an Application to Defects in Manufacturing.”</span> <em>Technometrics</em> 34: 1–14.
</div>
<div id="ref-countreg:Mullahy:1986" class="csl-entry" role="listitem">
Mullahy, J. 1986. <span>“Specification and Testing of Some Modified Count Data Models.”</span> <em>Journal of Econometrics</em> 33: 341–65.
</div>
<div id="ref-countreg:Zeileis:2006" class="csl-entry" role="listitem">
Zeileis, Achim. 2006. <span>“Object-Oriented Computation of Sandwich Estimators.”</span> <em>Journal of Statistical Software</em> 16 (9): 1–16. <a href="http://www.jstatsoft.org/v16/i09/">http://www.jstatsoft.org/v16/i09/</a>.
</div>
<div id="ref-countreg:Zeileis+Kleiber:2008" class="csl-entry" role="listitem">
Zeileis, Achim, and Christian Kleiber. 2008. <em><span>AER</span>: Applied Econometrics with <span>R</span></em>. <a href="http://CRAN.R-project.org/package=AER">http://CRAN.R-project.org/package=AER</a>.
</div>
<div id="ref-countreg:Zeileis+Kleiber:2013" class="csl-entry" role="listitem">
———. 2013. <em><span class="nocase">countreg</span>: Count Data Regression</em>. <a href="http://R-Forge.R-project.org/projects/countreg/">http://R-Forge.R-project.org/projects/countreg/</a>.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>
<ol>
<li id="fn1"><p>Note that binomial logit and censored geometric models as the hurdle part both lead to the same likelihood function and thus to the same coefficient estimates <span class="citation" data-cites="countreg:Mullahy:1986">(<a href="#ref-countreg:Mullahy:1986" role="doc-biblioref">Mullahy 1986</a>)</span>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></div></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/topmodels\.R-Forge\.R-project\.org\/countreg\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>