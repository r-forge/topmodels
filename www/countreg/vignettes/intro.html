<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.53">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Introduction – countreg</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../countreg.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
<meta property="og:title" content="Introduction – countreg">
<meta property="og:description" content="">
<meta property="og:image" content="https://topmodels.R-Forge.R-project.org/countreg/vignettes/countreg.png">
<meta property="og:site_name" content="countreg">
<meta name="twitter:title" content="Introduction – countreg">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://topmodels.R-Forge.R-project.org/countreg/vignettes/countreg.png">
<meta name="twitter:image:alt" content="countreg: Count Data Regression in R">
<meta name="twitter:site" content="@AchimZeileis">
<meta name="twitter:card" content="summary">
</head>
<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../countreg-wide.png" alt="countreg logo" class="navbar-logo"></a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Get started</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-documentation" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Documentation</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-documentation">
<li>
    <a class="dropdown-item" href="../man/nbreg.html">
 <span class="dropdown-text">Negative binomial regression</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../man/hurdle.html">
 <span class="dropdown-text">Hurdle models</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../man/zeroinfl.html">
 <span class="dropdown-text">Zero-inflated models</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../man/zerotrunc.html">
 <span class="dropdown-text">Zero-truncated models</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../man/FLXMRnegbin.html">
 <span class="dropdown-text">Finite mixtures, boosting, GLMs</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../man/disptest.html">
 <span class="dropdown-text">Diagnostic tests</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../man/CrabSatellites.html">
 <span class="dropdown-text">Data sets</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../man/binom.html">
 <span class="dropdown-text">Distribution extensions</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-vignettes" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Vignettes</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-vignettes">
<li>
    <a class="dropdown-item" href="../vignettes/intro.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../vignettes/basics.html">
 <span class="dropdown-text">Basics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../vignettes/zero-augmented.html">
 <span class="dropdown-text">Zero-augmented models</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item">
    <a class="nav-link" href="../NEWS.html"> 
<span class="menu-text">News</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../CITATION.html"> 
<span class="menu-text">Citation</span></a>
  </li>  
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item">
    <a class="nav-link" href="../contact.html"> 
<span class="menu-text">Contact</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://R-Forge.R-project.org/projects/countreg"> <i class="bi bi-code" role="img" aria-label="countreg @ R-Forge">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#sec-software" id="toc-sec-software" class="nav-link active" data-scroll-target="#sec-software">Models and software</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header"><h1 class="title display-7">Introduction</h1>

</header><p>Modeling count variables is a common task in economics and the social sciences. The classical Poisson regression model for count data is often of limited use in these disciplines because empirical count data sets typically exhibit over-dispersion and/or an excess number of zeros. The former issue can be addressed by extending the plain Poisson regression model in various directions: e.g., using sandwich covariances or estimating an additional dispersion parameter (in a so-called quasi-Poisson model). Another more formal way is to use a negative binomial (NB) regression. All of these models belong to the family of generalized linear models <span class="citation" data-cites="countreg:Nelder+Wedderburn:1972 countreg:McCullagh+Nelder:1989">(GLMs, see <a href="#ref-countreg:Nelder+Wedderburn:1972" role="doc-biblioref">Nelder and Wedderburn 1972</a>; <a href="#ref-countreg:McCullagh+Nelder:1989" role="doc-biblioref">McCullagh and Nelder 1989</a>)</span>. However, although these models typically can capture over-dispersion rather well, they are in many applications not sufficient for modeling excess zeros. Since <span class="citation" data-cites="countreg:Mullahy:1986">Mullahy (<a href="#ref-countreg:Mullahy:1986" role="doc-biblioref">1986</a>)</span> and <span class="citation" data-cites="countreg:Lambert:1992">Lambert (<a href="#ref-countreg:Lambert:1992" role="doc-biblioref">1992</a>)</span> there is increased interest, both in the econometrics and statistics literature, in zero-augmented models that address this issue by a second model component capturing zero counts. Hurdle models <span class="citation" data-cites="countreg:Mullahy:1986">(<a href="#ref-countreg:Mullahy:1986" role="doc-biblioref">Mullahy 1986</a>)</span> combine a left-truncated count component with a right-censored hurdle component. Zero-inflation models <span class="citation" data-cites="countreg:Lambert:1992">(<a href="#ref-countreg:Lambert:1992" role="doc-biblioref">Lambert 1992</a>)</span> take a somewhat different approach: they are mixture models that combine a count component and a point mass at zero. An overview of count data models in econometrics, including hurdle and zero-inflated models, is provided in <span class="citation" data-cites="countreg:Cameron+Trivedi:1998">Cameron and Trivedi (<a href="#ref-countreg:Cameron+Trivedi:1998" role="doc-biblioref">1998</a>)</span>,countreg:Cameron+Trivedi:2005.</p>
<p>In R <span class="citation" data-cites="countreg:R:2008">(<a href="#ref-countreg:R:2008" role="doc-biblioref">R Development Core Team 2008</a>)</span>, GLMs are provided by the model fitting functions <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code> <span class="citation" data-cites="countreg:Chambers+Hastie:1992">(<a href="#ref-countreg:Chambers+Hastie:1992" role="doc-biblioref">Chambers and Hastie 1992</a>)</span> in the <strong>stats</strong> package and <code>glm.nb()</code> in the <strong>MASS</strong> package <span class="citation" data-cites="countreg:Venables+Ripley:2002">(<a href="#ref-countreg:Venables+Ripley:2002" role="doc-biblioref">Venables and Ripley 2002</a>)</span> along with associated methods for diagnostics and inference. Here, we discuss the implementation of hurdle and zero-inflated models in the functions <code>hurdle()</code> and <code>zeroinfl()</code> in the <strong>countreg</strong> package <span class="citation" data-cites="countreg:Zeileis+Kleiber:2013">(<a href="#ref-countreg:Zeileis+Kleiber:2013" role="doc-biblioref">Zeileis and Kleiber 2013</a>)</span>, available from the Comprehensive R Archive Network (CRAN) at <a href="http://CRAN.R-project.org/package=countreg" class="uri">http://CRAN.R-project.org/package=countreg</a>. The design of both modeling functions as well as the methods operating on the associated fitted model objects follows that of the base R functionality so that the new software integrates easily into the computational toolbox for modeling count data in R.</p>
<p>The remainder of this article provides an overview of the supported count data models in <strong>countreg</strong>. More detailed discussions of the classical count data models and their zero-augmented counterparts can be found in <a href="../vignettes/basics.html">“Basics”</a> and <a href="../vignettes/zero-augmented.html">“Zero-augmented models”</a>, respectively. Both links contain applications of the respective models to a microeconomic cross-section data set on the demand for medical care.</p>
<section id="sec-software" class="level2"><h2 class="anchored" data-anchor-id="sec-software">Models and software</h2>
<div class="cell">
<div id="tbl-overview" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-overview-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Overview of discussed count regression models. All GLMs use the same log-linear mean function (<span class="math inline">\(\log(\mu) = x^\top \beta\)</span>) but make different assumptions about the remaining likelihood. The zero-augmented models extend the mean function by modifying (typically, increasing) the likelihood of zero counts.
</figcaption><div aria-describedby="tbl-overview-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
 

  
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>tinytable_27vjor19iuyhzlziytz0</title>
<style>
.table td.tinytable_css_pja2jq7shm9xdrzuby3x, .table th.tinytable_css_pja2jq7shm9xdrzuby3x {    border-bottom: solid 0.1em #d3d8dc; }
.table td.tinytable_css_5o8p5y2wjpjgpvtzrfzl, .table th.tinytable_css_5o8p5y2wjpjgpvtzrfzl {    border-bottom: solid 0.1em lightgrey; }
    </style>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script><div class="container">
      <table class="table table-borderless" id="tinytable_27vjor19iuyhzlziytz0" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
<thead><tr>
<th scope="col">Type</th>
                <th scope="col">Distribution</th>
                <th scope="col">Method</th>
                <th scope="col">Description</th>
              </tr></thead>
<tbody>
<tr>
<td>GLM           </td>
                  <td>Poisson</td>
                  <td>ML      </td>
                  <td>Poisson regression: classical GLM, estimated by maximum likelihood (ML)                                                                                                                    </td>
                </tr>
<tr>
<td>              </td>
                  <td>       </td>
                  <td>quasi   </td>
                  <td>"quasi-Poisson regression": same mean function, estimated by quasi-ML (QML) or equivalently generalized estimating equations (GEE), inference adjustment via estimated dispersion parameter</td>
                </tr>
<tr>
<td>              </td>
                  <td>       </td>
                  <td>adjusted</td>
                  <td>"adjusted Poisson regression": same mean function, estimated by QML/GEE, inference adjustment via sandwich covariances                                                                     </td>
                </tr>
<tr>
<td>              </td>
                  <td>NB     </td>
                  <td>ML      </td>
                  <td>NB regression: extended GLM, estimated by ML including additional shape parameter                                                                                                          </td>
                </tr>
<tr>
<td>zero-augmented</td>
                  <td>Poisson</td>
                  <td>ML      </td>
                  <td>zero-inflated Poisson (ZIP), hurdle Poisson                                                                                                                                                </td>
                </tr>
<tr>
<td>              </td>
                  <td>NB     </td>
                  <td>ML      </td>
                  <td>zero-inflated NB (ZINB), hurdle NB                                                                                                                                                         </td>
                </tr>
</tbody>
</table>
</div>

    <script>
      function styleCell_tinytable_ow09nibq3f5itl3aedxp(i, j, css_id) {
        var table = document.getElementById("tinytable_27vjor19iuyhzlziytz0");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_27vjor19iuyhzlziytz0');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_tinytable_ow09nibq3f5itl3aedxp(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_27vjor19iuyhzlziytz0");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }

window.addEventListener('load', function () { styleCell_tinytable_ow09nibq3f5itl3aedxp(0, 0, 'tinytable_css_pja2jq7shm9xdrzuby3x') })
window.addEventListener('load', function () { styleCell_tinytable_ow09nibq3f5itl3aedxp(0, 1, 'tinytable_css_pja2jq7shm9xdrzuby3x') })
window.addEventListener('load', function () { styleCell_tinytable_ow09nibq3f5itl3aedxp(0, 2, 'tinytable_css_pja2jq7shm9xdrzuby3x') })
window.addEventListener('load', function () { styleCell_tinytable_ow09nibq3f5itl3aedxp(0, 3, 'tinytable_css_pja2jq7shm9xdrzuby3x') })
window.addEventListener('load', function () { styleCell_tinytable_ow09nibq3f5itl3aedxp(4, 0, 'tinytable_css_5o8p5y2wjpjgpvtzrfzl') })
window.addEventListener('load', function () { styleCell_tinytable_ow09nibq3f5itl3aedxp(4, 1, 'tinytable_css_5o8p5y2wjpjgpvtzrfzl') })
window.addEventListener('load', function () { styleCell_tinytable_ow09nibq3f5itl3aedxp(4, 2, 'tinytable_css_5o8p5y2wjpjgpvtzrfzl') })
window.addEventListener('load', function () { styleCell_tinytable_ow09nibq3f5itl3aedxp(4, 3, 'tinytable_css_5o8p5y2wjpjgpvtzrfzl') })
    </script>
</div>
</div>
</figure>
</div>
</div>
<p>In this section, we briefly outline the theory and its implementation in R <span class="citation" data-cites="countreg:R:2008">(<a href="#ref-countreg:R:2008" role="doc-biblioref">R Development Core Team 2008</a>)</span> for some basic count data regression models as well as their zero-augmented extensions (see <a href="#tbl-overview" class="quarto-xref">Table&nbsp;1</a> for an overview). The classical Poisson, geometric and negative binomial models are described in a generalized linear model (GLM) framework; they are implemented in R by the <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code> function <span class="citation" data-cites="countreg:Chambers+Hastie:1992">(<a href="#ref-countreg:Chambers+Hastie:1992" role="doc-biblioref">Chambers and Hastie 1992</a>)</span> in the <strong>stats</strong> package and the <code>glm.nb()</code> function in the <strong>MASS</strong> package <span class="citation" data-cites="countreg:Venables+Ripley:2002">(<a href="#ref-countreg:Venables+Ripley:2002" role="doc-biblioref">Venables and Ripley 2002</a>)</span>. The hurdle and zero-inflated extensions of these models are provided by the functions <code>hurdle()</code> and <code>zeroinfl()</code> in package <strong>countreg</strong> <span class="citation" data-cites="countreg:Zeileis+Kleiber:2013">(<a href="#ref-countreg:Zeileis+Kleiber:2013" role="doc-biblioref">Zeileis and Kleiber 2013</a>)</span>. The original implementation of <span class="citation" data-cites="countreg:Jackman:2008">Jackman (<a href="#ref-countreg:Jackman:2008" role="doc-biblioref">2008</a>)</span> was improved by <span class="citation" data-cites="countreg:Kleiber+Zeileis:2008">Kleiber and Zeileis (<a href="#ref-countreg:Kleiber+Zeileis:2008" role="doc-biblioref">2008</a>)</span> for <strong>countreg</strong> to make the fitting functions and the fitted model objects more similar to their <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code> and <code>glm.nb()</code> counterparts. The most important features of the new <code>hurdle()</code> and <code>zeroinfl()</code> functions are discussed below while some technical aspects are deferred to the appendix.</p>
<p>An alternative implementation of zero-inflated count models is available in the currently orphaned package <strong>zicounts</strong> <span class="citation" data-cites="countreg:Mwalili:2007">(<a href="#ref-countreg:Mwalili:2007" role="doc-biblioref">Mwalili 2007</a>)</span>. Another extension of zero-inflated Poisson models is available in package <strong>ZIGP</strong> <span class="citation" data-cites="countreg:Erhardt:2008">(<a href="#ref-countreg:Erhardt:2008" role="doc-biblioref">Erhardt 2008</a>)</span> which allows dispersion—in addition to mean and zero-inflation level—to depend on regressors. However, the interfaces of both packages are less standard with fewer (or no) standard methods provided. Therefore, re-using generic inference tools is more cumbersome and hence these packages are not discussed here.</p>
<p>Two packages that embed zero-inflated models into more general implementations of GLMs and GAMs (generalized additive models) are <strong>gamlss</strong> <span class="citation" data-cites="countreg:Stasinopoulos+Rigby:2007">(<a href="#ref-countreg:Stasinopoulos+Rigby:2007" role="doc-biblioref">Stasinopoulos and Rigby 2007</a>)</span> and <strong>VGAM</strong> <span class="citation" data-cites="countreg:Yee:2008">(<a href="#ref-countreg:Yee:2008" role="doc-biblioref">Yee 2008</a>)</span>. The latter also provides hurdle models (under the name zero-altered models). Both implementations allow specification of only one set of regressors.</p>
<p>In addition to zero-augmented models, there are many further extensions to the classical Poisson model which are not discussed here. Some important model classes include finite mixture models—implemented in R in package <strong>flexmix</strong> <span class="citation" data-cites="countreg:Leisch:2004">(<a href="#ref-countreg:Leisch:2004" role="doc-biblioref">Leisch 2004</a>)</span>—and generalized estimating equations (GEE)—provided in R by package <strong>geepack</strong> <span class="citation" data-cites="countreg:Halekoh+Hojsgaard+Yan:2006">(<a href="#ref-countreg:Halekoh+Hojsgaard+Yan:2006" role="doc-biblioref">Halekoh, Højsgaard, and Yan 2006</a>)</span>—and mixed-effects models—available in R in packages <strong>lme4</strong> and <strong>nlme</strong> <span class="citation" data-cites="countreg:Pinheiro+Bates:2000">(see <a href="#ref-countreg:Pinheiro+Bates:2000" role="doc-biblioref">Pinheiro and Bates 2000</a>)</span>. Further information about the models and alternative R implementations can be found in the respective references.</p>



</section><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-countreg:Cameron+Trivedi:1998" class="csl-entry" role="listitem">
Cameron, A. Colin, and Pravin K. Trivedi. 1998. <em>Regression Analysis of Count Data</em>. Cambridge: Cambridge University Press.
</div>
<div id="ref-countreg:Chambers+Hastie:1992" class="csl-entry" role="listitem">
Chambers, John M., and Trevor J. Hastie, eds. 1992. <em>Statistical Models in <span>S</span></em>. London: Chapman &amp; Hall.
</div>
<div id="ref-countreg:Erhardt:2008" class="csl-entry" role="listitem">
Erhardt, Vinzenz. 2008. <em><span>ZIGP</span>: Zero-Inflated Generalized <span>P</span>oisson Regression Models</em>. <a href="http://CRAN.R-project.org/package=ZIGP">http://CRAN.R-project.org/package=ZIGP</a>.
</div>
<div id="ref-countreg:Halekoh+Hojsgaard+Yan:2006" class="csl-entry" role="listitem">
Halekoh, Ulrich, Søren Højsgaard, and Jun Yan. 2006. <span>“The <span>R</span> Package <span class="nocase">geepack</span> for Generalized Estimating Equations.”</span> <em>Journal of Statistical Software</em> 15 (2): 1–11. <a href="http://www.jstatsoft.org/v15/i02/">http://www.jstatsoft.org/v15/i02/</a>.
</div>
<div id="ref-countreg:Jackman:2008" class="csl-entry" role="listitem">
Jackman, Simon. 2008. <em><span class="nocase">pscl</span>: Classes and Methods for <span>R</span> Developed in the Political Science Computational Laboratory, Stanford University</em>. Stanford, California: Department of Political Science, Stanford University. <a href="http://CRAN.R-project.org/package=pscl">http://CRAN.R-project.org/package=pscl</a>.
</div>
<div id="ref-countreg:Kleiber+Zeileis:2008" class="csl-entry" role="listitem">
Kleiber, Christian, and Achim Zeileis. 2008. <em>Applied Econometrics with <span>R</span></em>. New York: Springer-Verlag.
</div>
<div id="ref-countreg:Lambert:1992" class="csl-entry" role="listitem">
Lambert, Diane. 1992. <span>“Zero-Inflated Poisson Regression, with an Application to Defects in Manufacturing.”</span> <em>Technometrics</em> 34: 1–14.
</div>
<div id="ref-countreg:Leisch:2004" class="csl-entry" role="listitem">
Leisch, Friedrich. 2004. <span>“<span>FlexMix</span>: A General Framework for Finite Mixture Models and Latent Class Regression in <span>R</span>.”</span> <em>Journal of Statistical Software</em> 11 (8): 1–18. <a href="http://www.jstatsoft.org/v11/i08/">http://www.jstatsoft.org/v11/i08/</a>.
</div>
<div id="ref-countreg:McCullagh+Nelder:1989" class="csl-entry" role="listitem">
McCullagh, P., and John A. Nelder. 1989. <em>Generalized Linear Models</em>. 2nd ed. London: Chapman &amp; Hall.
</div>
<div id="ref-countreg:Mullahy:1986" class="csl-entry" role="listitem">
Mullahy, J. 1986. <span>“Specification and Testing of Some Modified Count Data Models.”</span> <em>Journal of Econometrics</em> 33: 341–65.
</div>
<div id="ref-countreg:Mwalili:2007" class="csl-entry" role="listitem">
Mwalili, Samuel M. 2007. <em><span class="nocase">zicounts</span>: Classical and Censored Zero-Inflated Count Data Models</em>. <a href="http://CRAN.R-project.org/src/contrib/Archive/zicounts/">http://CRAN.R-project.org/src/contrib/Archive/zicounts/</a>.
</div>
<div id="ref-countreg:Nelder+Wedderburn:1972" class="csl-entry" role="listitem">
Nelder, J. A., and R. W. M. Wedderburn. 1972. <span>“Generalized Linear Models.”</span> <em>Journal of the Royal Statistical Society A</em> 135: 370–84.
</div>
<div id="ref-countreg:Pinheiro+Bates:2000" class="csl-entry" role="listitem">
Pinheiro, Jose C., and Douglas M. Bates. 2000. <em>"Mixed-Effects Models in <span>S</span> and <span>S-PLUS</span></em>. New York: Springer-Verlag.
</div>
<div id="ref-countreg:R:2008" class="csl-entry" role="listitem">
R Development Core Team. 2008. <em><span>R</span>: <span>A</span> Language and Environment for Statistical Computing</em>. Vienna, Austria: <span>R</span> Foundation for Statistical Computing. <a href="http://www.R-project.org/">http://www.R-project.org/</a>.
</div>
<div id="ref-countreg:Stasinopoulos+Rigby:2007" class="csl-entry" role="listitem">
Stasinopoulos, D. Mikis, and Robert A. Rigby. 2007. <span>“Generalized Additive Models for Location Scale and Shape (<span>GAMLSS</span>) in <span>R</span>.”</span> <em>Journal of Statistical Software</em> 23 (7). <a href="http://www.jstatsoft.org/v23/i07/">http://www.jstatsoft.org/v23/i07/</a>.
</div>
<div id="ref-countreg:Venables+Ripley:2002" class="csl-entry" role="listitem">
Venables, William N., and Brian D. Ripley. 2002. <em>Modern Applied Statistics with <span>S</span></em>. 4th ed. New York: Springer-Verlag.
</div>
<div id="ref-countreg:Yee:2008" class="csl-entry" role="listitem">
Yee, Thomas W. 2008. <em><span>VGAM</span>: Vector Generalized Linear and Additive Models</em>. <a href="http://CRAN.R-project.org/package=VGAM">http://CRAN.R-project.org/package=VGAM</a>.
</div>
<div id="ref-countreg:Zeileis+Kleiber:2013" class="csl-entry" role="listitem">
Zeileis, Achim, and Christian Kleiber. 2013. <em><span class="nocase">countreg</span>: Count Data Regression</em>. <a href="http://R-Forge.R-project.org/projects/countreg/">http://R-Forge.R-project.org/projects/countreg/</a>.
</div>
</div></section></div></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/topmodels\.R-Forge\.R-project\.org\/countreg\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>